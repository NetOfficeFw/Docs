<?xml version="1.0" encoding="utf-8"?><ObjectCollector>
	<Configuration ConfigName="Office Common Configuration" ConfigVersion="2.0.1607.28" ChangeDescription="2.0.1607.28">
    <ObjectProcessor Name="OFFX" Assembly="BPA.ConfigCollector.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Extensions.OffXFileObjectProcessor"/>
    <ObjectProcessor Name="Script" Assembly="BPA.ConfigCollector.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Extensions.ScriptingObjectProcessor"/>
    <ObjectProcessor Name="OfficeBranch" Assembly="BPA.OfficeCommon.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Extensions.OfficeBranchObjectProcessor"/>
    <ExtFormat Name="Wow6432Node" Assembly="BPA.OfficeCommon.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Formats" Convert="Wow6432Node"></ExtFormat>
    <ExtFunction Name="versioncompare" Assembly="BPA.ConfigCollector.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Extensions.VersionComparerObjectProcessor" Function="VersionCompare" Returns="Number" Parameters="String,String"></ExtFunction>
	</Configuration>
  <Type Name="WindowsUpdatesScriptPt1">
    <Object Type="Script" Key2="VBScript">
      <Script>
        Dim ofs,sFilePathAndName,oTextStream,sFileContents
        Set oFS = CreateObject("Scripting.FileSystemObject")
        Const TemporaryFolder = 2

        Dim tempFolder: tempFolder = oFS.GetSpecialFolder(TemporaryFolder)

        Dim scriptName:scriptName=WScript.ScriptName
        asyncScriptFileName = tempFolder &amp; "\_a_" &amp; scriptName
        sFilePathAndName = tempFolder + "\wupdates.xml"
        If oFS.FileExists(sFilePathAndName) = True Then 
          oFS.DeleteFile sFilePathAndName, True
        End If

        If Left(scriptName,3) &lt;&gt; "_a_" Then
               'WScript.Echo "Run Async"
               Dim f
       
               If oFS.FileExists(WScript.ScriptFullName) Then
             
                     set fOut = oFS.OpenTextFile(asyncScriptFileName,2,True)
                     set fIn = oFS.OpenTextFile(WScript.ScriptFullName,1,True)
                     contents = fIn.ReadAll()
                     fOut.Write(contents)
                     fIn.Close():fOut.Close()
                     Set objShell = CreateObject("WScript.Shell")
                     objShell.Run "cscript.exe """ &amp; asyncScriptFileName &amp; """ //E:vbs //NoLogo",0,False
               End If
          Set oFS = Nothing
               WScript.Quit
        End If

        Set updateSession = CreateObject("Microsoft.Update.Session")
        updateSession.ClientApplicationID = "OffCAT"

        Set updateSearcher = updateSession.CreateUpdateSearcher()
        Set searchResult = updateSearcher.Search("IsInstalled=0 and Type='Software' and IsHidden=0")
        Set oTextStream = oFS.OpenTextFile(sFilePathAndName,2,True) 
        
        oTextStream.WriteLine "&lt;Updates Count='" &amp; searchResult.Updates.Count &amp; "'&gt;"
        For I = 0 To searchResult.Updates.Count-1
          Set update = searchResult.Updates.Item(I)
        'WScript.Echo update.MsrcSeverity
          oTextStream.WriteLine "&lt;Update Sev='" &amp; update.MsrcSeverity &amp; "' Index = '" &amp; (I + 1) &amp; "' Title='" &amp; Replace(update.Title,"'","&amp;apos;") &amp; "'/&gt;"
        Next
        oTextStream.WriteLine "&lt;/Updates&gt;"

        oTextStream.Close 
        oFS.DeleteFile WScript.ScriptFullName
        Set oTextStream = nothing 
        Set oFS = nothing 
        Set searchResult = nothing
        Set updateSearcher = nothing
        Set updateSession = nothing
      </Script>
      <Setting Key1="Output" Display="Hide"/>
    </Object>
  </Type>
  <Type Name="C2R_Updates">
    <!--O15-->
    <Object Type="Engine">
      <Setting Key1="EnvironmentVariable" Key2="PROGRAMFILES" Substitution="PROGRAMFILES" Display="Hide"></Setting>
      <Setting Key1="EnvironmentVariable" Key2="PROGRAMFILES(X86)" Substitution="PROGRAMFILES(X86)" Display="Hide"></Setting>
      <Object Type="If" Key1="'%MAJORVERSION%'='15'">
        <Object Type="File" Key1="" Key2="%PROGRAMFILES%\Microsoft Office 15\Data\Updates\Apply\PackageFiles\packagemanifests" Key3="*.xml" Count="*" Display="Hide">
          <Setting Key1="Files" Display="Hide"></Setting>
          <Rule Name="nC2RUpdateFiles" Query="if((../Instance/Setting/@Key1='*')=true(),../Instance/Setting[@Key1='*']/Value,0)">
          </Rule>
        </Object>
        <Object Type="Group" Name="Click-to-run configuration registry data">
          <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\ClickToRun\ProductReleaseIDs\Active\culture" Display="Right">
            <Rule Name="C2RLatestVersionFromWeb15" Query="'15.0.4841.1002'"></Rule>
            <Setting Key1="x-none" Display="Right" Substitution="C2RINSTALLEDVERSION">
              <Rule Name="fInstalledC2RVersion15" Query="$."></Rule>
              <Rule Name="sLatestC2RVersionNotInstalled15" P0="'%C2RINSTALLEDVERSION%'" P1="$C2RLatestVersionFromWeb15" Query="$n2DigitVersion=15 and $sC2RUpdatesReadyToApply15=false() and $fUpdateUrlPostSP1=-1 and $fC2rUpdatePathPol=-1 and versioncompare('%C2RINSTALLEDVERSION%',$C2RLatestVersionFromWeb15)&lt;0" Error="Error" Title="Office 2013 Click-to-run is not at the latest version" Text="You have version {0} while the latest available version is {1}. Please click the 'Click here...' link to update your Office installation." GUID="386616" SSID="e395df67-0c72-48aa-8b00-eb44e23aeb2f" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
              <Rule Name="sLatestManagedC2RVersionNotInstalled15" P0="'%C2RINSTALLEDVERSION%'" P1="$C2RLatestVersionFromWeb15" Query="$n2DigitVersion=15 and $sC2RUpdatesReadyToApply15=false() and ($fUpdateUrlPostSP1!=-1 or $fC2rUpdatePathPol!=-1) and versioncompare('%C2RINSTALLEDVERSION%',$C2RLatestVersionFromWeb15)&lt;0" Error="Error" Title="Office 2013 Click-to-run managed installation is not at the latest version" Text="You have version {0} while the latest publicly available version is {1}. Because your Office installation version is being managed by your administrator, please contact them to discuss updating your Office installation." GUID="620356" SSID="0715f6d4-3a19-4d95-b3fe-119207e2ddf7" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
              <Rule Name="sC2RDec2014VersionInstalled15" Query="versioncompare($fInstalledC2RVersion15,'15.0.4675.1002')=0"></Rule>
              <Rule Name="sC2RUpdatesReadyToApply15" Query="$nC2RUpdateFiles!=0" Error="Error" P0="'%C2RINSTALLEDVERSION%'" Title="Updates for Click-to-Run are ready to be applied to Office" Text="Your Click-to-Run version is {0} but you have an update ready to be applied to your Click-to-run installation of Office. Click the 'Click here ...' link for details on how to get this update applied." GUID="386619" SSID="c8623e07-20b2-4fe4-b8a9-c8cbd17bb468" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
              <Rule Name="sMailControlPanelBrokenJune2016C2R" Query="lower-case($appName)='outlook' and '%MAJORVERSION%'='15' and $nInstallType='ClickToRun' and versioncompare('%C2RINSTALLEDVERSION%','15.0.4833.1001')=0" Error="Warning" Title="Mail control panel does not work" Text="When you click the Mail control panel nothing happens. This problem occurs after you install the June 2016 update for Office 2013 Click-to-Run." GUID="820550" SSID="e48bb3ba-2dfb-4102-b3ea-8efcf2341684" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Outlook profile,Mail control panel"></Rule>
            </Setting>
          </Object>
          <Object Type="Group" Name="Configuration registry data">
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\ClickToRun\propertyBag" Display="Right">
              <Setting Key1="UpdatesEnabled" Display="Right"></Setting>
              <Rule Name="fUpdatesEnabledPreSP1" Query="if((../Instance/Setting/@Key1='UpdatesEnabled')=true() and not($MSO_fC2R2013SP1UpdateInstalled),../Instance/Setting[@Key1='UpdatesEnabled']/Value,-1)" AlwaysEvaluate="True"/>
              <Setting Key1="baseurl" Display="Right">
                <Rule Name="sCustomBaseUrlPreSP1" Error="None" Query="not($MSO_fC2R2013SP1UpdateInstalled) and starts-with($.,'http://officecdn.microsoft.com')=false()" Title="Custom baseurl value for Click-to-run specified in the registry" Text="The baseurl value (referring to the Office installation location) points to a custom location in the registry. Please check with your administrator to verify this location is correct." SSID="46fbcf47-04eb-45bc-b4c6-d6757b00b36c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
              </Setting>
              <Setting Key1="updatebaseurl" Display="Right">
                <Rule Name="sCustomUpdateBaseUrlPreSP1" Error="None" Query="not($MSO_fC2R2013SP1UpdateInstalled) and starts-with($.,'http://officecdn.microsoft.com')=false()" Title="Custom updatebaseurl for Click-to-run specified in the registry" Text="The updatebaseurl value (referring to the Office Click-to-run update location) points to a custom location in the registry. Please check with your administrator to verify this location is correct." SSID="03eadad5-1c6d-47a7-bcdd-bd818ae3c878" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
              </Setting>
            </Object>
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\ClickToRun\Configuration" Display="Right">
              <Setting Key1="CDNBaseUrl" Display="Right"></Setting>
              <Rule Name="fCdnBaseUrlPostSP1" Query="if((../Instance/Setting/@Key1='CDNBaseUrl')=true() and $MSO_fC2R2013SP1UpdateInstalled,../Instance/Setting[@Key1='CDNBaseUrl']/Value,-1)"></Rule>
              <Setting Key1="UpdatesEnabled" Display="Right"></Setting>
              <Rule Name="fUpdatesEnabledPostSP1" Query="if((../Instance/Setting/@Key1='UpdatesEnabled')=true() and $MSO_fC2R2013SP1UpdateInstalled,../Instance/Setting[@Key1='UpdatesEnabled']/Value,-1)" AlwaysEvaluate="True"/>
              <Setting Key1="updateurl" Display="Right">
                <Rule Name="sCustomUpdateUrlPostSP1" Error="None" Query="$MSO_fC2R2013SP1UpdateInstalled and starts-with($.,'http://officecdn.microsoft.com')=false()" Title="Custom Update URL value for Click-to-run specified in the registry" Text="The UpdateURL value (referring to the Office Click-to-run update location) points to a custom location in the registry. Please check with your administrator to verify this location is correct." SSID="4005d104-f4fd-43cc-8215-341746de7267" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
              </Setting>
              <Rule Name="fUpdateUrlPostSP1" Query="if((../Instance/Setting/@Key1='updateurl')=true() and $MSO_fC2R2013SP1UpdateInstalled,../Instance/Setting[@Key1='updateurl']/Value,-1)" AlwaysEvaluate="True"/>
              <Setting Key1="UpdateToVersion" Display="Right"></Setting>
              <Rule Name="fC2rUpdateTargetVersion15" Query="if((../Instance/Setting/@Key1='UpdateToVersion')=true(),../Instance/Setting[@Key1='UpdateToVersion']/Value,-1)"/>
              <Object Type="Group" Name="Hidden">
                <Rule Name="sNonDefaultCdnBaseUrlPostSP1" Query="$fCdnBaseUrlPostSP1!='http://officecdn.microsoft.com/pr/39168D7E-077B-48E7-872C-B232C3E72675'" Error="Warning" P0="$fCdnBaseUrlPostSP1" P1="'%MAJORVERSION%'" Title="Non-default URL for Office 2013 Click-to-run source found in the registry" Text="The CDNBaseUrl value in the registry (HKLM\Software\Microsoft\Office\{1}.0\ClickToRun\Configuration) is '{0}'. The correct URL is 'http://officecdn.microsoft.com/pr/39168D7E-077B-48E7-872C-B232C3E72675'. Modification of this value is not supported. Please update it to 'http://officecdn.microsoft.com/pr/39168D7E-077B-48E7-872C-B232C3E72675'." SSID="77d5fb1a-6a3d-4dbc-ad6a-0fb4ad911cf7" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Configuration (unsupported or problematic)"/>
                <Rule Name="sC2rManagedUpdateVersionNotInstalled15" Query="$sC2RUpdatesReadyToApply15=false() and $fC2rUpdateTargetVersionPol=-1 and versioncompare($fInstalledC2RVersion15,$fC2rUpdateTargetVersion15)&lt;0" Error="None" P0="$fInstalledC2RVersion15" P1="$fC2rUpdateTargetVersion15" Title="Office 2013 Click-to-run managed installation is not at the version specified by your administrator" Text="You have version {0} while the version specified by your administrator is {1}. Because your Office installation version is being managed by your administrator, please contact them to discuss updating your Office installation." GUID="620359" SSID="91336d81-fd89-4b94-9213-c6a64bff2292" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="!Application updates missing"></Rule>
                <Rule Name="sC2RUpdatesDisabled15" Title="Automatic updates for Click-to-Run are disabled" Error="Warning" Query="$fEnableAutomaticUpdates=-1 and ($fUpdatesEnabledPreSP1=0 or $fUpdatesEnabledPostSP1='False')" Text="Automatic updating of your Click-to-Run installation is disabled. It is recommended to enable this feature so Office has the latest updates installed." GUID="271987" SSID="f9e6da83-93a8-4d12-9530-1991f0e4889c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Product not updated,Administration"/>
              </Object>
            </Object>
          </Object>
        </Object>
      </Object>
      <!--O16+-->
      <Object Type="If" Key1="number('%MAJORVERSION%')&gt;15">
        <Rule Name="C2RLatestVersionFromWeb16FRCB" Query="if($sC2RChannelShortNameOBOP = 'FRCC',$sC2RVersionOBOP,'0.0.0.0')"></Rule><!--FRCC-->
        <Rule Name="C2RLatestVersionFromWeb16CB" Query="if($sC2RChannelShortNameOBOP = 'CC',$sC2RVersionOBOP,'0.0.0.0')"></Rule><!--CC-->
        <!--Rule Name="C2RLatestVersionFromWeb16FRDC" Query="'16.0.6965.2058'"></Rule-->
        <Rule Name="C2RLatestVersionFromWeb16CBB" Query="if($sC2RChannelShortNameOBOP = 'DC',$sC2RVersionOBOP,'0.0.0.0')"></Rule><!--DC-->

        <Object Type="If" Key1="'%WOW6432NODE%'='Wow6432Node'">
          <Object Type="File" Key1="" Key2="%PROGRAMFILES(X86)%\Microsoft Office\Updates\Apply\PackageFiles\packagemanifests" Key3="*.xml" Count="*" Display="Hide">
            <Setting Key1="Files" Display="Hide"></Setting>
          </Object>
          <Rule Name="nC2RUpdateFilesWoW16" Query="if(count(../Instance/Object/Instance)&gt;0,../Instance/Object/Instance/Setting[@Key1='*']/Value,0)">
          </Rule>
        </Object>
        <Object Type="If" Key1="'%WOW6432NODE%'!='Wow6432Node'">
          <Object Type="File" Key1="" Key2="%PROGRAMFILES%\Microsoft Office\Updates\Apply\PackageFiles\packagemanifests" Key3="*.xml" Count="*" Display="Hide">
            <Setting Key1="Files" Display="Hide"></Setting>
          </Object>
          <Rule Name="nC2RUpdateFiles16" Query="if(count(../Instance/Object/Instance)&gt;0,../Instance/Object/Instance/Setting[@Key1='*']/Value,0)">
          </Rule>
        </Object>
        <Object Type="Group" Name="ClickToRun channel details from http://officecdn.microsoft.com" Display="Right">
          <Object Type="OfficeBranch">
            <Setting Key1="Channel" Substitution="C2R16CHANNEL"></Setting>
            <Rule Name="sC2RChannelOBOP" Query="if((../Instance/Setting/@Key1='Channel')=true(),../Instance/Setting[@Key1='Channel']/Value,-1)"/>
            <Rule Name="sC2RChannelShortNameOBOP" Query="if($sC2RChannelOBOP != -1,substring-before(substring-after($sC2RChannelOBOP,'('),')'),'NoChannel')"/>
            <Setting Key1="Version" Substitution="C2R16VERSION"></Setting>
            <Rule Name="sC2RVersionOBOP" Query="if((../Instance/Setting/@Key1='Version')=true(),../Instance/Setting[@Key1='Version']/Value,'0.0.0.0')"/>
            <Setting Key1="Throttle" Substitution="C2R16THROTTLE"></Setting>
          </Object>
        </Object>
        <Object Type="Group" Name="\ClickToRun\ProductReleaseIDs registry data" Display="Right">
          <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\ClickToRun\ProductReleaseIDs" Display="Right">
            <Setting Key1="ActiveConfiguration" Display="Right" Substitution="ACTIVECONFIG"></Setting>
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\ClickToRun\ProductReleaseIDs\%ACTIVECONFIG%\culture\x-none.%MAJORVERSION%" Display="Right">
              <Setting Key1="StreamPackageUrl" Display="Right">
                <Rule Name="fUnknownCdnFromStreamPackageUrl" Query="starts-with($.,'http://officecdn.microsoft.com')=false()" Error="None" P0="$." Text="{0} is a custom URL that is not a known CDN path. Therefore, the Channel name cannot be determined." Symptoms="Informational"></Rule>
                <Rule Name="fC2R2016Branch" Query="$."></Rule>
              </Setting>
              <Setting Key1="Version" Display="Right" Substitution="C2RINSTALLEDVERSION16">
                <Rule Name="sLatestC2RVersionNotDetectable" Query="$fUnknownCdnFromStreamPackageUrl" Error="None" Text="Because the SteamPackageUrl value points to an unknown CDN path, OffCAT is unable to determine if this is the most recent version available." GUID="511331" Symptoms="Informational"></Rule>
                <Rule Name="fInstalledC2RVersion16" Query="$."></Rule>
                <Rule Name="sLatestC2RVersionNotInstalled16CB" Query="$n2DigitVersion=16 and $sC2R2016BranchShortName='CB' and $sC2RUpdatesReadyToApply16=false() and $fC2rUpdatePathPol=-1 and ($fC2rUpdateBranchPol=-1 or $fC2rUpdateBranchPol='current') and ($fUpdateUrl16=-1 or contains($fUpdateUrl16,'/492350f6-')) and versioncompare($fInstalledC2RVersion16,$C2RLatestVersionFromWeb16CB)&lt;0" Error="Error" P0="$fInstalledC2RVersion16" P1="$C2RLatestVersionFromWeb16CB" Title="Office 2016 Click-to-run is not at the latest version" Text="You have Office 2016 build {0} (from 'Current Channel') while the latest available build for this channel is at least {1}. To update Office, please click the 'Click here...' link and then follow the steps under 'Get updates manually'." GUID="722872" SSID="535eb277-d324-482e-a7de-4bc750d7f965" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
                <Rule Name="sLatestC2RVersionNotInstalled16CBB" Query="$n2DigitVersion=16 and $sC2R2016BranchShortName='CBB' and $sC2RUpdatesReadyToApply16=false() and $fC2rUpdatePathPol=-1 and ($fC2rUpdateBranchPol=-1 or $fC2rUpdateBranchPol='business') and ($fUpdateUrl16=-1 or contains($fUpdateUrl16,'/7ffbc6bf-')) and versioncompare($fInstalledC2RVersion16,$C2RLatestVersionFromWeb16CBB)&lt;0" Error="Error" P0="$fInstalledC2RVersion16" P1="$C2RLatestVersionFromWeb16CBB" Title="Office 2016 Click-to-run is not at the latest version" Text="You have Office 2016 build {0} (from 'Deferred Channel') while the latest available build for this channel is at least {1}. To update Office, please click the 'Click here...' link and then follow the steps under 'Get updates manually'." GUID="722874" SSID="6d57d921-479e-4828-9d67-b8313f0125ba" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
                <Rule Name="sLatestC2RVersionNotInstalled16FRCB" Query="$n2DigitVersion=16 and $sC2R2016BranchShortName='FRCB' and $sC2RUpdatesReadyToApply16=false() and $fC2rUpdatePathPol=-1 and $fC2rUpdateBranchPol=-1 and ($fUpdateUrl16=-1 or contains($fUpdateUrl16,'/64256afe-')) and versioncompare($fInstalledC2RVersion16,$C2RLatestVersionFromWeb16FRCB)&lt;0" Error="Error" P0="$fInstalledC2RVersion16" P1="$C2RLatestVersionFromWeb16FRCB" Title="Office 2016 Click-to-run is not at the latest version" Text="You have Office 2016 build {0} (from 'First Release for Current Channel') while the latest available build for this channel is at least {1}. To update Office, please click the 'Click here...' link and then follow the steps under 'Get updates manually'." GUID="722866" SSID="d643ce34-d2c4-44c0-84e0-b42ce17ccaa5" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
                <Rule Name="sC2RUpdatesReadyToApply16" Query="('%WOW6432NODE%'!='Wow6432Node' and $nC2RUpdateFiles16!=0) or ('%WOW6432NODE%'='Wow6432Node' and $nC2RUpdateFilesWoW16!=0)" Error="Error" P0="'%C2RINSTALLEDVERSION16%'" Title="Updates for Click-to-Run are ready to be applied to Office" Text="Your Click-to-Run version is {0} but you have an update ready to be applied to your Click-to-run installation of Office. To update Office, click the 'Click here ...' link and then follow the steps under 'Get updates manually'." GUID="722873" SSID="450c4f54-83e1-4538-835e-d1dac4160c69" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>

                <!-- update the following rules once the first update for 2016 C2R has been published>
            
            sLatestManagedC2RVersionNotInstalled16
            
            < Note, all rules need a GUID value-->

                <!--Rule Name="sLatestManagedC2RVersionNotInstalled16" 
                  Query="$n2DigitVersion=16 and $sC2RUpdatesReadyToApply16=false() and ($fUpdateUrl16!=-1 or $fC2rUpdatePathPol!=-1) and versioncompare('%C2RINSTALLEDVERSION16%',$C2RLatestVersionFromWeb16)&lt;0" Error="Error" 
            P0="'%C2RINSTALLEDVERSION16%'" P1="$C2RLatestVersionFromWeb16" Title="Office 2016 Click-to-run managed installation is not at the latest version" 
            Text="You have version {0} while the latest publicly available version is {1}. Because your Office installation version is being managed by your administrator, please contact them to discuss updating your Office installation." 
            GUID="" SSID="ccad1e10-7805-48ce-be1b-b1d367fb35f8" Symptoms="!Application updates missing"></Rule-->

              </Setting>
            </Object>
          </Object>
        </Object>
        <Rule Name="sC2R2016Build" Query="$n2DigitVersion=16" P0="$fInstalledC2RVersion16" Text="ClickToRun build ={0}"></Rule>
        <Rule Name="sC2R2016Branch" Query="$n2DigitVersion=16 and (contains($fC2R2016Branch,'/492350f6-') or contains($fC2R2016Branch,'/7ffbc6bf') or contains($fC2R2016Branch,'/b8f9b850-') or contains($fC2R2016Branch,'/64256afe-'))" P0="if(contains($fC2R2016Branch,'/492350f6-'),'Current Channel',if(contains($fC2R2016Branch,'/7ffbc6bf'),'Deferred Channel',if(contains($fC2R2016Branch,'/b8f9b850-'),'First Release for Deferred Channel',if(contains($fC2R2016Branch,'/64256afe-'),'First Release for Current Channel - insiders','undocumented branch'))))" Text="Update branch ={0}"></Rule>
        <Rule Name="sC2R2016BranchShortName" Query="if($n2DigitVersion=16,if(contains($fC2R2016Branch,'/492350f6-'),'CB',if(contains($fC2R2016Branch,'/7ffbc6bf'),'CBB',if(contains($fC2R2016Branch,'/b8f9b850-'),'FRCBB',if(contains($fC2R2016Branch,'/64256afe-'),'FRCB','undocumented branch')))))"></Rule>
        <Rule Name="sUpdateToVersionFound16" Query="$fC2rUpdateTargetVersion16!=-1" Error="None" P0="$fC2rUpdateTargetVersion16" Title="Mandated Office Click-To-Run build found in the registry" Text="Build mandated by the UpdateToVersion registry value ={0}" Symptoms="Informational"></Rule>
        <Rule Name="sInstalledBuildLessThanUpdateToBuildValue" Query="versioncompare($fInstalledC2RVersion16,$fC2rUpdateTargetVersion16)&lt;0" P0="$fInstalledC2RVersion16" P1="$fC2rUpdateTargetVersion16" Error="Warning" Title="Office 2016 Click-to-run managed installation is not at the version specified by your administrator" Text="You have version {0} while the version specified by your administrator is {1}. Because your Office installation version is being managed by your administrator, please contact them to discuss updating your Office installation." GUID="715563" SSID="3da8ec8f-f50c-4c7b-b52f-26ff88d4b37f" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="!Application updates missing"></Rule>
        <Object Type="Group" Name="\ClickToRun\Configuration registry data" Display="Right">
          <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\ClickToRun\Configuration" Display="Right">
            <Setting Key1="__VALUES"></Setting>
            <Setting Key1="CDNBaseUrl" Display="Right">
              <Rule Name="fBranchfromCdnBaseUrl" Query="$n2DigitVersion=16 and $fCdnBaseUrl!=-1 and $fUpdateUrl16=-1" P1="if(contains($.,'/492350f6-'),'Current Channel',if(contains($.,'/7ffbc6bf'),'Deferred Channel',if(contains($.,'/b8f9b850-'),'First Release for Deferred Channel',if(contains($.,'/64256afe-'),'First Release for Current Channel - insiders','undocumented branch'))))" Text="Update branch based on CDNBaseUrl value ={1}"></Rule>
            </Setting>
            <Rule Name="fCdnBaseUrl" Query="if((../Instance/Setting/@Key1='CDNBaseUrl')=true(),../Instance/Setting[@Key1='CDNBaseUrl']/Value,-1)"/>
            <Setting Key1="UpdatesEnabled" Display="Right"></Setting>
            <Rule Name="fUpdatesEnabled16" Query="if((../Instance/Setting/@Key1='UpdatesEnabled')=true(),../Instance/Setting[@Key1='UpdatesEnabled']/Value,-1)" AlwaysEvaluate="True"/>
            <Setting Key1="updateurl" Display="Right">
              <Rule Name="sCustomUpdateUrl16" Error="None" Query="starts-with($.,'http://officecdn.microsoft.com')=false()" Title="Custom Update URL value for Click-to-run specified in the registry" Text="The UpdateURL value (referring to the Office Click-to-run update location) points to a custom location in the registry. Please check with your administrator to verify this location is correct." SSID="1fa6ecc7-1940-4d18-a6ff-70b6605195be" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
              <Rule Name="fBranchfromUpdateUrl" Query="$n2DigitVersion=16 and $fUpdateUrl16!=-1" P1="if(contains($.,'/492350f6-'),'Current Channel',if(contains($.,'/7ffbc6bf-'),'Deferred Channel',if(contains($.,'/b8f9b850-'),'First Release for Deferred Channel',if(contains($.,'/64256afe-'),'First Release for Current Channel - insiders','undocumented branch'))))" Text="Update branch based on UpdateURL value ={1}"></Rule>
            </Setting>
            <Rule Name="fUpdateUrl16" Query="if((../Instance/Setting/@Key1='updateurl')=true(),../Instance/Setting[@Key1='updateurl']/Value,-1)" AlwaysEvaluate="True"/>
            <Setting Key1="UpdateToVersion" Display="Right"></Setting>
            <Rule Name="fC2rUpdateTargetVersion16" Query="if((../Instance/Setting/@Key1='UpdateToVersion')=true(),../Instance/Setting[@Key1='UpdateToVersion']/Value,-1)"/>
          </Object>
        </Object>
      </Object>
      <!--/O16+-->

      <!--O15+ opax and admx 'policies'-->
      <Object Type="Group" Name="Click-to-run deployment registry and policy data" Display="Right">
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\Common\Officeupdate" Display="Right">
          <Setting Key1="updatepath" Display="Right"></Setting>
          <Rule Name="fC2rUpdatePath" Query="if((../Instance/Setting/@Key1='updatepath')=true(),../Instance/Setting[@Key1='updatepath']/Value,-1)"/>
          <Setting Key1="updatebranch" Display="Right"></Setting>
          <Rule Name="fC2rUpdateBranch" Query="if((../Instance/Setting/@Key1='updatebranch')=true(),../Instance/Setting[@Key1='updatebranch']/Value,-1)"/>
        </Object>
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Policies\Microsoft\Office\%MAJORVERSION%.0\Common\Officeupdate" Display="Right">
          <Setting Key1="EnableAutomaticUpdates" Display="Right"/>
          <Setting Key1="EnableAutomaticUpgrade" Display="Right"/>
          <Setting Key1="HideEnableDisableUpdates" Display="Right"></Setting>
          <Setting Key1="updatepath" Display="Right">
            <Rule Name="fBranchfromUpdatePathPolicy" Query="$n2DigitVersion=16 and $fC2rUpdatePathPol!=-1" P1="if(contains($.,'/492350f6-'),'Current Channel',if(contains($.,'/7ffbc6bf-'),'Deferred Channel',if(contains($.,'/b8f9b850-'),'First Release for Deferred Channel',if(contains($.,'/64256afe-'),'First Release for Current Channel - insiders','undocumented branch'))))" Text="Update branch based on UpdatePath value ={1}"></Rule>
          </Setting>
          <Setting Key1="updatetargetversion" Display="Right"></Setting>
          <Setting Key1="updatedeadline" Display="Right"></Setting>
          <Setting Key1="updatebranch" Display="Right">
            <Rule Name="sUpdateBranchPolicyValueWrong" Query="lower-case($.)!='current' and lower-case($.)!='business' and lower-case($.)!='validation'" Error="Warning" P0="$." P1="'%MAJORVERSION%'" Title="The UpdateBranch policy value is not set to an allowed value" Text="The UpdateBranch policy value is '{0}' under 'HKLM\Software\Policies\Microsoft\Office\{1}.0\Common\Officeupdate'. This is not an allowed value as the only values you can use are 'Current', 'Business', or 'Validation'.&#xA;&#xA;Please click the 'Click here ...' link for more information on this group policy setting." GUID="626651" SSID="8b4be85c-71a7-4cfa-96d9-a1c4b6735cf2" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Configuration (unsupported or problematic),Product not updated"></Rule>
          </Setting>
          <Rule Name="fEnableAutomaticUpgrade15" Query="if((../Instance/Setting/@Key1='EnableAutomaticUpgrade')=true(),../Instance/Setting[@Key1='EnableAutomaticUpgrade']/Value,-1)"/>
          <Rule Name="fEnableAutomaticUpdates" Query="if((../Instance/Setting/@Key1='EnableAutomaticUpdates')=true(),../Instance/Setting[@Key1='EnableAutomaticUpdates']/Value,-1)"/>

          <Rule Name="fC2rUpdatePathPol" Query="if((../Instance/Setting/@Key1='updatepath')=true(),../Instance/Setting[@Key1='updatepath']/Value,-1)"/>

          <Rule Name="fC2rUpdateBranchPol" Query="if((../Instance/Setting/@Key1='updatebranch')=true(),../Instance/Setting[@Key1='updatebranch']/Value,-1)"/>

          <Rule Name="fC2rUpdateTargetVersionPol" Query="if((../Instance/Setting/@Key1='updatetargetversion')=true(),../Instance/Setting[@Key1='updatetargetversion']/Value,-1)"/>
          <Rule Name="fC2rUpdateDeadlinePol" Query="if((../Instance/Setting/@Key1='updatedeadline')=true(),../Instance/Setting[@Key1='updatedeadline']/Value,-1)"/>
          <Object Type="Group" Name="Hidden">
            <Rule Name="sC2rManagedUpdateVersionNotInstalled15Pol" Query="$n2DigitVersion=15 and $sC2RUpdatesReadyToApply15=false() and $fC2rUpdateTargetVersionPol!=-1 and versioncompare($fInstalledC2RVersion15,$fC2rUpdateTargetVersionPol)&lt;0" Error="None" P0="$fInstalledC2RVersion15" P1="$fC2rUpdateTargetVersionPol" Title="Office 2013 Click-to-run managed installation is not at the version specified by group policy" Text="You have version {0} while the version specified by your administrator (through group policy) is {1}. Because your Office installation version is being managed by your administrator, please contact them to discuss updating your Office installation." GUID="620360" SSID="3ec6070c-72b6-4cce-a5c4-d417e9995042" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="!Application updates missing"></Rule>
            <Rule Name="sC2RUpdatesDisabledPol" Query="$nInstallType='ClickToRun' and $fEnableAutomaticUpdates=0" Error="Warning" P0="if($n2DigitVersion=15,'2013','2016')" P1="'%MAJORVERSION%'" Title="Automatic updates for Office {0} Click-to-Run are disabled by group policy" Text="Automatic updating of your Click-to-Run installation is disabled by policy (EnableAutomaticUpdates=0 under 'HKLM\Software\Policies\Microsoft\Office\{1}.0\Common\Officeupdate'). It is recommended to enable this feature so Office has the latest updates installed. See your administrator if you need to change this policy." GUID="271987" SSID="cdb98fa5-5697-4322-9137-9ecf91557203" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Product not updated"/>
            <Rule Name="sC2R2013UpgradeTo2016DisabledPol" Title="Automatic upgrade from Office 2013 Click-to-Run to Office 2016 disabled by policy" P0="'%MAJORVERSION%'" Error="None" Query="$nInstallType='ClickToRun' and $n2DigitVersion=15 and $fEnableAutomaticUpgrade15=0" Text="Automatic upgrading of your Office 2013 Click-to-Run installation to Office 2016 is disabled by group policy (EnableAutomaticUpgrade=0 under HKLM\Software\Policies\Microsoft\Office\{0}.0\Common\Officeupdate). See your administrator if you need to change this policy." GUID="626066" SSID="9a01ffef-5fa0-4f9d-af8f-baf0c8c60e41" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Office upgrade"/>
          </Object>
        </Object>
      </Object>
    </Object>
	</Type>
  
	<Type Name="InstalledServicePack">
		<Object Type="Group" Name="Service Pack installed">
			<Object Type="Group" Name="hidden">
				<Rule Name="sOffice14NoServicePack" Query="$n2DigitVersion=14 and $OfficeUpdates_sOffice2010SP1NotInstalled=true() and $OfficeUpdates_sOffice2010SP2NotInstalled=true()" Text="No service pack installed"></Rule>
				<Rule Name="sOffice14SP1Installed" Query="$n2DigitVersion=14 and $OfficeUpdates_sOffice2010SP2NotInstalled=true() and $OfficeUpdates_sOffice2010SP1NotInstalled=false()" Text="Office 2010 Service Pack 1 (SP1) is installed"></Rule>
				<Rule Name="sOffice14SP2Installed" Query="$n2DigitVersion=14 and $OfficeUpdates_sOffice2010SP2NotInstalled=false()" Text="Office 2010 Service Pack 2 (SP2) is installed"></Rule>
				<Rule Name="sOffice15SP1Installed" Query="$nInstallType!='ClickToRun' and $n2DigitVersion=15 and if($bitness='x86',$OfficeUpdates_sOffice2013SP1NotInstalled=false(),$OfficeUpdates_sOffice2013SP1NotInstalledx64=false())" Text="Office 2013 Service Pack 1 (SP1) is installed"></Rule>
				<Rule Name="sOffice15SP1SlipstreamInstalled" Query="$nInstallType!='ClickToRun' and $n2DigitVersion=15 and $OfficeUpdates_fOffice2013SP1Slipstream=true()" Text="Office 2013 has SP1 slipstreamed into the installation"></Rule>
				<Rule Name="sOffice15NoServicePack" Query="$n2DigitVersion=15 and $nInstallType='MSI' and $OfficeUpdates_sOffice2013SP1NotInstalled=true()" Text="No service pack installed"></Rule>
				<Rule Name="sOffice16NoServicePack" Query="$nInstallType='MSI' and $n2DigitVersion=16" Text="No service packs available yet"></Rule>
			</Object>
		</Object>
	</Type>
	<Type Name="MachineDetails">
		<Object Type="Group" Name="VideoCardsList" Display="Hide">
			<Setting Key1="Devices" Display="Hide">
				<Rule Name="sVideoCards" Query="'PCI\VEN_1002&amp;DEV_796E;PCI\VEN_1002&amp;DEV_791E;PCI\VEN_1002&amp;DEV_791F;PCI\VEN_1002&amp;DEV_796F;PCI\VEN_1002&amp;DEV_793F;PCI\VEN_1002&amp;DEV_7941;PCI\VEN_1002&amp;DEV_7942;PCI\VEN_1002&amp;DEV_5A61;PCI\VEN_1002&amp;DEV_5A63;PCI\VEN_1002&amp;DEV_5A62;PCI\VEN_1002&amp;DEV_5A41;PCI\VEN_1002&amp;DEV_5A43;PCI\VEN_1002&amp;DEV_5A42;PCI\VEN_1002&amp;DEV_5954;PCI\VEN_1002&amp;DEV_5854;PCI\VEN_1002&amp;DEV_5955;PCI\VEN_1002&amp;DEV_5974;PCI\VEN_1002&amp;DEV_5874;PCI\VEN_1002&amp;DEV_5975;PCI\VEN_1002&amp;DEV_5653;PCI\VEN_1002&amp;DEV_3155;PCI\VEN_1002&amp;DEV_3175;PCI\VEN_1002&amp;DEV_4E54;PCI\VEN_1002&amp;DEV_5464;PCI\VEN_1002&amp;DEV_3154;PCI\VEN_1002&amp;DEV_564A;PCI\VEN_1002&amp;DEV_564B;PCI\VEN_1002&amp;DEV_5D49;PCI\VEN_1002&amp;DEV_71C4;PCI\VEN_1002&amp;DEV_71D4;PCI\VEN_1002&amp;DEV_4E52;PCI\VEN_1002&amp;DEV_4E56;PCI\VEN_1002&amp;DEV_4E50;PCI\VEN_1002&amp;DEV_4A4E;PCI\VEN_1002&amp;DEV_7149;PCI\VEN_1002&amp;DEV_714B;PCI\VEN_1002&amp;DEV_714C;PCI\VEN_1002&amp;DEV_714A;PCI\VEN_1002&amp;DEV_718B;PCI\VEN_1002&amp;DEV_718C;PCI\VEN_1002&amp;DEV_7196;PCI\VEN_1002&amp;DEV_7145;PCI\VEN_1002&amp;DEV_7186;PCI\VEN_1002&amp;DEV_718D;PCI\VEN_1002&amp;DEV_71C5;PCI\VEN_1002&amp;DEV_71D5;PCI\VEN_1002&amp;DEV_71DE;PCI\VEN_1002&amp;DEV_71D6;PCI\VEN_1002&amp;DEV_7102;PCI\VEN_1002&amp;DEV_7101;PCI\VEN_1002&amp;DEV_7284;PCI\VEN_1002&amp;DEV_718A;PCI\VEN_1002&amp;DEV_7188;PCI\VEN_1002&amp;DEV_5461;PCI\VEN_1002&amp;DEV_5460;PCI\VEN_1002&amp;DEV_3152;PCI\VEN_1002&amp;DEV_3150;PCI\VEN_1002&amp;DEV_5462;PCI\VEN_1002&amp;DEV_5652;PCI\VEN_1002&amp;DEV_5653;PCI\VEN_1002&amp;DEV_5673;PCI\VEN_1002&amp;DEV_564F;PCI\VEN_1002&amp;DEV_5D4A;PCI\VEN_1002&amp;DEV_5D48;PCI\VEN_1002&amp;DEV_5D48;PCI\VEN_1002&amp;DEV_7248;PCI\VEN_1002&amp;DEV_7268;PCI\VEN_1002&amp;DEV_554D;PCI\VEN_1002&amp;DEV_556D;PCI\VEN_1002&amp;DEV_5D52;PCI\VEN_1002&amp;DEV_5D72;PCI\VEN_1002&amp;DEV_4154;PCI\VEN_1002&amp;DEV_4174;PCI\VEN_1002&amp;DEV_5B64;PCI\VEN_1002&amp;DEV_5B74;PCI\VEN_1002&amp;DEV_3E54;PCI\VEN_1002&amp;DEV_3E74;PCI\VEN_1002&amp;DEV_7152;PCI\VEN_1002&amp;DEV_7172;PCI\VEN_1002&amp;DEV_7153;PCI\VEN_1002&amp;DEV_7173;PCI\VEN_1002&amp;DEV_71D2;PCI\VEN_1002&amp;DEV_71F2;PCI\VEN_1002&amp;DEV_958D;PCI\VEN_1002&amp;DEV_5E48;PCI\VEN_1002&amp;DEV_5E68;PCI\VEN_1002&amp;DEV_5551;PCI\VEN_1002&amp;DEV_5571;PCI\VEN_1002&amp;DEV_71DA;PCI\VEN_1002&amp;DEV_71FA;PCI\VEN_1002&amp;DEV_7105;PCI\VEN_1002&amp;DEV_7125;PCI\VEN_1002&amp;DEV_5550;PCI\VEN_1002&amp;DEV_5570;PCI\VEN_1002&amp;DEV_5D50;PCI\VEN_1002&amp;DEV_7104;PCI\VEN_1002&amp;DEV_5D70;PCI\VEN_1002&amp;DEV_7124;PCI\VEN_1002&amp;DEV_710E;PCI\VEN_1002&amp;DEV_712E;PCI\VEN_1002&amp;DEV_710F;PCI\VEN_1002&amp;DEV_712F;PCI\VEN_1002&amp;DEV_4E47;PCI\VEN_1002&amp;DEV_4E67;PCI\VEN_1002&amp;DEV_4E4B;PCI\VEN_1002&amp;DEV_4E6B;PCI\VEN_1002&amp;DEV_4A4D;PCI\VEN_1002&amp;DEV_4A6D;PCI\VEN_1002&amp;DEV_4147;PCI\VEN_1002&amp;DEV_4167;PCI\VEN_1002&amp;DEV_5B65;PCI\VEN_1002&amp;DEV_5B75;PCI\VEN_1002&amp;DEV_719B;PCI\VEN_1002&amp;DEV_71BB;PCI\VEN_1002&amp;DEV_3151;PCI\VEN_1002&amp;DEV_3171;PCI\VEN_1002&amp;DEV_724E;PCI\VEN_1002&amp;DEV_726E;PCI\VEN_1002&amp;DEV_4153;PCI\VEN_1002&amp;DEV_4173;PCI\VEN_1002&amp;DEV_4150;PCI\VEN_1002&amp;DEV_4E51;PCI\VEN_1002&amp;DEV_4151;PCI\VEN_1002&amp;DEV_4155;PCI\VEN_1002&amp;DEV_4152;PCI\VEN_1002&amp;DEV_4E71;PCI\VEN_1002&amp;DEV_4171;PCI\VEN_1002&amp;DEV_4170;PCI\VEN_1002&amp;DEV_4175;PCI\VEN_1002&amp;DEV_4172;PCI\VEN_1002&amp;DEV_7288;PCI\VEN_1002&amp;DEV_72A8;PCI\VEN_1002&amp;DEV_554E;PCI\VEN_1002&amp;DEV_556E;PCI\VEN_1002&amp;DEV_554D;PCI\VEN_1002&amp;DEV_556D;PCI\VEN_1002&amp;DEV_4B4B;PCI\VEN_1002&amp;DEV_4B6B;PCI\VEN_1002&amp;DEV_4B4A;PCI\VEN_1002&amp;DEV_4B6A;PCI\VEN_1002&amp;DEV_4B49;PCI\VEN_1002&amp;DEV_4B4C;PCI\VEN_1002&amp;DEV_4B6C;PCI\VEN_1002&amp;DEV_4B69;PCI\VEN_1002&amp;DEV_554C;PCI\VEN_1002&amp;DEV_556C;PCI\VEN_1002&amp;DEV_5D4C;PCI\VEN_1002&amp;DEV_5D6C;PCI\VEN_1002&amp;DEV_4144;PCI\VEN_1002&amp;DEV_4149;PCI\VEN_1002&amp;DEV_4E45;PCI\VEN_1002&amp;DEV_4E65;PCI\VEN_1002&amp;DEV_4164;PCI\VEN_1002&amp;DEV_4169;PCI\VEN_1002&amp;DEV_4E46;PCI\VEN_1002&amp;DEV_4E66;PCI\VEN_1002&amp;DEV_4146;PCI\VEN_1002&amp;DEV_4166;PCI\VEN_1002&amp;DEV_4E44;PCI\VEN_1002&amp;DEV_4E64;PCI\VEN_1002&amp;DEV_4E49;PCI\VEN_1002&amp;DEV_4E48;PCI\VEN_1002&amp;DEV_4E68;PCI\VEN_1002&amp;DEV_4148;PCI\VEN_1002&amp;DEV_4168;PCI\VEN_1002&amp;DEV_4E69;PCI\VEN_1002&amp;DEV_4E4A;PCI\VEN_1002&amp;DEV_4E6A;PCI\VEN_1002&amp;DEV_7146;PCI\VEN_1002&amp;DEV_7166;PCI\VEN_1002&amp;DEV_714E;PCI\VEN_1002&amp;DEV_715E;PCI\VEN_1002&amp;DEV_714D;PCI\VEN_1002&amp;DEV_71C3;PCI\VEN_1002&amp;DEV_718F;PCI\VEN_1002&amp;DEV_716E;PCI\VEN_1002&amp;DEV_717E;PCI\VEN_1002&amp;DEV_716D;PCI\VEN_1002&amp;DEV_71E3;PCI\VEN_1002&amp;DEV_71AF;PCI\VEN_1002&amp;DEV_7142;PCI\VEN_1002&amp;DEV_7180;PCI\VEN_1002&amp;DEV_7183;PCI\VEN_1002&amp;DEV_7187;PCI\VEN_1002&amp;DEV_7162;PCI\VEN_1002&amp;DEV_71A0;PCI\VEN_1002&amp;DEV_71A3;PCI\VEN_1002&amp;DEV_71A7;PCI\VEN_1002&amp;DEV_7147;PCI\VEN_1002&amp;DEV_715F;PCI\VEN_1002&amp;DEV_719F;PCI\VEN_1002&amp;DEV_7167;PCI\VEN_1002&amp;DEV_717F;PCI\VEN_1002&amp;DEV_7143;PCI\VEN_1002&amp;DEV_7193;PCI\VEN_1002&amp;DEV_7163;PCI\VEN_1002&amp;DEV_71B3;PCI\VEN_1002&amp;DEV_71CE;PCI\VEN_1002&amp;DEV_71EE;PCI\VEN_1002&amp;DEV_7140;PCI\VEN_1002&amp;DEV_71C0;PCI\VEN_1002&amp;DEV_71C2;PCI\VEN_1002&amp;DEV_7181;PCI\VEN_1002&amp;DEV_71CD;PCI\VEN_1002&amp;DEV_7160;PCI\VEN_1002&amp;DEV_71E2;PCI\VEN_1002&amp;DEV_71E6;PCI\VEN_1002&amp;DEV_71A1;PCI\VEN_1002&amp;DEV_71ED;PCI\VEN_1002&amp;DEV_71E0;PCI\VEN_1002&amp;DEV_71C6;PCI\VEN_1002&amp;DEV_71C1;PCI\VEN_1002&amp;DEV_7293;PCI\VEN_1002&amp;DEV_7291;PCI\VEN_1002&amp;DEV_71C7;PCI\VEN_1002&amp;DEV_71E1;PCI\VEN_1002&amp;DEV_72B3;PCI\VEN_1002&amp;DEV_72B1;PCI\VEN_1002&amp;DEV_71E7;PCI\VEN_1002&amp;DEV_7100;PCI\VEN_1002&amp;DEV_7108;PCI\VEN_1002&amp;DEV_7109;PCI\VEN_1002&amp;DEV_710A;PCI\VEN_1002&amp;DEV_710B;PCI\VEN_1002&amp;DEV_710C;PCI\VEN_1002&amp;DEV_7120;PCI\VEN_1002&amp;DEV_7128;PCI\VEN_1002&amp;DEV_7129;PCI\VEN_1002&amp;DEV_712A;PCI\VEN_1002&amp;DEV_712B;PCI\VEN_1002&amp;DEV_712C;PCI\VEN_1002&amp;DEV_7243;PCI\VEN_1002&amp;DEV_7245;PCI\VEN_1002&amp;DEV_7246;PCI\VEN_1002&amp;DEV_7247;PCI\VEN_1002&amp;DEV_7248;PCI\VEN_1002&amp;DEV_7249;PCI\VEN_1002&amp;DEV_724A;PCI\VEN_1002&amp;DEV_724B;PCI\VEN_1002&amp;DEV_724C;PCI\VEN_1002&amp;DEV_724D;PCI\VEN_1002&amp;DEV_724F;PCI\VEN_1002&amp;DEV_7263;PCI\VEN_1002&amp;DEV_7265;PCI\VEN_1002&amp;DEV_7266;PCI\VEN_1002&amp;DEV_7267;PCI\VEN_1002&amp;DEV_7268;PCI\VEN_1002&amp;DEV_7269;PCI\VEN_1002&amp;DEV_726A;PCI\VEN_1002&amp;DEV_726B;PCI\VEN_1002&amp;DEV_726C;PCI\VEN_1002&amp;DEV_726D;PCI\VEN_1002&amp;DEV_726F;PCI\VEN_1002&amp;DEV_7240;PCI\VEN_1002&amp;DEV_7244;PCI\VEN_1002&amp;DEV_7280;PCI\VEN_1002&amp;DEV_7260;PCI\VEN_1002&amp;DEV_7264;PCI\VEN_1002&amp;DEV_72A0;PCI\VEN_1002&amp;DEV_5B60;PCI\VEN_1002&amp;DEV_5B63;PCI\VEN_1002&amp;DEV_5B73;PCI\VEN_1002&amp;DEV_5B70;PCI\VEN_1002&amp;DEV_5657;PCI\VEN_1002&amp;DEV_5677;PCI\VEN_1002&amp;DEV_5B62;PCI\VEN_1002&amp;DEV_5B72;PCI\VEN_1002&amp;DEV_3E50;PCI\VEN_1002&amp;DEV_3E70;PCI\VEN_1002&amp;DEV_5E4D;PCI\VEN_1002&amp;DEV_5E4B;PCI\VEN_1002&amp;DEV_5E6B;PCI\VEN_1002&amp;DEV_5E4C;PCI\VEN_1002&amp;DEV_5E6C;PCI\VEN_1002&amp;DEV_5E6D;PCI\VEN_1002&amp;DEV_5E4A;PCI\VEN_1002&amp;DEV_5E6A;PCI\VEN_1002&amp;DEV_5E4F;PCI\VEN_1002&amp;DEV_5E6F;PCI\VEN_1002&amp;DEV_554B;PCI\VEN_1002&amp;DEV_556B;PCI\VEN_1002&amp;DEV_5549;PCI\VEN_1002&amp;DEV_554F;PCI\VEN_1002&amp;DEV_5D4F;PCI\VEN_1002&amp;DEV_5569;PCI\VEN_1002&amp;DEV_556F;PCI\VEN_1002&amp;DEV_5D6F;PCI\VEN_1002&amp;DEV_4A49;PCI\VEN_1002&amp;DEV_4A69;PCI\VEN_1002&amp;DEV_4A4F;PCI\VEN_1002&amp;DEV_4A6F;PCI\VEN_1002&amp;DEV_4A48;PCI\VEN_1002&amp;DEV_4A4A;PCI\VEN_1002&amp;DEV_4A4C;PCI\VEN_1002&amp;DEV_5548;PCI\VEN_1002&amp;DEV_4A68;PCI\VEN_1002&amp;DEV_4A6A;PCI\VEN_1002&amp;DEV_4A6C;PCI\VEN_1002&amp;DEV_5568;PCI\VEN_1002&amp;DEV_4A54;PCI\VEN_1002&amp;DEV_4A74;PCI\VEN_1002&amp;DEV_4A4B;PCI\VEN_1002&amp;DEV_5D57;PCI\VEN_1002&amp;DEV_4A50;PCI\VEN_1002&amp;DEV_554A;PCI\VEN_1002&amp;DEV_4A70;PCI\VEN_1002&amp;DEV_556A;PCI\VEN_1002&amp;DEV_4A6B;PCI\VEN_1002&amp;DEV_5D77;PCI\VEN_1002&amp;DEV_5D52;PCI\VEN_1002&amp;DEV_5D4D;PCI\VEN_1002&amp;DEV_5D6D;PCI\VEN_1002&amp;DEV_5D72;PCI\VEN_1002&amp;DEV_5B66;PCI\VEN_1002&amp;DEV_5B76;PCI\VEN_1002&amp;DEV_5B61;PCI\VEN_1002&amp;DEV_5B71;PCI\VEN_1002&amp;DEV_7141;PCI\VEN_1002&amp;DEV_714F;PCI\VEN_1002&amp;DEV_7151;PCI\VEN_1002&amp;DEV_7161;PCI\VEN_1002&amp;DEV_716F;PCI\VEN_1002&amp;DEV_7171;PCI\VEN_1002&amp;DEV_7290;PCI\VEN_1002&amp;DEV_7297;PCI\VEN_1002&amp;DEV_72B0;PCI\VEN_1002&amp;DEV_72B7;PCI\VEN_1002&amp;DEV_7289;PCI\VEN_1002&amp;DEV_728B;PCI\VEN_1002&amp;DEV_72A9;PCI\VEN_1002&amp;DEV_72AB;PCI\VEN_10DE&amp;DEV_0A6C;'">
				</Rule>
			</Setting>
		</Object>
		<Object Type="GetComputerNameEx">
			<Setting Key1="ComputerNameNetBIOS" Substitution="MACHINENAME" Display="Hide"/>
			<Object Type="Group" Name="%MACHINENAME% System Details" Class="System Details" GroupingClass="True" Task="Offline Scan" TrackProgress="TrackProgress" LogText="Collecting %MACHINENAME% System and OS Details">
				<Object Type="Group" Name="Computer Details" Display="Right" TrackProgress="TrackProgress">
					<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_ComputerSystem" Display="Hide">
						<Setting Key1="AdminPasswordStatus"/>
						<Setting Key1="AutomaticManagedPagefile"/>
						<Setting Key1="AutomaticResetBootOption"/>
						<Setting Key1="AutomaticResetCapability"/>
						<Setting Key1="BootROMSupported"/>
						<Setting Key1="BootupState"/>
						<Setting Key1="Caption" NotForExport="True"/>
						<Setting Key1="ChassisBootupState"/>
						<Setting Key1="CreationClassName"/>
						<Setting Key1="CurrentTimeZone"/>
						<Setting Key1="DaylightInEffect"/>
						<Setting Key1="Description"/>
						<Setting Key1="DNSHostName" NotForExport="True"/>
						<Setting Key1="Domain" NotForExport="True"/>
						<Setting Key1="DomainRole"/>
						<Setting Key1="EnableDaylightSavingsTime"/>
						<Setting Key1="FrontPanelResetStatus"/>
						<Setting Key1="InfraredSupported"/>
						<Setting Key1="KeyboardPasswordStatus"/>
						<Setting Key1="Manufacturer">
							<Rule Name="computerManufacturer" Query="$."></Rule>
							<Rule Name="sVMWare" Query="$.='VMware, Inc.'" Error="None" Text="Office for Windows is running on VMware" Title="The configuration information indicates Office is running on virtualized hardware where the manufacturer is 'VMware, Inc.'." SSID="4bc09125-52eb-41fb-98e1-a2be26a4d269" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
							<Rule Name="sApple" Query="$.='Apple Inc.' or contains($.,'Parallels')" Error="None" Text="Office for Windows is running on a Macintosh computer" Title="The computer manufacturer has been found to be either 'Apple, Inc' or 'Parallels Software International Inc.'. This indicates Office for Windows is running on a Macintosh computer." SSID="017a7368-0a90-4249-8f73-ed1ca1aa02c9" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
						</Setting>
						<Setting Key1="Model">
							<Rule Name="sMicrosoftVM" Query="lower-case($.)='virtual machine' and lower-case($computerManufacturer)='microsoft corporation'" Error="None" Text="Microsoft Virtual Machine detected" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
						</Setting>
						<Setting Key1="Name" NotForExport="True"/>
						<Setting Key1="NetworkServerModeEnabled"/>
						<Setting Key1="NumberOfLogicalProcessors"/>
						<Setting Key1="NumberOfProcessors"/>
            <Setting Key1="PartOfDomain">
              <Rule Name="sDomainJoinedComputer" Query="$.='True'" Text="Domain joined machine" SSID="af17ff45-a9fa-4484-8532-d3a6d5013ce6"></Rule>
            </Setting>
						<Setting Key1="PauseAfterReset"/>
						<Setting Key1="PCSystemType"/>
						<Setting Key1="PowerOnPasswordStatus"/>
						<Setting Key1="PowerState"/>
						<Setting Key1="PowerSupplyState"/>
						<Setting Key1="PrimaryOwnerName" NotForExport="True"/>
						<Setting Key1="ResetCapability"/>
						<Setting Key1="ResetCount"/>
						<Setting Key1="ResetLimit"/>
						<Setting Key1="Roles"/>
						<Setting Key1="Status"/>
						<Setting Key1="SystemType"/>
						<Setting Key1="ThermalState"/>
						<Setting Key1="TotalPhysicalMemory"/>
						<Setting Key1="UserName" NotForExport="True"/>
						<Setting Key1="WakeUpType"/>
					</Object>
					<Object Type="Group" Name="BIOS" Display="Right">
						<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_BIOS" Display="Hide">
							<Setting Key1="__VALUES"></Setting>
						</Object>
					</Object>
          <Object Type="Group" Name="Drive Info" Display="Right" TrackProgress="TrackProgress">
            <Object Type="WMI" Key3="Win32_LogicalDisk" Display="Hide">
              <Setting Key1="Name" Substitution="DRIVENAME" Display="Hide"></Setting>
              <Setting Key1="DriveType" Substitution="DRIVETYPE" Display="Hide"></Setting>
              <Setting Key1="Size" Substitution="DRIVESIZE" Display="Hide"></Setting>
              <Setting Key1="FreeSpace" Substitution="DRIVESPACE" Display="Hide"></Setting>
              <Object Type="Group" Name="%DRIVENAME%" Display="Right">
                <Setting Key1="" Display="Hide"></Setting>
                <Object Type="If" Key1="%DRIVETYPE%=2">
                  <Object Type="Group" Name="Type =Removable" Display="Right">
                    <Setting Key1="" Display="Hide"></Setting>
                  </Object>
                </Object>
                <Object Type="If" Key1="%DRIVETYPE%=3">
                  <Object Type="Group" Name="Type =Local disk" Display="Right">
                    <Setting Key1="" Display="Hide"></Setting>
                  </Object>
                </Object>
                <Object Type="If" Key1="%DRIVETYPE%=4">
                  <Object Type="Group" Name="Type =Network drive" Display="Right">
                    <Setting Key1="" Display="Hide"></Setting>
                  </Object>
                </Object>
                <Object Type="If" Key1="%DRIVETYPE%=5">
                  <Object Type="Group" Name="Type =Compact disc" Display="Right">
                    <Setting Key1="" Display="Hide"></Setting>
                  </Object>
                </Object>
                <Object Type="If" Key1="%DRIVETYPE%=6">
                  <Object Type="Group" Name="Type =RAM disk" Display="Right">
                    <Setting Key1="" Display="Hide"></Setting>
                  </Object>
                </Object>
                <Object Type="Group" Name="Drive size">
                  <Rule Name="fDriveSpaceValue" Query="if(//Instance[Setting[@Key1='Size' and Value&gt;0] and Setting[@Key1='Name' and Value='%DRIVENAME%']]=true(),//Instance[Setting[@Key1='Size' and Value&gt;0] and Setting[@Key1='Name' and Value='%DRIVENAME%']]/Setting[@Key1='Size']/Value,-1)"></Rule>
                  <Rule Name="sDriveSize" Query="$fDriveSpaceValue&gt;0" P0="round($fDriveSpaceValue div 107374182.4) div 10" Text="Size ={0} GB"></Rule>
                </Object>
                <Object Type="Group" Name="Free space" Display="Right">
                 <Rule Name="fFreeSpaceValue" Query="if(//Instance[Setting[@Key1='FreeSpace' and Value&gt;0] and Setting[@Key1='Name' and Value='%DRIVENAME%']]=true(),//Instance[Setting[@Key1='FreeSpace' and Value&gt;0] and Setting[@Key1='Name' and Value='%DRIVENAME%']]/Setting[@Key1='FreeSpace']/Value,-1)"></Rule>
                  <Rule Name="sFreeSpace" Query="$fFreeSpaceValue&gt;0" P0="round($fFreeSpaceValue div 107374182.4) div 10" Text="Free space ={0} GB"></Rule>
                </Object>
              </Object>
              <Rule Name="sSystemDriveSize" Query="round(../Instance[Setting[@Key1='Name' and Value=$OSDetails_sSystemDrive]]/Setting[@Key1='Size']/Value div 1073741824)"></Rule>
              <Rule Name="sOutlookSyncWindowThreshold" Query="if($sSystemDriveSize&lt;=32,'1',if($sSystemDriveSize&gt;32 and $sSystemDriveSize&lt;=64,'3','12'))"></Rule>
            </Object>
          </Object>
					<Object Type="Engine" Display="Hide">
						<Setting Key1="EnvironmentVariable" Key2="SESSIONNAME" Substitution="SESSIONNAME" Display="Hide">
							<Rule Name="fTermServer" Query="((starts-with(lower-case('%SESSIONNAME%'),'rdp')) or (starts-with(lower-case('%SESSIONNAME%'),'ica')))=true()"></Rule>
						</Setting>
					</Object>
          
          <!-- Operating System Details-->
          <!--Reference Type="OSDetails" Name="OSDetails" File="common.config.xml">
          </Reference-->
          <!-- /Operating System Details-->
					
				</Object>
				<!--Windows XP -->
				<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_OperatingSystem" Key4="Version LIKE '%5.%'" Display="Hide">
					<Setting Key1="Version" Substitution="WINDOWSVERSION" Display="Hide">
					</Setting>
					<Object Type="Group" Name="Antivirus software">
						<Object Type="WMI" Key1="%MACHINENAME%" Key2="root\SecurityCenter" Key3="AntiVirusProduct">
							<Setting Key1="displayName">
								<Rule Name="displayNameXP" Query="$."/>
							</Setting>
							<Setting Key1="pathToEnableOnAccessUI"/>
							<Setting Key1="onAccessScanningEnabled">
								<Rule Name="AVScanningEnabledXP" P0="$displayNameXP" Query="$.='False'" Text="Your antivirus software ({0}) real-time scanning is not enabled."/>
							</Setting>
							<Rule Name="nAVRunningXP" Query="count(../Instance/Setting[@Key1='onAccessScanningEnabled' and Value='True'])"></Rule>
							<Rule Name="sNoAVRunningXP" Query="$nAVRunningXP=0" Error="Error" Title="No antivirus scanning enabled" Text="Real-time antivirus software scanning is not enabled." P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Antivirus,Security"></Rule>
							<Setting Key1="productUptoDate">
								<Rule Name="AVOutOfDateXP" P0="$displayNameXP" Title="Your antivirus software definitions are out of date" Error="Warning" Query="$.='False'" Text="Please check your antivirus software '{0}' as the definitions appear to be out of date." P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Antivirus,Security"/>
							</Setting>
						</Object>
					</Object>
				</Object>
				<!--Vista SP2 and above -->
				<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_OperatingSystem" Key4="(NOT Version LIKE '%5.%') AND (ProductType='1')" Display="Hide">
					<Setting Key1="Version" Substitution="WINDOWSVERSION" Display="Hide">
					</Setting>
					<Object Type="Group" Name="Antivirus software">
						<Object Type="WMI" Key1="%MACHINENAME%" Key2="root\SecurityCenter2" Key3="AntiVirusProduct">
							<Setting Key1="displayName">
								<Rule Name="displayName" Query="$."/>
							</Setting>
							<Setting Key1="pathToSignedProductExe"/>
							<Setting Key1="productstate">
								<Rule Name="AVOutOfDate" Title="Your antivirus software definitions are out of date" Error="Warning" Query="bitwise-and($.,16)=16" Text="Please check your antivirus software '{0}' as the definitions appear to be out of date." P0="$displayName" SSID="6c23a007-ab18-4b6d-bb8a-17afe8a4dccf" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Antivirus,Security"/>
								<Rule Name="AVRunning" Query="bitwise-and($.,4096) = 4096" Text="Your antivirus software '{0}' real-time scanning is enabled." P0="$displayName" SSID="8b683a42-7e91-4a06-8e84-aeba4966e9b1"/>
								<Rule Name="AVNotRunning" Query="bitwise-and($.,4096) != 4096" Text="Your antivirus software '{0}' real-time scanning is not enabled." P0="$displayName" SSID="5e73bd47-edc5-4138-8a19-7387f8eb2347"/>
							</Setting>
							<Rule Name="nAVRunning" Query="count(../Instance/Setting[@Key1='productstate' and bitwise-and(Value,4096)=4096])"></Rule>
							<Rule Name="sNoAVRunning" Query="$nAVRunning=0" Error="Error" Title="No antivirus scanning enabled" Text="Real-time antivirus software scanning is not enabled." P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Antivirus,Security"></Rule>
						</Object>
					</Object>
				</Object>
				<Object Type="Group" Name="Pointing Devices" Display="Right" TrackProgress="TrackProgress">
					<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_PointingDevice" Display="Hide">
						<Setting Key1="PointingType">
							<Rule Name="sTouchDevice" Error="None" Query="$.=8" P0="$sDeviceName" Title="Touch enabled device." Text="{0} is a touch enabled device." Symptoms="Informational">
							</Rule>
						</Setting>
						<Setting Key1="Name">
							<Rule Name="sDeviceName" Query="$.">
							</Rule>
						</Setting>
					</Object>
				</Object>
				<Object Type="Group" Name="Video Controllers" Display="Right" TrackProgress="TrackProgress">
					<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_VideoController" Display="Hide">
						<Setting Key1="Description">
						</Setting>
						<Setting Key1="PNPDeviceID" Format="(PCI\\VEN.*)(\x26SUBSYS.*)----$1">
							<Rule Name="sVideoCardCrashesOutlook15" Query="($.='PCI\VEN_1002&amp;DEV_6740') and $n2DigitVersion=15" Error="Error" Title="Video card configuration may crash Outlook 2013" Text="Your video card has been known to crash Outlook 2013. If an updated video driver does not reduce crashes in Outlook, we recommend you disable Hardware Acceleration in Office programs. Please click the 'Click here ...' link for details." GUID="273849" SSID="f82a8728-44ee-4bfe-b0c1-036c9067ade8" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash,Video"></Rule>
							<Rule Name="sPNPDeviceID" Query="$.">
							</Rule>
							<Rule Name="sUnsupportVideoDriver" Query="contains($sVideoCards,$sPNPDeviceID) and $n2DigitVersion&gt;14" Error="Warning" Title="Hardware acceleration is disabled by Office" Text="Hardware acceleration is disabled in Office programs because your video configuration is not compatible with Office 2013. Please update your video driver as your vendor may have an updated version that is compatible with Office 2013." GUID="273849" SSID="bfdda70c-a464-4222-afaa-1407a69b3cb8" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Display,Video">
							</Rule>
						</Setting>
						<Setting Key1="DriverVersion">
						</Setting>
						<Rule Name="sIntelVideoCard0166" Query="(../Instance[Setting[@Key1='DriverVersion' and Value='10.18.0010.3621'] and Setting[@Key1='PNPDeviceID' and Value='PCI\VEN_8086&amp;DEV_0166']]) and $n2DigitVersion=15 and versioncompare($MSO_sMso2013Version,'15.0.4641.1001')&lt;=0" Error="Error" P0="../Instance[Setting[@Key1='DriverVersion' and Value='10.18.0010.3621'] and Setting[@Key1='PNPDeviceID' and Value='PCI\VEN_8086&amp;DEV_0166']]/Setting[@Key1='Description']/Value" P1="../Instance[Setting[@Key1='DriverVersion' and Value='10.18.0010.3621'] and Setting[@Key1='PNPDeviceID' and Value='PCI\VEN_8086&amp;DEV_0166']]/Setting[@Key1='DriverVersion']/Value" Title="Video card configuration known to cause display issues in Office programs" Text="The configuration of your video card '{0}' has been known to cause video display problems in Office 2013 programs. To resolve this issue we recommend you update your video driver (version '{1}') to a newer version. Please click the 'Click here ...' link for details." GUID="510076" SSID="fc819134-a481-490c-91e9-9ac5355645d3" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Display,Video"></Rule>
						<Rule Name="sIntelVideoCard0162" Query="(../Instance[Setting[@Key1='DriverVersion' and Value='10.18.0010.3621'] and Setting[@Key1='PNPDeviceID' and Value='PCI\VEN_8086&amp;DEV_0162']]) and $n2DigitVersion=15 and versioncompare($MSO_sMso2013Version,'15.0.4641.1001')&lt;=0" Error="Error" P0="../Instance[Setting[@Key1='DriverVersion' and Value='10.18.0010.3621'] and Setting[@Key1='PNPDeviceID' and Value='PCI\VEN_8086&amp;DEV_0162']]/Setting[@Key1='Description']/Value" P1="../Instance[Setting[@Key1='DriverVersion' and Value='10.18.0010.3621'] and Setting[@Key1='PNPDeviceID' and Value='PCI\VEN_8086&amp;DEV_0162']]/Setting[@Key1='DriverVersion']/Value" Title="Video card configuration known to cause display issues in Office programs" Text="The configuration of your video card '{0}' has been known to cause video display problems in Office 2013 programs. To resolve this issue we recommend you update your video driver (version '{1}') to a newer version. Please click the 'Click here ...' link for details." GUID="510076" SSID="0b57daf2-36b2-4764-b47b-c0f606c0667b" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Display,Video"></Rule>
						<Rule Name="fIntelHDGraphics4000" Query="count(../Instance/Setting[@Key1='Description' and contains(Value,'HD Graphics 4000')])&gt;0"></Rule>
						<Rule Name="fNVIDIACard" Query="count(../Instance/Setting[@Key1='Description' and contains(Value,'NVIDIA')])&gt;0"></Rule>
						<Rule Name="sMultipleVideoCardsPlusHWAccelEnabled" Query="$n2DigitVersion=15 and $appName='Outlook' and $MSO_fC2R2013SP1UpdateInstalled and $fIntelHDGraphics4000 and $fNVIDIACard and not($sDisableHardwareAcceleration)" Error="Error" Title="Outlook stops at 'Loading Profile' due to video hardware conflict" Text="When you start Outlook 2013 the program stops at the 'Loading Profile' step. This problem occurs when the hardware acceleration feature in Office conflicts with video cards that need to have updated drivers installed.&#xA;&#xA;Please click the 'Click here ...' link for complete details and solutions." GUID="394979" SSID="30780dcd-df87-4525-8008-393d79ba621c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash,Freeze,Startup"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\Common\Graphics" Display="Right">
						<Setting Key1="DisableHardwareAcceleration">
						</Setting>
						<Rule Name="fDisableHardwareAcceleration" Query="if((../Instance/Setting/@Key1='DisableHardwareAcceleration')=true(),../Instance/Setting[@Key1='DisableHardwareAcceleration']/Value,-1)">
						</Rule>
						<Rule Name="sDisableHardwareAcceleration" Query="$n2DigitVersion&gt;14 and $sUnsupportVideoDriver=false() and (($fDisableHardwareAcceleration=1 and $fDisableHardwareAccelerationPol=-1) or $fDisableHardwareAccelerationPol=1)" Error="Warning" Title="Hardware acceleration is disabled" Text="You have hardware acceleration disabled. If you have been having video-related problems in Office programs, you should check for an updated video driver. If the driver upgrade fixes the problems, it is recommended you re-enable hardware acceleration." GUID="273849" SSID="3e1b6f41-e5a1-425d-b3f4-cbe7a1f6f801" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Display,Video">
              <Fix ManualOnly="True">
                <Actions>
                  <Action Name="SetValue" KeyName="HKCU\Software\Microsoft\Office\%MAJORVERSION%.0\Common\Graphics" Type="Registry" Value="0" ValueName="DisableHardwareAcceleration" ValueType="REG_DWORD">
                  </Action>
                </Actions>
              </Fix>
						</Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Policies\Microsoft\Office\%MAJORVERSION%.0\Common\Graphics" Display="Right">
						<Setting Key1="DisableHardwareAcceleration">
						</Setting>
						<Rule Name="fDisableHardwareAccelerationPol" Query="if((../Instance/Setting/@Key1='DisableHardwareAcceleration')=true(),../Instance/Setting[@Key1='DisableHardwareAcceleration']/Value,-1)">
						</Rule>
					</Object>
				</Object>
				<Object Type="Group" Name="Network Adapters" Display="Right" TrackProgress="TrackProgress" Class="System Details">
					<Object Type="NICS">
						<Setting Key1="Description">
							<Rule Name="nicDesc" Query="$."></Rule>
						</Setting>
						<Setting Key1="NetworkInterfaceType">
						</Setting>
						<Setting Key1="OperationalStatus">
						</Setting>
						<Setting Key1="Speed">
							<Rule Name="nicSpeed" Query="$."></Rule>
							<Rule Name="sSlowConnection" Query="$n2DigitVersion=14 and lower-case($appName)='outlook' and not($fMapiHttpConnected14) and $nicSpeed&lt;number($effectiveSlowBitrate+1)" P0="$nicDesc" Error="Warning" Title="Slow connection detected: {0}" Text="The network adapter speed is considered &quot;slow&quot;, so Outlook will use different behavior for some functions." GUID="282071" SSID="8f11e99f-674d-4996-a091-9cfdd7b70ca6" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Delay,Exchange connection,Slowness" AlwaysEvaluate="True" Task="Full scan"></Rule>
						</Setting>
						<Setting Key1="Support">
						</Setting>
						<Setting Key1="DefaultGateway" NotForExport="True">
						</Setting>
						<Setting Key1="DhcpServerAddresses" NotForExport="True">
						</Setting>
						<Setting Key1="DnsAddresses" NotForExport="True">
						</Setting>
						<Setting Key1="DnsSuffix" NotForExport="True">
						</Setting>
						<Setting Key1="IPv4Addresses" NotForExport="True">
						</Setting>
						<Setting Key1="IPv6Addresses" NotForExport="True">
						</Setting>
					</Object>
					<Object Type="Engine" Display="Hide">
						<Setting Key1="EnvironmentVariable" Key2="WINDIR" Substitution="WINDIR" Display="Hide"></Setting>
						<Object Type="File" Key2="%WINDIR%\System32\Drivers\etc\hosts">
							<Setting Key1="Text"></Setting>
						</Object>
            <Object Type="CommandLine" Key2="%WINDIR%\system32\findstr.exe" Key3="/r /i /c:&quot;^[^\#]*autodiscover\.outlook\.com&quot; %WINDIR%\system32\drivers\etc\hosts" Display="Hide">
              <Setting Key1="Output" Substitution="FINDSTROUTPUT" SubstitutionFormat="(^\s*)(.*autodiscover.outlook.com)(.*)----$2" Display="Hide">
                <Rule Name="sCloudMbxAutodiscoverInHostsFile" Query="$appName='Outlook' and contains('%FINDSTROUTPUT%','autodiscover.outlook.com')" Error="Error" P0="'%FINDSTROUTPUT%'" P1="'%WINDIR%'" Title="Office 365 connection issue because the Hosts file contains an entry for Autodiscover.Outlook.com" Text="The Hosts file in the '{1}\system32\drivers\etc' folder contains a hard-coded entry for the Autodiscover server in Office 365.&#xA;&#xA;{0}&#xA;&#xA;After June 26, 2015 you will not be able to connect to Exchange Online with this entry in the Host file. Click the 'Click here ...' link for information on this issue and a link to an article with steps to reset the Hosts file back to the default settings." GUID="615830" SSID="3357f5b6-fdcc-4543-b6a4-cb884fb85d4f" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Error message,Office 365"></Rule>
              </Setting>
            </Object>
            <Object Type="CommandLine" Key2="%WINDIR%\system32\findstr.exe" Key3="/r /i /c:&quot;^[^\#]*autodiscover\.&quot; %WINDIR%\system32\drivers\etc\hosts" Display="Hide">
              <Setting Key1="Output" Substitution="FINDSTROUTPUT" SubstitutionFormat="(^\s*)(.*autodiscover.)(.*)----$2" Display="Hide">
                <Rule Name="sAutodiscoverHostsEntry" Query="$."></Rule>
                <Rule Name="sAutodiscoverInHostsFile" Query="$appName='Outlook' and contains($sAutodiscoverHostsEntry,'autodiscover') and not(contains($sAutodiscoverHostsEntry,'autodiscover.outlook.com'))" Error="None" P0="$sAutodiscoverHostsEntry" P1="'%WINDIR%'" Title="Possible Exchange connection issue because the Hosts file contains an entry for Autodiscover" Text="The Hosts file in the {1}\system32\drivers\etc folder contains a hard-coded entry for the Autodiscover server.&#xA;&#xA;{0}&#xA;&#xA;You may not be able to retrieve Autodiscover information with this entry in the Hosts file.&#xA;­&#xA;Please check with your administrator to ensure this is a correct configuration." SSID="ff8aaee2-c9e4-4c9b-8bfa-ed80addda504" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Autodiscover,Exchange connection"></Rule>
              </Setting>
            </Object>
					</Object>
					<Object Type="Group" Name="IPv6 registry data">
						<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="System\CurrentControlSet\Services\Tcpip6\Parameters">
							<Setting Key1="DisabledComponents">
								<Rule Name="sIPV6DisabledAll" Query="$.=4294967295" Error="None" P0="$." Title="All IPv6 components are disabled except for the IPv6 loopback interface" Text="DisabledComponents={0} (decimal value) in the registry. In this configuration, all IPv6 components are disabled except for the IPv6 loopback interface." GUID="392781" SSID="be3fca2d-d2de-4ce4-8f84-4a29fcae8407" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational">
								</Rule>
								<Rule Name="sPreferIPv4OverIPv6" Query="$.=32" Error="None" P0="$." Title="IPv4 preferred over IPv6" Text="DisabledComponents={0} (decimal value) in the registry. In this configuration, IPv4 is preferred over IPv6." GUID="392781" SSID="402a1b9a-df94-4ceb-aee0-25fa0eb8500f" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational">
								</Rule>
								<Rule Name="sIPV6DisabledOnNonTunnelInterfaces" Query="$.=16" P0="$." Error="None" Title="IPv6 disabled on all non-tunnel interfaces" Text="DisabledComponents={0} (decimal value) in the registry. In this configuration, IPv6 is disabled on all non-tunnel interfaces." GUID="392781" SSID="cda638bf-57e3-42cf-ab3d-67be3f056149" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational">
								</Rule>
								<Rule Name="sIPV6DisabledOnAllTunnelInterfaces" Query="$.=1" P0="$." Error="None" Title="IPv6 disabled on all tunnel interfaces" Text="DisabledComponents={0} (decimal value) in the registry. In this configuration, IPv6 is disabled on all tunnel interfaces." GUID="392781" SSID="60f64d1c-482d-4fd4-a459-d5988e5eac5a" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational">
								</Rule>
								<Rule Name="sIPV6InterfacesDisabledNotIPV6Loopback" Query="$.=17" P0="$." Error="None" Title="IPv6 disabled on all interfaces except for the IPv6 loopback interface" Text="DisabledComponents={0} (decimal value) in the registry. In this configuration, IPv6 is disabled on all interfaces except for the IPv6 loopback interface." GUID="392781" SSID="3cb109c7-6448-4650-9123-33636a8de0a9" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational">
								</Rule>
							</Setting>
							<Rule Name="fDisabledComponentsNotFound" Query="not(../Instance[Setting/@Key1='DisabledComponents'])" Text="DisabledComponents DWORD not found"></Rule>
						</Object>
					</Object>
			</Object>
				<Object Type="Group" Name="Network Drive Details" TrackProgress="TrackProgress" Display="Right">
					<Object Type="Group" Name="Mapped Network Drives (reachable)" Class="Network Drive Details" GroupingClass="True" Display="Right">
						<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_LogicalDisk" Key4="((DriveType=4) AND (FreeSpace&gt;0))" Display="Hide">
							<Setting Key1="DeviceID"></Setting>
							<Setting Key1="ProviderName" NotForExport="True"></Setting>
						</Object>
					</Object>
					<Object Type="Group" Name="Mapped Network Drives (unreachable!)" Class="Network Drive Details" GroupingClass="True" Display="Right">
						<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_LogicalDisk" Key4="((DriveType=4) AND (FreeSpace IS Null))" Display="Hide">
							<Rule Name="nUnreachableDriveCount" Query="count(../Instance)"></Rule>
							<Setting Key1="DeviceID">
								<Rule Name="sMappedNetworkDriveNotReady" Query="$." Error="Warning" P1="$." Title="Unreachable network drive {1} may cause performance problems in Office" Text="Mapped network drive cannot be reached. This configuration may cause performance problems in Microsoft Office programs." GUID="324994" SSID="db783702-cfcb-4378-8959-059c5e020d7c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="File error,Slowness">
								</Rule>
							</Setting>
							<Setting Key1="ProviderName" NotForExport="True"></Setting>
							<Rule Name="nUnreachableDrives" Query="$nUnreachableDriveCount=0" Title="All mapped network drives are reachable at this time" Text="All mapped network drives were reachable at the time this scan was run."></Rule>
						</Object>
					</Object>
				</Object>
				<Object Type="Group" Name="Printers" Display="Right" TrackProgress="TrackProgress" Class="System Details">
					<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_Printer" Display="Hide">
						<Setting Key1="Name" Substitution="PRINTERNAME" Display="Hide" NotForExport="True"/>
						<Setting Key1="Caption" Substitution="PRINTERCAPTION" Display="Hide" NotForExport="True"/>
						<Setting Key1="Location" Substitution="PRINTERLOCATION" Display="Hide" NotForExport="True"/>
						<Setting Key1="Local" Substitution="PRINTERLOCAL" Display="Hide"/>
						<Setting Key1="Default" Substitution="PRINTERDEFAULT" Display="Hide"/>
						<Setting Key1="DeviceID" Substitution="PRINTERID" Display="Hide" NotForExport="True"/>
						<Setting Key1="Comment" Substitution="PRINTERCOMMENT" Display="Hide" NotForExport="True"/>
						<Setting Key1="DriverName" Substitution="PRINTERDRIVER" Display="Hide"/>
						<Setting Key1="ServerName" Substitution="PRINTERSERVER" Display="Hide" NotForExport="True"/>
						<Setting Key1="ShareName" Substitution="PRINTERSHARE" Display="Hide" NotForExport="True"/>
						<Setting Key1="Status" Substitution="PRINTERSTATUS" Display="Hide"/>
						<Object Type="Group" Name="%PRINTERNAME%" Display="Right">
							<Object Type="Group" Name="Caption =%PRINTERCAPTION%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Location =%PRINTERLOCATION%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Is local =%PRINTERLOCAL%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Default printer =%PRINTERDEFAULT%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Device ID =%PRINTERID%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Comment =%PRINTERCOMMENT%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Driver =%PRINTERDRIVER%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Print server =%PRINTERSERVER%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Share name =%PRINTERSHARE%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
							<Object Type="Group" Name="Status =%PRINTERSTATUS%" Display="Right">
								<Setting Display="Hide"/>
							</Object>
						</Object>
					</Object>
				</Object>
				<Object Type="Group" Name="Current Theme" Display="Right" Class="System Details">
					<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Control Panel\Appearance">
						<Setting Key1="Current">
							<Rule Name="sWinXPHCTheme" Query="contains($.,'HighContrast')" AlwaysEvaluate="True">
							</Rule>
						</Setting>
					</Object>
					<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Themes">
						<Setting Key1="CurrentTheme" NotForExport="True">
							<Rule Name="sWinHCTheme" Query="contains($.,'hc1.theme') or contains($.,'hc2.theme') or contains($.,'hcblack.theme') or contains($.,'hcwhite.theme')" AlwaysEvaluate="True">
							</Rule>
							<Rule Name="fWin7BasicTheme" Query="contains($.,'basic.theme')" AlwaysEvaluate="True"></Rule>
						</Setting>
					</Object>
					<Rule Name="sHighContrastTheme" Query="(starts-with($OSDetails_WindowsVersion,'5') and $sWinXPHCTheme=true()) or ((starts-with($OSDetails_WindowsVersion,'6') or starts-with($OSDetails_WindowsVersion,'10')) and $sWinHCTheme=true())" Error="None" Title="Windows theme is using a high-contrast setting" Text="Your current Windows theme is using one of the default high-contrast settings. In itself, this is not a problem. However, some high-contrast settings cause problems seeing shapes, drawings, menu items, or other objects in Office programs." SSID="a2017fea-3edb-405b-9a71-be6516c20739" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational">
					</Rule>
					<Rule Name="sWin7BasicThemeOL14" Query="(starts-with($OSDetails_WindowsVersion,'6') and $fWin7BasicTheme=true()) and $n2DigitVersion=14" Error="Warning" Title="Windows 7 Basic Theme enabled and you are using Outlook 2010" Text="You have the Windows 7 Basic Theme enabled and you are using Outlook 2010. In this configuration, you may experience video issues that make it appear as if items are duplicated in Outlook." GUID="310128" SSID="1990f3bb-94db-4d6f-a6d6-26adfe775675" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Display"></Rule>
				</Object>
				<!--dxDiag-->
					<Object Type="Engine" Display="Hide">
						<Setting Key1="EnvironmentVariable" Key2="WINDIR" Substitution="WINDIR" Display="Hide"/>
						<Setting Key1="EnvironmentVariable" Key2="TEMP" Substitution="TEMP" Display="Hide" NotForExport="True"/>
						<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_OperatingSystem" Display="Hide">
							<Setting Key1="Version" Substitution="WINDOWSVERSION" Display="Hide">
							</Setting>
							<!--Vista and above and Office15 and above only-->
							<Object Type="If" Key1="not(starts-with('%WINDOWSVERSION%','5.1')) and number('%MAJORVERSION%')&gt;14">
								<Object Type="Group" Name="DxDiag" TrackProgress="TrackProgress">
									<Object Type="CommandLine" Key2="%WINDIR%\system32\dxdiag" Key3="/whql:off /dontskip /x %TEMP%\dxdiag.xml">
										<Setting Key1="ReturnValue" Display="Hide"/>
										<Object Type="Group" Name="SystemInformation">
											<Object Type="XML" Name="DxDiagSysInfo" Key2="%TEMP%\dxdiag.xml" Key3="DxDiag/SystemInformation" Display="Hide">
												<Setting Key1="DirectXVersion/child::text()" Substitution="DirectXVersion" Display="Hide"/>
												<Setting Key1="UserDPISettings/child::text()" Substitution="UserDPISettings" Display="Hide"/>
												<Setting Key1="SystemDPISettings/child::text()" Substitution="SystemDPISettings" Display="Hide"/>
												<Setting Key1="DWMDPIScaling/child::text()" Substitution="DWMDPIScaling" Display="Hide"/>
												<Object Type="Group" Name="DirectXVersion =%DirectXVersion%">
													<Setting Display="Hide"/>
												</Object>
												<Object Type="Group" Name="UserDPISettings =%UserDPISettings%">
                          <Object Type="Group" Name="HIDDEN GROUP">
                            <Rule Name="sCustomDPI" Query="($appName='Outlook' or $appName='Lync' or $appName='Skype for Business') and if('%UserDPISettings%'!='Using System DPI',not(contains('%UserDPISettings%','(100') or contains('%UserDPISettings%','(125') or contains('%UserDPISettings%','(150')),not(contains('%SystemDPISettings%','(100') or contains('%SystemDPISettings%','(125') or contains('%SystemDPISettings%','(150')))" Error="Warning" P0="'%UserDPISettings%'" Title="Presence icons missing in Outlook" Text="You have a custom text size {0} configured in your Display settings. This configuration can prevent presence icons from appearing in some places in Outlook.&#xA;&#xA;Click the 'Click here ...' link for information on how to change your display setting to a value that fixes this issue." GUID="618050" SSID="921074c2-fba3-481f-b1e4-c5e884c51285" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Lync/Skype for Business integration,Presence"></Rule>
                          </Object>
												</Object>
												<Object Type="Group" Name="SystemDPISettings =%SystemDPISettings%">
													<Setting Display="Hide"/>
												</Object>
												<Object Type="Group" Name="DWMDPIScaling =%DWMDPIScaling%">
													<Setting Display="Hide"/>
												</Object>
											</Object>
										</Object>
										<Object Type="Group" Name="DxDiagNotes">
											<Object Type="XML" Name="DxDiagNotes" Key2="%TEMP%\dxdiag.xml" Key3="DxDiag/DxDiagNotes" Display="Hide">
												<Setting Key1="*"/>
											</Object>
										</Object>
										<Object Type="Group" Name="DisplayDevices">
											<Object Type="XML" Name="DxDisplayDevices" Key2="%TEMP%\dxdiag.xml" Key3="DxDiag/DisplayDevices/DisplayDevice" Display="Hide">
												<Setting Key1="MonitorModel/child::text()" Substitution="MonitorModel" Display="Hide"/>
												<Setting Key1="Manufacturer/child::text()" Substitution="Manufacturer" Display="Hide"/>
												<Setting Key1="CardName/child::text()" Substitution="CardName" Display="Hide"/>
												<Setting Key1="DisplayMemory/child::text()" Substitution="DisplayMemory" Display="Hide"/>
												<Setting Key1="DedicatedMemory/child::text()" Substitution="DedicatedMemory" Display="Hide"/>
												<Setting Key1="SharedMemory/child::text()" Substitution="SharedMemory" Display="Hide"/>
												<Setting Key1="CurrentMode/child::text()" Substitution="CurrentMode" Display="Hide"/>
												<Setting Key1="DriverVersion/child::text()" Substitution="DriverVersion" Display="Hide"/>
												<Setting Key1="DriverModel/child::text()" Substitution="DriverModel" Display="Hide"/>
												<Setting Key1="DriverDate/child::text()" Substitution="DriverDate" Display="Hide"/>
												<Setting Key1="MonitorName/child::text()" Substitution="MonitorName" Display="Hide"/>
												<Object Type="Group" Name="%MonitorName%">
													<Object Type="Group" Name="MonitorModel =%MonitorModel%">
														<Setting Display="Hide"/>
													</Object>
													<!--/child::text()-->
													<Object Type="Group" Name="Manufacturer =%Manufacturer%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="CardName =%CardName%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="DisplayMemory =%DisplayMemory%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="DedicatedMemory =%DedicatedMemory%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="SharedMemory =%SharedMemory%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="CurrentMode =%CurrentMode%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="DriverVersion =%DriverVersion%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="DriverModel =%DriverModel%">
														<Setting Display="Hide"/>
													</Object>
													<Object Type="Group" Name="DriverDate =%DriverDate%">
														<Setting Display="Hide"/>
													</Object>
												</Object>
											</Object>
										</Object>
									</Object>
								</Object>
							</Object>
						</Object>
					</Object>
				<!--/dxdiag-->
			</Object>
		</Object>
	</Type>
	<Type Name="UserDetails">
		<Object Type="If" Key1="'%APPNAME%'='Outlook'">
      <Object Type="Outlook">
        <Setting Key1="ScanType" Substitution="OLSCANTYPE" Display="Right"/>
        <Object Type="If" Key1="'%OLSCANTYPE%'!='Offline Scan'">
			<Object Type="Namespace" Task="Outlook" Display="Hide">
				<Setting Key1="currentuser" Substitution="CURRENTUSER" Display="Right" NotForExport="True"></Setting>
				<Object Type="DsGet" Key1="DcName" Key2="" Key3="" Key5="DS_DIRECTORY_SERVICE_PREFERRED" SecurityContext="ADLOGON" Display="Hide">
					<Setting Key1="DomainControllerName" Substitution="DC" Display="Hide" NotForExport="True"/>
					<Object Type="Directory" Key1="" Key2="%DC%" Key3="cn=%CURRENTUSER%" Key4="Subtree" SecurityContext="ADLOGON" Display="Hide">
						<Setting Key1="distinguishedName" Display="Right" NotForExport="True">
							<Rule Name="sSlashInUserDNTest" Query="contains($.,'/') and $n2DigitVersion=14 and $appName='Outlook' and (substring-before(substring-after(string($sFullAppVersion),concat($n2DigitVersion,'.0.')),'.')&lt;6123)" Error="Warning" Title="Your distinguished name contains a slash mark (/)" Text="When your distinguished name contains a slash mark (/) character, you cannot configure Outlook profiles by using the Account Settings wizard." GUID="267341" SSID="61e4a548-2e86-481b-a33b-5adc6c863c00" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Outlook Profile,Startup"></Rule>
						</Setting>
						<Setting Key1="mail" Display="Right" NotForExport="True"></Setting>
						<Setting Key1="mailNickName" Display="Right" NotForExport="True"></Setting>
						<Setting Key1="userPrincipalName" Display="Right" NotForExport="True"></Setting>
						<Setting Key1="proxyAddresses" Display="Right" NotForExport="True"></Setting>
						<Setting Key1="homeMDB" Display="Right" NotForExport="True"></Setting>
						<Setting Key1="legacyExchangeDN" Substitution="ORG" SubstitutionFormat="(/(?i:o)=)(.*)(/(?i:ou)=.*)----$2" Display="Right" NotForExport="True"></Setting>
						<Object Type="Group" Name="Exchange Organization =%ORG%" Display="Right">
							<Object Type="Directory" Key1="LDAP://" Key4="Base" SecurityContext="ADLOGON" Display="Right">
								<Setting Key1="configurationNamingContext" Substitution="CONFIGNAMINGCONTEXT" Display="Right" NotForExport="True"></Setting>
								<Object Type="Directory" Key1="" Key2="cn=%ORG%,CN=Microsoft Exchange,CN=Services,%CONFIGNAMINGCONTEXT%" Key4="Base" SecurityContext="ADLOGON" Display="Right">
									<Setting Key1="distinguishedName" Display="Right" NotForExport="True"></Setting>
									<Setting Key1="msExchProvisioningFlags" Display="Right">
										<Rule Name="sAppsForOfficeEnabled" Query="bitwise-and($.,512)=512 and $n2DigitVersion&gt;14" Error="Warning" Title="Apps for Outlook are disabled in your organization." Text="Your administrator has globally disabled all Apps for Outlook in your Exchange organization. Therefore, Apps for Outlook will not be displayed in Outlook or Outlook Web App (OWA)." GUID="273851" SSID="e77dcf6c-cb59-4afb-a0f5-6b8e7b491676" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Add-ins,Administration"></Rule>
									</Setting>
								</Object>
							</Object>
						</Object>
                <Setting Key1="msExchHomeServerName" Display="Right" NotForExport="True"/>
					</Object>
				</Object>
			</Object>
        </Object>
			<Object Type="GetUserNameEx" Display="Right" Timeout="60">
          <!--note: we already get NameDisplay in outlook config-->
          <Setting Key1="NameCanonical" NotForExport="True"/>
          <Setting Key1="NameCanonicalEx" NotForExport="True"/>
          <Setting Key1="NameUniqueId"/>
          <Setting Key1="NameFullyQualifiedDN" NotForExport="True"/>
        </Object>
			</Object>
		</Object>
			<Object Type="If" Key1="'%APPNAME%'!='Outlook'">
				<Object Type="GetUserNameEx" Display="Right" Timeout="60">
				<Setting Key1="NameDisplay" NotForExport="True"/>
				<Setting Key1="NameCanonical" NotForExport="True"/>
				<Setting Key1="NameCanonicalEx" NotForExport="True"/>
				<Setting Key1="NameFullyQualifiedDN" NotForExport="True"/>
				<Setting Key1="NameUniqueId"/>
				<Setting Key1="NameUserPrinciple" NotForExport="True"/>
				</Object>
			</Object>
		<Object Type="Group" Name="Cached Credentials (Windows Vista and above)" Class="User Details" GroupingClass="True" Display="Right">
			<Object Type="CommandLine" Key1="" Key2="cmdkey" Key3="/list">
				<Setting Key1="Output">
					<Rule Name="sCachedCreds" Query="$." P0="$." Error="None" Title="Cached Credentials" Text="{0}" Symptoms="Informational">
					</Rule>
				</Setting>
			</Object>
		</Object>
		<Object Type="Group" Name="User Shell Folders (registry)" Display="Right">
			<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" Display="Right">
				<Setting Key1="Desktop" Substitution="DESKTOPFOLDERPATH">
					<Rule Name="fRedirectedDesktopFolderUNC" Query="starts-with('%DESKTOPFOLDERPATH%','\\')=true()"></Rule>
				</Setting>
				<Object Type="If" Key1="substring('%DESKTOPFOLDERPATH%',2,1)=':'" Display="Hide">
					<Object Type="WMI" Key3="Win32_LogicalDisk" Key4="(DriveType=4)" Display="Hide">
						<Setting Key1="DeviceID" Display="Hide"></Setting>
						<Rule Name="fMappedNetworkDriveDesktopFolder" Query="count(../Instance[lower-case(substring(Setting[@Key1='DeviceID']/Value,0,2))=lower-case(substring('%DESKTOPFOLDERPATH%',0,2))])"></Rule>
					</Object>
				</Object>
				<Object Type="If" Key1="substring('%DESKTOPFOLDERPATH%',1,1)='%'" Display="Hide">
					<Object Type="CommandLine" Key2="cmd.exe" Key3="/c echo %DESKTOPFOLDERPATH%">
						<Setting Key1="Output" Substitution="EXPANDEDDESKTOPFOLDERPATH" Display="Hide" NotForExport="True"></Setting>
						<Object Type="WMI" Key3="Win32_LogicalDisk" Key4="(DriveType=4)" Display="Hide">
							<Setting Key1="DeviceID" Display="Hide"></Setting>
							<Rule Name="fNetworkDriveDesktopFolderFromEnvVar" Query="count(../Instance[lower-case(substring(Setting[@Key1='DeviceID']/Value,0,2))=lower-case(substring('%EXPANDEDDESKTOPFOLDERPATH%',0,2))])"></Rule>
						</Object>
					</Object>
				</Object>
				<Rule Name="sRedirectedDesktopFolderUNC" Query="$fRedirectedDesktopFolderUNC=true()" Error="None" Title="The Desktop folder is being redirected to a non-local location on the network." Text="The Desktop string value in the registry refers to a network folder. This configuration has been known to cause problems in Office programs, but only if other conditions also exist in the environment. Click the 'Tell me more ...' link for details." GUID="321703" SSID="45d0909e-9ae8-4aff-b2d3-5305534a2e01" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
				<Rule Name="sMappedNetworkDriveDesktopFolder" Query="$fMappedNetworkDriveDesktopFolder&gt;0" Error="None" Title="The Desktop folder is being redirected to a non-local location on the network." Text="The Desktop string value in the registry refers to a network folder. This configuration has been known to cause problems in Office programs, but only if other conditions also exist in the environment. Click the 'Tell me more ...' link for details." GUID="321703" SSID="dd219162-9b0e-4520-b6d2-60dad03b7c6c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
				<Rule Name="sNetworkDriveDesktopFolderFromEnvVar" Query="$fNetworkDriveDesktopFolderFromEnvVar&gt;0" Error="None" Title="The Desktop folder is being redirected to a non-local location on the network." Text="The Desktop string value in the registry refers to a network folder. This configuration has been known to cause problems in Office programs, but only if other conditions also exist in the environment. Click the 'Tell me more ...' link for details." GUID="321703" SSID="a50766b4-a8ff-40a0-a25b-856181aa81c5" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
				<Setting Key1="Personal" Substitution="PERSONALPATH">
					<Rule Name="fRedirectedDocumentFolderUNC" Query="starts-with('%PERSONALPATH%','\\')=true()"></Rule>
				</Setting>
				<Object Type="If" Key1="substring('%PERSONALPATH%',2,1)=':'" Display="Hide">
					<Object Type="WMI" Key3="Win32_LogicalDisk" Key4="(DriveType=4)" Display="Hide">
						<Setting Key1="DeviceID" Display="Hide"></Setting>
						<Rule Name="fMappedNetworkDocumentsFolder" Query="count(../Instance[lower-case(substring(Setting[@Key1='DeviceID']/Value,0,2))=lower-case(substring('%PERSONALPATH%',0,2))])"></Rule>
					</Object>
				</Object>
				<Object Type="If" Key1="substring('%PERSONALPATH%',1,1)='%'" Display="Hide">
					<Object Type="CommandLine" Key2="cmd.exe" Key3="/c echo %PERSONALPATH%">
						<Setting Key1="Output" Substitution="EXPANDEDPERSONALPATH" Display="Hide" NotForExport="True">
						</Setting>
						<Object Type="WMI" Key3="Win32_LogicalDisk" Key4="(DriveType=4)" Display="Hide">
							<Setting Key1="DeviceID" Display="Hide"></Setting>
							<Rule Name="fNetworkDriveDocumentsFolderFromEnvVar" Query="count(../Instance[lower-case(substring(Setting[@Key1='DeviceID']/Value,0,2))=lower-case(substring('%EXPANDEDPERSONALPATH%',0,2))])"></Rule>
						</Object>
					</Object>
				</Object>
				<Rule Name="sRedirectedDocumentsFolderUNC" Query="$fRedirectedDocumentFolderUNC=true()" Error="None" Title="The Documents folder is being redirected to a non-local location on the network." Text="The Personal string value in the registry refers to the location of your Documents folder and it points to a network folder. This configuration has been known to cause problems in Office programs, but only if other conditions also exist in the environment. Click the 'Tell me more ...' link for details." GUID="321703" SSID="e1ebfef1-64dc-4f1e-b5dd-06c3197e7ac4" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
				<Rule Name="sMappedNetworkDocumentsFolder" Query="$fMappedNetworkDocumentsFolder&gt;0" Error="None" Title="The Documents folder is being redirected to a non-local location on the network." Text="The Personal string value in the registry refers to the location of your Documents folder and it points to a network folder. This configuration has been known to cause problems in Office programs, but only if other conditions also exist in the environment. Click the 'Tell me more ...' link for details." GUID="321703" SSID="c949ef55-8101-4099-bc5e-3aba63ad34e9" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
				<Rule Name="sNetworkDriveDocumentsFolderFromEnvVar" Query="$fNetworkDriveDocumentsFolderFromEnvVar&gt;0" Error="None" Title="The Documents folder is being redirected to a non-local location on the network." Text="The Personal string value in the registry refers to the location of your Documents folder and it points to a network folder. This configuration has been known to cause problems in Office programs, but only if other conditions also exist in the environment. Click the 'Tell me more ...' link for details." GUID="321703" SSID="ba7e3199-c84a-4da8-bdde-3808a8eb30d8" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
			</Object>
		</Object>
		<Object Type="Engine" Display="Hide">
			<Setting Key1="EnvironmentVariable" Key2="USERPROFILE" Substitution="USERPROFILEPATH" Display="Hide">
			</Setting>
			<Object Type="Group" Name="User profile path (local) =%USERPROFILEPATH%" Display="Right">
				<Setting Key1="" Display="Hide">
				</Setting>
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList" Key5="Subtree" Display="Hide">
          <Setting Key1="ProfileImagePath" Display="Hide"></Setting>
          <Setting Key1="CentralProfile" Display="Hide"></Setting>
          <Rule Name="fRoamingProfile" Query="if(count(../Instance[Setting[@Key1='ProfileImagePath']/Value='%USERPROFILEPATH%' and Setting[@Key1='CentralProfile']/Value=true()])&gt;0,true(),false())"></Rule>
          <Rule Name="fProfileType" Query="true()" Error="None" P0="if($fRoamingProfile,'Profile type =Roaming, Network profile location: ','Profile type =Local')" P1="if($fRoamingProfile,../Instance[Setting[@Key1='ProfileImagePath']/Value='%USERPROFILEPATH%' and Setting[@Key1='CentralProfile']/Value=true()]/Setting[@Key1='CentralProfile']/Value,false())" Text="{0}{1}" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
        </Object>
			</Object>
		</Object>
	</Type>
	<!--PROBLEM_ADDINS-->
	<Type Name="CommonProbAddins">
		<!--Bluetooth: BtOfficeAddin.BtOfficeIntegration.1-->
		<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1">
			<Setting Key1="LoadBehavior"></Setting>
			<Rule Name="sBluetoothAddinLoaded" Query="../Instance/Setting[@Key1='LoadBehavior']/Value!=0" Error="Error" P0="if($OSDetails_fWinVistaInstalled,9846227,if($OSDetails_fWin7Installed or $OSDetails_fWin8Installed or $OSDetails_fWin81Installed,9846219,''))" Title="The Bluetooth add-in (BtOfficeAddin.BtOfficeIntegration.1) is enabled in the registry" Text="The Bluetooth add-in (ProgID=BtOfficeAddin.BtOfficeIntegration.1) is installed and configured to run with Office programs. This add-in has been known to cause problems with Office programs." GUID="307140" FIXIT="{0}" SSID="4e4e9588-ea6b-4dba-903f-2149313045bb" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash,Add-ins">
        <Fix ManualOnly="True">
          <Actions>
            <Action Name="SetValue" KeyName="HKLM\Software\Microsoft\Office\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1" Type="Registry" Value="0" ValueName="LoadBehavior" ValueType="REG_DWORD"></Action>
          </Actions>
        </Fix>
      </Rule>
		</Object>
		<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1">
			<Setting Key1="LoadBehavior"></Setting>
			<Rule Name="sBluetoothAddinLoadedVisio" Query="../Instance/Setting[@Key1='LoadBehavior']/Value!=0" Error="Error" Title="The Bluetooth add-in (BtOfficeAddin.BtOfficeIntegration.1) is enabled in the registry" Text="The Bluetooth add-in (ProgID=BtOfficeAddin.BtOfficeIntegration.1) is installed and configured to run with Office programs. This add-in has been known to cause problems with Office programs." GUID="307140" SSID="7a20c27c-325d-425d-bb0e-c7cd019e740e" Symptoms="Crash,Add-ins">
        <Fix ManualOnly="True">
          <Actions>
            <Action Name="SetValue" KeyName="HKLM\Software\Microsoft\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1" Type="Registry" Value="0" ValueName="LoadBehavior" ValueType="REG_DWORD"></Action>
          </Actions>
        </Fix>
      </Rule>
		</Object>
		<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Wow6432Node\Microsoft\Office\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1">
			<Setting Key1="LoadBehavior"></Setting>
			<Rule Name="sBluetoothAddinLoadedWow" Query="../Instance/Setting[@Key1='LoadBehavior']/Value!=0" Error="Error" P0="if($OSDetails_fWinVistaInstalled,9846227,if($OSDetails_fWin7Installed or $OSDetails_fWin8Installed or $OSDetails_fWin81Installed,9846219,''))" Title="The Bluetooth add-in (BtOfficeAddin.BtOfficeIntegration.1) is enabled under the \Wow6432Node key in the registry" Text="The Bluetooth add-in (ProgID=BtOfficeAddin.BtOfficeIntegration.1) is installed and configured to run with Office programs. This add-in has been known to cause problems with Office programs." GUID="307140" FIXIT="{0}" SSID="76f62932-69c2-4f92-ad3b-5cb927a2097c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash,Add-ins">
        <Fix ManualOnly="True">
          <Actions>
            <Action Name="SetValue" KeyName="HKLM\Software\Wow6432Node\Microsoft\Office\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1" Type="Registry" Value="0" ValueName="LoadBehavior" ValueType="REG_DWORD"></Action>
          </Actions>
        </Fix>
      </Rule>
		</Object>
		<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Wow6432Node\Microsoft\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1">
			<Setting Key1="LoadBehavior"></Setting>
			<Rule Name="sBluetoothAddinLoadedVisioWow" Query="../Instance/Setting[@Key1='LoadBehavior']/Value!=0" Error="Error" Title="The Bluetooth add-in (BtOfficeAddin.BtOfficeIntegration.1) is enabled under the \Wow6432Node key in the registry" Text="The Bluetooth add-in (ProgID=BtOfficeAddin.BtOfficeIntegration.1) is installed and configured to run with Office programs. This add-in has been known to cause problems with Office programs." GUID="307140" SSID="ff57c169-e5f2-4e87-9bbc-cdf5e7ad1d9a" Symptoms="Crash,Add-ins">
        <Fix ManualOnly="True">
          <Actions>
            <Action Name="SetValue" KeyName="HKLM\Software\Wow6432Node\Microsoft\%APPNAME%\Addins\BtOfficeAddin.BtOfficeIntegration.1" Type="Registry" Value="0" ValueName="LoadBehavior" ValueType="REG_DWORD"></Action>
          </Actions>
        </Fix>
      </Rule>
		</Object>
		<!--/Bluetooth-->
		<!--Btmoffice.dll or Btmofficea.dll crashes-->
		<Object Type="EventLog" Key1="Application" Key3="1000" Key4="%APPNAME%.exe" Key7="14" Key8="10000" Task="Offline scan" Display="Hide">
			<Setting Key1="FaultingModule" Display="Hide">
				<Rule Name="fFaultModuleBtmoffice" Query="contains(lower-case($.),'btmoffice')"></Rule>
			</Setting>
		</Object>
		<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\%APPNAME%\Addins\btmoffice.Connect">
			<Setting Key1="LoadBehavior"></Setting>
			<Rule Name="fBtmOfficeDll" Query="../Instance/Setting[@Key1='LoadBehavior']/Value!=0"></Rule>
			<Rule Name="sBtmOfficeDllCrash" Query="$n2DigitVersion&gt;=14 and $fBtmOfficeDll and $fFaultModuleBtmoffice&gt;0" Error="Warning" P1="concat((upper-case(substring($appName,1,1))),substring-after($appName,substring($appName,1,1)),'.exe')" Title="'Send to Bluetooth' add-in has caused one or more crashes in {1}" Text="A third-party add-in called 'Send to Bluetooth' is installed and has caused at least one crash. Please click the 'Click here to see possible solutions...' link for details on how to disable this add-in." GUID="301494" SSID="a63592ae-abc1-47fb-9454-0afafb4a27f1" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash,Add-ins"></Rule>
		</Object>
		<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Wow6432Node\Microsoft\Office\%APPNAME%\Addins\btmoffice.Connect">
			<Setting Key1="LoadBehavior"></Setting>
			<Rule Name="fBtmOfficeDllWow" Query="../Instance/Setting[@Key1='LoadBehavior']/Value!=0"></Rule>
			<Rule Name="sBtmOfficeDllCrashWow" Query="$n2DigitVersion&gt;=14 and $fBtmOfficeDllWow and $fFaultModuleBtmoffice&gt;0" Error="Warning" P1="concat((upper-case(substring($appName,1,1))),substring-after($appName,substring($appName,1,1)),'.exe')" Title="'Send to Bluetooth' add-in has caused one or more crashes in {1}" Text="A third-party add-in called 'Send to Bluetooth' is installed (registered under HKLM\Software\Wow6432Node) and has caused at least one crash in the last 14 days in {1}. Please click the 'Click here to see possible solutions...' link for details on how to disable this add-in." GUID="301494" SSID="f2b93f36-3337-48d1-8047-e477178df7db" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash,Add-ins"></Rule>
		</Object>
		<!--/Btmoffice.dll or Btmofficea.dll crashes-->
		<!--SP1 disabled add-ins re-enabled by user-->
		<Object Type="If" Key1="%MAJORVERSION%=15">
				<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\%APPNAME%\Addins" Key5="Subtree" Display="Hide">
					<Setting Key1="__KEYNAME" Substitution="PROGID" Display="Hide"></Setting>
					<Object Type="If" Key1="starts-with('%PROGID%','FineReader') or starts-with('%PROGID%','FRComAdd') or starts-with('%PROGID%','FRHEAdd') or starts-with('%PROGID%','btmoffice') or starts-with('%PROGID%','Evernote')">
						<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\%APPNAME%\Addins\%PROGID%\" Display="Right">
							<Setting Key1="OverrideDefaultDisable" Display="Right">
								<Rule Name="fOverrideDefaultDisable" Query="$.=1"></Rule>
								<Rule Name="fAddinReEnabledPostSP1" Query="$.=1 and $fLoadBehavior3!=true()" Text="This add-in was re-enabled by the user after SP1 was installed. This is OK as long as LoadBehavior is not 3."></Rule>
							</Setting>
							<Setting Key1="LoadBehavior" Display="Right">
								<Rule Name="fLoadBehavior3" Query="$.=3"></Rule>
								<Rule Name="sOverrideDefaultDisableFR" Query="$MSO_fC2R2013SP1UpdateInstalled=true() and (starts-with('%PROGID%','FineReader') or starts-with('%PROGID%','FRComAdd') or starts-with('%PROGID%','FRHEAdd')) and $fOverrideDefaultDisable and $fLoadBehavior3" Error="Warning" Title="The FineReader add-in that is known to cause crashing problems has been re-enabled" Text="You have a version of the FineReader add-in installed that has been known to crash Office 2013 programs. This version of the add-in is disabled in Office 2013 SP1, but you have re-enabled it. We recommend you disable this add-in until you install the most recent version." GUID="391442" SSID="9eb73a61-aa32-4f58-a00a-e26b7236a89c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Add-ins,Crash,Event Log"></Rule>
								<Rule Name="sOverrideDefaultDisableBT" Query="$MSO_fC2R2013SP1UpdateInstalled=true()and starts-with('%PROGID%','btmoffice') and $fOverrideDefaultDisable and $fLoadBehavior3" Error="Warning" Title="The 'Send to Bluetooth' add-in that is known to cause crashing problems has been re-enabled" Text="You have a version of the 'Send to Bluetooth' add-in installed that has been known to crash Office 2013 programs. This version of the add-in is disabled in Office 2013 SP1, but you have re-enabled it. We recommend you disable this add-in until you install the most recent version." GUID="392784" SSID="e35db263-07e9-4e5a-a6a5-d79163ac0644" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Add-ins,Crash,Event Log"></Rule>
								<Rule Name="sOverrideDefaultDisableEN" Query="$MSO_fC2R2013SP1UpdateInstalled=true() and starts-with('%PROGID%','Evernote') and $fOverrideDefaultDisable and $fLoadBehavior3" Error="Warning" Title="The Evernote.Connect add-in that is known to cause crashing problems has been re-enabled" Text="You have a version of the Evernote.Connect add-in installed that has been known to crash Office 2013 programs. This version of the add-in is disabled in Office 2013 SP1, but you have re-enabled it. We recommend you disable this add-in until you install the most recent version." GUID="392785" SSID="3c27d46d-6624-4109-accc-35693b3c8b98" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Add-ins,Crash,Event Log"></Rule>
							</Setting>
						</Object>
					</Object>
				</Object>
		</Object>
		<!--/SP1 disabled add-ins re-enabled by user-->
	</Type>
	<!--/PROBLEM_ADDINS-->
  <!--C2R Addins-->
  <Type Name="C2RAddins">
    <!--Object Type="MSI" Key1="INSTALLEDAPPLICATIONS" Key5="%APPNAME%" Display="Hide">
      <Setting Key1="Bitness" Substitution="WOW6432NODE" SubstitutionFormat="Wow6432Node" Display="Hide"></Setting-->
      <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and '%WOW6432NODE%'='Wow6432Node'">
        <Object Type="If" Key1="number('%MAJORVERSION%')=15">
          <Object Type="Group" Name="HKEY_LOCAL_MACHINE\Software\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\%WOW6432NODE%\Microsoft\Office\%APPNAME%\Addins">
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\%WOW6432NODE%\Microsoft\Office\%APPNAME%\Addins" Key5="Subtree" Display="Right">
              <Setting Key1="__KEYPATH" Substitution="KP" Display="Hide"></Setting>
              <Setting Key1="__KEYNAME" Substitution="ADDINPROGID" Display="Hide"></Setting>
              <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="%KP%" Display="Hide">
                <Setting Key1="__VALUES"></Setting>
                <Setting Key1="FriendlyName" Substitution="FRIENDLYNAME" Display="Hide"></Setting>
                <Setting Key1="LoadBehavior">
                  <Rule Name="sHKLMC2RWowLync2013AddinLoadBehavior" Query="$nInstallType='ClickToRun' and $n2DigitVersion=15 and contains('%KP%','UCAddin.LyncAddin.1') and $.=0" Error="Warning" P0="'%KP%'" P1="'%FRIENDLYNAME%'" Title="'{1}' is not configured to start (in the registry under HKLM)" Text="In the registry, LoadBehavior=0 under 'HKLM\{0}'. In this configuration, '{1}' is installed but will not start when you start Outlook. Therefore, you may be missing online meeting integration functionality with Outlook.&#xA;&#xA;Click the 'Click here ...' link for details." GUID="386400" SSID="977c33c1-8d30-4911-ae23-8d7f8eb694e2" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Lync integration,Skype for Business integration"></Rule>
                </Setting>
              </Object>
            </Object>
          </Object>
        </Object>
        <Object Type="If" Key1="number('%MAJORVERSION%')=16">
          <Object Type="Group" Name="HKEY_LOCAL_MACHINE\Software\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\%WOW6432NODE%\Microsoft\Office\%APPNAME%\Addins">
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\%WOW6432NODE%\Microsoft\Office\%APPNAME%\Addins" Key5="Subtree" Display="Right">
              <Setting Key1="__KEYPATH" Substitution="KP" Display="Hide"></Setting>
              <Setting Key1="__KEYNAME" Substitution="ADDINPROGID" Display="Hide"></Setting>
              <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="%KP%" Display="Hide">
                <Setting Key1="__VALUES"></Setting>
                <Setting Key1="FriendlyName" Substitution="FRIENDLYNAME" Display="Hide"></Setting>
                <Setting Key1="LoadBehavior">
                  <Rule Name="sHKLMC2RWowLync2016AddinLoadBehavior" Query="$nInstallType='ClickToRun' and $n2DigitVersion=16 and contains('%KP%','UCAddin.LyncAddin.1') and $.=0" Error="Warning" P0="'%KP%'" P1="'%FRIENDLYNAME%'" Title="The Skype for Business add-in is not configured to start (in the registry under HKLM)" Text="In the registry, LoadBehavior=0 under 'HKLM\{0}'. In this configuration, '{1}' is installed but will not start when you start Outlook. Therefore, you may be missing Skype for Business integration functionality with Outlook.&#xA;&#xA;Click the 'Click here ...' link for details." GUID="386400" SSID="5e58e7a4-805d-4102-bfd5-8b021f324f6c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Skype for Business integration"></Rule>
                </Setting>
              </Object>
            </Object>
          </Object>
        </Object>
      </Object>
      <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and '%WOW6432NODE%'!='Wow6432Node'">
        <Object Type="If" Key1="number('%MAJORVERSION%')=15">
          <Object Type="Group" Name="HKEY_LOCAL_MACHINE\Software\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Office\%APPNAME%\Addins">
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Office\%APPNAME%\Addins" Key5="Subtree" Display="Right">
              <Setting Key1="__KEYPATH" Substitution="KP" Display="Hide"></Setting>
              <Setting Key1="__KEYNAME" Substitution="ADDINPROGID" Display="Hide"></Setting>
              <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="%KP%" Display="Hide">
                <Setting Key1="__VALUES"></Setting>
                <Setting Key1="FriendlyName" Substitution="FRIENDLYNAME" Display="Hide"></Setting>
                <Setting Key1="LoadBehavior">
                  <Rule Name="sHKLMC2RLync2013AddinLoadBehavior" Query="$nInstallType='ClickToRun' and $n2DigitVersion=15 and contains('%KP%','UCAddin.LyncAddin.1') and $.=0" Error="Warning" P0="'%KP%'" P1="'%FRIENDLYNAME%'" Title="'{1}' is not configured to start (in the registry under HKLM)" Text="In the registry, LoadBehavior=0 under 'HKLM\{0}'. In this configuration, '{1}' is installed but will not start when you start Outlook. Therefore, you may be missing online meeting integration functionality with Outlook.&#xA;&#xA;Click the 'Click here ...' link for details." GUID="386400" SSID="3594c5fc-663f-4a57-8df5-8f429898fbcf" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Lync integration,Skype for Business integration"></Rule>
                </Setting>
              </Object>
            </Object>
          </Object>
        </Object>
        <Object Type="If" Key1="number('%MAJORVERSION%')=16">
          <Object Type="Group" Name="HKEY_LOCAL_MACHINE\Software\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Office\%APPNAME%\Addins">
            <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Office\%APPNAME%\Addins" Key5="Subtree" Display="Right">
              <Setting Key1="__KEYPATH" Substitution="KP" Display="Hide"></Setting>
              <Setting Key1="__KEYNAME" Substitution="ADDINPROGID" Display="Hide"></Setting>
              <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="%KP%" Display="Hide">
                <Setting Key1="__VALUES"></Setting>
                <Setting Key1="FriendlyName" Substitution="FRIENDLYNAME" Display="Hide"></Setting>
                <Setting Key1="LoadBehavior">
                  <Rule Name="sHKLMC2RLync2016AddinLoadBehavior" Query="$nInstallType='ClickToRun' and $n2DigitVersion=16 and contains('%KP%','UCAddin.LyncAddin.1') and $.=0" Error="Warning" P0="'%KP%'" P1="'%FRIENDLYNAME%'" Title="The Skype for Business add-in is not configured to start (in the registry under HKLM)" Text="In the registry, LoadBehavior=0 under 'HKLM\{0}'. In this configuration, '{1}' is installed but will not start when you start Outlook. Therefore, you may be missing Skype for Business integration functionality with Outlook.&#xA;&#xA;Click the 'Click here ...' link for details." GUID="386400" SSID="b9d45704-0263-4380-9395-944620e18c42" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Skype for Business integration"></Rule>
                </Setting>
              </Object>
            </Object>
          </Object>
        </Object>
      </Object>
      <!--/Object-->
  </Type>
    <!--/C2R Addins-->
  <!--SDPRules-->
	<Rule Name="SDPBluetoothAddinLoaded" Query="$sBluetoothAddinLoaded or $sBluetoothAddinLoadedWow or $sBluetoothAddinLoadedVisio or $sBluetoothAddinLoadedVisioWow" SSID="86075952-49af-4c00-9106-1220084024eb" AlwaysEvaluate="True"></Rule>
	<!--/SDPRules-->
	<!--Alerts-->
	<!-- Do NOT delete the Alerts section even after v1.2 ships with its Alerts feature. This is because some rules use CurrentMonth and CurrentYear-->
	<Type Name="Alerts">
		<Object Type="WMI" Key3="Win32_CurrentTime" Display="Hide">
			<Setting Key1="Month" Display="Hide">
				<Rule Name="CurrentMonth" Query="$."></Rule>
			</Setting>
			<Setting Key1="Year" Display="Hide">
				<Rule Name="CurrentYear" Query="$."></Rule>
			</Setting>
		</Object>
	</Type>
	<!-- Do NOT delete the Alerts section even after v1.2 ships with its Alerts feature. This is because some rules use CurrentMonth and CurrentYear-->
	<!--/Alerts-->
	
	<Type Name="OffCATVersionInfo">
		
		<!-- OffCAT version detection -->
		<Object Type="Group" Name="OffCAT program details">
			<Object Type="Engine" Display="Hide">
				<Setting Key1="ExecutionDirectory" Substitution="EXECDIR" Display="Hide"></Setting>
				<Object Type="File" Key2="%EXECDIR%\OffCAT.exe" Display="Hide">
					<Setting Key1="Version" Substitution="OFFCATVERSION" Display="Hide">
						<Rule Name="sOffCATVersion" Query="$."></Rule>
					</Setting>
					<Object Type="Group" Name="OffCAT.exe was run from %EXECDIR%" Display="Right">
						<Setting Key1="" Display="Hide"/>
						<Object Type="Group" Name="OffCAT version =%OFFCATVERSION%">
							<Setting Key1="" Display="Hide"/>
						</Object>
					</Object>
					<Object Type="Group" Name="Configuration File versions" Display="Right">
						<Object Type="XML" Key2="%EXECDIR%\En\officeupdates.config.xml" Key3="//Configuration" Display="Hide">
							<Setting Key1="@ConfigVersion" Substitution="OFFICEUPDATESCONFIGVER" Display="Hide">
								<!--Do NOT change the name of the sOfficeUpdatesConfigVersion rule as it is referenced in the binaries-->
								<Rule Name="sOfficeUpdatesConfigVersion" Query="$."></Rule>
							</Setting>
							<Object Type="Group" Name="OfficeUpdates.config.xml: %OFFICEUPDATESCONFIGVER%" Display="Right">
								<Setting Key1="" Display="Hide"></Setting>
				      </Object>
			      </Object>
						<Object Type="XML" Key2="%EXECDIR%\En\common.config.xml" Key3="//Configuration" Display="Hide">
							<Setting Key1="@ConfigVersion" Substitution="COMMONCONFIGVER" Display="Hide">
								<!--Do NOT change the name of the sCommonConfigVersion rule as it is referenced in the binaries-->
								<Rule Name="sCommonConfigVersion" Query="$."></Rule>
							</Setting>
							<Object Type="Group" Name="Common.config.xml: %COMMONCONFIGVER%" Display="Right">
								<Setting Key1="" Display="Hide"></Setting>
		          </Object>
							<Rule Name="sScannedAppConfigVersion" Query="true()" Text="{1}.config.xml: {0}" P0="//@ConfigVersion" P1="'%APPNAME%'"/>
						</Object>
					</Object>
				</Object>
			</Object>
		</Object>
		<!--/OffCAT version detection -->
	</Type>

  <!--GPResult report -->
  <Type Name="GPResult">
    <Object Type="Group" Name="Group Policy Result" Display="Hide" TrackProgress="TrackProgress">
      <Object Type="Engine">
        <Setting Key1="EnvironmentVariable" Key2="TEMP" Substitution="TMPDIR" Display="Hide">
        </Setting>
        <Object Type="CommandLine" Key2="gpresult" Key3="/H &quot;%TMPDIR%\GpResult.htm&quot; /F" Timeout="60">
          <Setting Key1="ReturnValue" Display="Hide">
          </Setting>
          <Object Type="OFFX" Key1="%TMPDIR%\GpResult.htm" Key2="GpResult" Key3="text/plain" Key4="ADD" Key5="True">
          </Object>
        </Object>
      </Object>
    </Object>
  </Type>
  <!--/GPResult report -->
  <!--Miscellaneous-->
	<Type Name="CommonMisc">
		<!--Access DB Engine 2010 x64 and Office x86-->
		<Object Type="MSI" Key1="MSIENUMCLIENTS" Key2="{2CB572DF-5B05-4392-B123-6141B5398BB1}" Display="Hide">
			<Setting Key1="ProductCode" Display="Hide"></Setting>
			<Rule Name="fAccessDBEngineX64" Query="count(../Instance/Setting[@Key1='ProductCode' and (Value='{90140000-00D1-0409-1000-0000000FF1CE}')])&gt;0"></Rule>
		</Object>
		<Object Type="MSI" Key1="MSIENUMCLIENTS" Key2="{398E906A-826B-48DD-9791-549C649CACE5}" Display="Hide">
			<Setting Key1="ProductCode" Display="Hide"></Setting>
			<Rule Name="fMsoComponentIDx86" Query="count(../Instance/Setting[@Key1='ProductCode' and (substring(Value,21,1)='0')])&gt;0"></Rule>
		</Object>
		<!--/Access DB Engine 2010 x64 and Office x86-->

    <!--ADAL registry -->
    <Object Type="Group" Name="Authentication registry" TrackProgress="TrackProgress">
      <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\Common\Identity">
        <Setting Key1="EnableADAL">
        </Setting>
        <Setting Key1="FederationProvider">
          <Rule Name="sCorruptFederationProviderValue" Query="$n2DigitVersion=15 and contains($.,'service is unavailable')" Error="Warning" Title="Error opening Office files from OneDrive for Business or SharePoint Online" Text="When you try to open Office documents that are stored on OneDrive for Business or SharePoint Online by using an Office client application, or when you sign in to the OneDrive for Business client, you receive the following error message:&#xA;&#xA;There is a problem with your account, please try again later.&#xA;&#xA;Click the 'Click here ...' link to see the steps to resolve this problem." GUID="722867" SSID="b43ed9ad-7fa6-48c8-b732-1ecd0e741d5e" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Account error,File Open error"></Rule>
        </Setting>
        <Rule Name="fAdalEnable" Query="if((../Instance/Setting/@Key1='EnableADAL')=true(),../Instance/Setting[@Key1='EnableADAL']/Value,-1)"></Rule>
      </Object>
      <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Policies\Microsoft\Office\%MAJORVERSION%.0\Common\Identity">
        <Setting Key1="EnableADAL">
        </Setting>
        <Rule Name="fAdalEnablePol" Query="if((../Instance/Setting/@Key1='EnableADAL')=true(),../Instance/Setting[@Key1='EnableADAL']/Value,-1)"></Rule>
      </Object>
    </Object>
    <!--/ADAL registry -->

    <!--AppCompat -->
		<Object Type="Group" Name="Windows Compatibility Settings" TrackProgress="TrackProgress">
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="System\CurrentControlSet\Control\Session Manager\Environment">
				<Setting Key1="__COMPAT_LAYER">
				</Setting>
				<Rule Name="fDisableThemesInCompatLayer" Query="if((../Instance/Setting/@Key1='__COMPAT_LAYER')=true(),../Instance/Setting[@Key1='__COMPAT_LAYER']/Value,-1)"></Rule>
				<Rule Name="sDisableThemesInCompatLayerNotOutlook" Query="lower-case($appName)!='outlook' and contains($fDisableThemesInCompatLayer,'DisableThemes')" Error="Warning" Title="The 'File-Open', 'File-Save As' and other commands do nothing" Text="When you click some menus/controls in an Office program, nothing happens. This has been seen with menus/controls that display a dialog box where you open or save to the file system. This includes, but is not limited to File - Open, File - Save As, Insert - Picture. This occurs because you have data in your Windows registry that prevents certain dialog boxes from working properly.&#xA;&#xA;Click the 'Click here ...' link for information on how to change this setting." GUID="523802" SSID="b135655e-2811-4ef3-af31-1a19c80498cd" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Configuration (unsupported or problematic),File Open,File Save"></Rule>
				<Rule Name="sDisableThemesInCompatLayerOutlook" Query="lower-case($appName)='outlook' and contains($fDisableThemesInCompatLayer,'DisableThemes')" Error="Warning" Title="Cannot attach files to messages or import/open pst files" Text="In Outlook, nothing happens when you click 'Attach File', or you get the error 'Not implemented' when you try to import/open pst files. This occurs because you have data in your Windows registry that prevents certain dialog boxes from working properly.&#xA;&#xA;Click the 'Click here ...' link for information on how to change this setting." GUID="523802" SSID="79e7b23c-345a-4614-ba35-c353ea0163f2" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Configuration (unsupported or problematic),Email attachments,Error message,File Open error"></Rule>        
			</Object>
		</Object>
		<!--/AppCompat -->
    <!--BROWSER-->
    <Object Type="Group" Name="Browser" Class="Miscellaneous" TrackProgress="TrackProgress">
      <Object Type="Group" Name="Default Browser">
        <Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3="http\shell\open\command" Display="Hide">
          <Setting Key1="(Default)" Substitution="BROWSER" Display="Hide">
            <Rule Name="fDefaultBrowserIE" Query="contains(lower-case($.),'iexplore.exe')"></Rule>
          </Setting>
          <Object Type="File" Key2="%BROWSER%">
            <Setting Key1="FullName" Display="Hide">
            </Setting>
          </Object>
        </Object>
        <Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3="htmlfile\shell\opennew">
          <Setting Key1="KeyExists">
            <Rule Name="fOpenNewExists" Query="$."></Rule>
          </Setting>
          <Object Type="Group" Name="Hidden">
            <Rule Name="sWin10IE11Olk1214BrowserAppPrompt" Query="lower-case($appName)='outlook' and $fOpenNewExists='False' and $OSDetails_fWin10Installed and not($fBadHtmlfileCommand) and ($n2DigitVersion=12 or $n2DigitVersion=14)" Error="Error" Title="Prompt to specify browser app when clicking hyperlinks in Outlook" Text="When you click a hyperlink in an email message you are prompted to specify the app to use to open the link. You receive this prompt even though you have already selected Internet Explorer as the app.&#xA;&#xA;This problem occurs because of missing data in the Windows registry.&#xA;&#xA;Click the 'Click here ...' link to see the solution to this problem." GUID="624328" SSID="52078d01-b3d9-4a69-948f-1e6f28055c9f" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Error message,Hyperlinks"></Rule>
          </Object>
        </Object>
      </Object>
      <Object Type="Group" Name="Internet Explorer">
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Internet Explorer" Display="Hide">
          <Setting Key1="svcVersion" Substitution="IESVCVERSION" Display="Hide">
          </Setting>
          <Setting Key1="Version" Substitution="IEVERSION" Display="Hide">
          </Setting>
          <Rule Name="nIESvcVersion" Query="if(../Instance/Setting[@Key1='svcVersion'],../Instance/Setting[@Key1='svcVersion']/Value,-1)"></Rule>
          <Rule Name="nIEVersion" Query="if(../Instance/Setting[@Key1='Version'],../Instance/Setting[@Key1='Version']/Value,-1)"></Rule>
          <Rule Name="sIEVersion" Query="if($nIESvcVersion!=-1,$nIESvcVersion,$nIEVersion)"></Rule>
          <Object Type="Group" Name="Hidden">
            <Rule Name="sInternetExplorerVersion" Query="true()" P0="$sIEVersion" Text="Version ={0}"></Rule>
          </Object>
        </Object>
      </Object>
    </Object>
    <!--BROWSER-->
		<!--Office Alerts-->
		<Object Type="If" Key1="number('%MAJORVERSION%')&gt;12">
			<Object Type="Group" Name="Microsoft Office Alerts - Common" Class="Application Event Logs" GroupingClass="True" TrackProgress="TrackProgress">
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="701910" Key5="1" Key7="14" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n80070005_701910" Query="count(../Instance/Setting[@Key1='Message' and contains(Value,'0x80070005')])" AlwaysEvaluate="True"></Rule>
					<Rule Name="s80070005NotActivated" Query="$n80070005_701910&gt;0 and $n2DigitVersion=15" Error="Warning" Title="Office Activation error 0x80070005 detected" Text="The activation error 0x80070005 was found in the Office Alerts log. This indicates your Office installation may not be activated. Please click the 'Click here ...' link for details on resolving this problem." GUID="397866" SSID="5305f17c-04c1-4f5a-b08a-e9e5dc7887d6" Symptoms="Activation,Error message,Setup"></Rule>
				</Object>
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="702040" Key5="1" Key7="7" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n80041015_702040" Query="count(../Instance/Setting[@Key1='Message' and contains(Value,'0x80041015')])" AlwaysEvaluate="True"></Rule>
					<Rule Name="s80041015May2014UpdateIssue" Query="$n80041015_702040&gt;0 and $n2DigitVersion=15" Error="Warning" Title="System error: 0x80041015 displayed launching Office 2013 programs" Text="The error 0x80041015 was found in the Office Alerts log. If you are unable to start Office 2013 programs because you receive an error message containing 'System error: 0x80041015', please click the 'Click here ...' link to get the hotfix that resolves this problem." GUID="399026" SSID="a6216304-a8c9-445a-97f9-490ec61408e2" Symptoms="Crash,Error message,Setup"></Rule>
				</Object>
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="200724" Key5="1" Key7="7" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n200724WordError" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
				</Object>
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="100796" Key5="1" Key7="7" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n100796ExcelError" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
				</Object>
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="400274" Key5="1" Key7="7" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n400274PPTError" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
				</Object>
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="201110" Key5="1" Key7="7" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n201110WordError" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
					<Setting Key1="TimeGenerated">
						<Rule Name="sDaysDiffError201110AndKB2726958Install" Query="get-days(date-difference($.,$OfficeUpdates_sKB2726958InstallDate))"></Rule>
						<Rule Name="sDaysDiffError201110AndKB2553154Install" Query="get-days(date-difference($.,$OfficeUpdates_sKB2553154InstallDate))"></Rule>
					</Setting>
				</Object>
				<Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="100191" Key5="1" Key7="7" Task="Offline scan">
					<Setting Key1="Message"></Setting>
					<Rule Name="n100191ExcelError" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
					<Setting Key1="TimeGenerated">
						<Rule Name="sDaysDiffError100191AndKB2726958Install" Query="get-days(date-difference($.,$OfficeUpdates_sKB2726958InstallDate))"></Rule>
						<Rule Name="sDaysDiffError100191AndKB2553154Install" Query="get-days(date-difference($.,$OfficeUpdates_sKB2553154InstallDate))"></Rule>
					</Setting>
				</Object>
				
				<Rule Name="sMS14_082ControlErrorXL15" Query="$n2DigitVersion=15 and $nInstallType='MSI' and lower-case($appName)='excel' and $sDaysDiffError100191AndKB2726958Install&gt;=0" Error="Warning" Title="'Cannot insert object' error found after installing the MS14-082 security update" Text="The 'Cannot insert object' error was found in the Microsoft Office Alerts log and the log entry date was on or after the date you installed the security udpate from KB 2726958. This may indicate you are experiencing the problem described in KB 3025036." GUID="522514" SSID="cacf0519-60ed-435c-b22b-773413f104ea" Symptoms="Error message"></Rule>
				<Rule Name="sMS14_082ControlErrorWD15" Query="$n2DigitVersion=15 and $nInstallType='MSI' and lower-case($appName)='word' and $sDaysDiffError201110AndKB2726958Install&gt;=0" Error="Warning" Title="'Forms' error found after installing the MS14-082 security update" Text="The 'The program used to create this object is Forms ...' error was found in the Microsoft Office Alerts log and the log entry date was on or after the date you installed the security udpate from KB 2726958. This may indicate you are experiencing the problem described in KB 3025036." GUID="522514" SSID="7090c81f-b2a4-4d7d-a12e-c662997dae44" Symptoms="Error message"></Rule>
				<Rule Name="sMS14_082ControlErrorXL14" Query="$n2DigitVersion=14 and $nInstallType='MSI' and lower-case($appName)='excel' and $sDaysDiffError100191AndKB2553154Install&gt;=0" Error="Warning" Title="'Cannot insert object' error found after installing the MS14-082 security update" Text="The 'Cannot insert object' error was found in the Microsoft Office Alerts log and the log entry date was on or after the date you installed the security udpate from KB 2553154. This may indicate you are experiencing the problem described in KB 3025036." GUID="522514" SSID="35eca51a-b94c-41ca-b595-ccccbb58ad3e" Symptoms="Error message"></Rule>
				<Rule Name="sMS14_082ControlErrorWD14" Query="$n2DigitVersion=14 and $nInstallType='MSI' and lower-case($appName)='word' and $sDaysDiffError201110AndKB2553154Install&gt;=0" Error="Warning" Title="'Forms' error found after installing the MS14-082 security update" Text="The 'The program used to create this object is Forms ...' error was found in the Microsoft Office Alerts log and the log entry date was on or after the date you installed the security udpate from KB 2553154. This may indicate you are experiencing the problem described in KB 3025036." GUID="522514" SSID="48bc739d-9175-4382-b1ab-1bc9f99c15b1" Symptoms="Error message"></Rule>
				<Rule Name="sMS14_082ControlErrorC2RXL15" Query="$n2DigitVersion=15 and $nInstallType='ClickToRun' and $C2R_Updates_sC2RDec2014VersionInstalled15 and lower-case($appName)='excel' and $n100191ExcelError&gt;0" Error="Warning" Title="'Cannot insert object' error found after installing the MS14-082 security update" Text="The 'Cannot insert object' error was found in the Microsoft Office Alerts log and the log entry date was on or after the date you installed the Office 2013 Click-to-run update for December 9, 2014. This may indicate you are experiencing the problem described in KB 3025036." GUID="522514" SSID="0b617343-b27a-46c3-b810-ed47503f7c2e" Symptoms="Error message"></Rule>
				<Rule Name="sMS14_082ControlErrorC2RWD15" Query="$n2DigitVersion=15 and $nInstallType='ClickToRun' and $C2R_Updates_sC2RDec2014VersionInstalled15 and lower-case($appName)='word' and $n201110WordError&gt;0" Error="Warning" Title="'Forms' error found after installing the MS14-082 security update" Text="The 'The program used to create this object is Forms ...' error was found in the Microsoft Office Alerts log and the log entry date was on or after the date you installed the Office 2013 Click-to-run update for December 9, 2014. This may indicate you are experiencing the problem described in KB 3025036." GUID="522514" SSID="8d8e24ff-3623-48a8-9dac-d9fcbaeb0fd8" Symptoms="Error message"></Rule>

        <Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="100109" Key5="1" Key7="7">
					<Setting Key1="Message"></Setting>
					<Rule Name="n903579Excel" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
			  </Object>
        <Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="201363" Key5="1" Key7="7">
					<Setting Key1="Message"></Setting>
					<Rule Name="n903579Word" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
		    </Object>
        <Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="400762" Key5="1" Key7="7">
					<Setting Key1="Message"></Setting>
					<Rule Name="n903579PowerPoint" Query="count(../Instance/Setting)" AlwaysEvaluate="True"></Rule>
				</Object>
        <Rule Name="s903579OfficeFileAttachmentErrors" Query="$n2DigitVersion=14 and (lower-case($appName)='outlook' or lower-case($appName)='excel' or lower-case($appName)='powerpoint' or lower-case($appName)='word') and ($n903579Excel&gt;0 or $n903579PowerPoint&gt;0 or $n903579Word&gt;0) and versioncompare($OUTLOOKVERSION_sOutlookExeVersion,'14.0.7155.5000')&gt;=0" Error="Warning" P0="$n903579Excel + $n903579PowerPoint + $n903579Word" Title="Known issue with errors opening Office file attachments detected" Text="OffCAT found {0} error(s) in the Microsoft Office Alerts log indicating you are probably encountering a known issue with Outlook 2010. This issue started to occur with the Outlook version included in the August 11, 2015 update (KB 3055012).&#xA;&#xA;Click the 'Click here ...' link for the latest information on this issue." GUID="624550" SSID="ee4ff5ea-eacd-42ce-9683-b80fad3132bc" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,Error message,File Open error"></Rule>        
			  </Object>
		</Object>
		<!--/Office Alerts-->
		<!--DCOM-->
		<Object Type="Group" Name="DCOM Settings" Class="Miscellaneous" GroupingClass="True">
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Ole">
				<Setting Key1="LegacyAuthenticationLevel"></Setting>
				<Setting Key1="LegacyImpersonationLevel"></Setting>
				<Rule Name="legacyAuthLevel" Query="if(../Instance/Setting[@Key1='LegacyAuthenticationLevel'],../Instance/Setting[@Key1='LegacyAuthenticationLevel']/Value,-1)"></Rule>
				<Rule Name="legacyImpLevel" Query="if(../Instance/Setting[@Key1='LegacyImpersonationLevel'],../Instance/Setting[@Key1='LegacyImpersonationLevel']/Value,-1)"></Rule>
				<Rule Name="sBadDCOMValues" Query="$n2DigitVersion&gt;=14 and $legacyAuthLevel&gt;2 and $legacyImpLevel&gt;2" Error="Warning" P0="if(not($OSDetails_fWindows8OrAbove),9787450,'')" Title="Machine configuration settings may prevent opening Office document attachments" Text="The DCOM settings on this computer may cause you to receive errors when you open Office documents from email attachments.&#xA;&#xA;If you are unable to open email attachments, click the 'Click here ...' link for instructions on how to reconfigure your machine settings." GUID="275607" FIXIT="{0}" SSID="b012fccc-4bf1-4de6-9fff-1d080fb46e95" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,File error">
        </Rule>
        <Rule Name="sBadDComValuesAuthLevel" Query="$n2DigitVersion&gt;=14 and $legacyAuthLevel&gt;2 and not($legacyImpLevel&gt;2)" Error="Warning" Title="Machine configuration settings may prevent opening Office document attachments" Text="The DCOM settings on this computer may cause you to receive errors when you open Office documents from email attachments.&#xA;&#xA;If you are unable to open email attachments, click the 'Click here ...' link for instructions on how to reconfigure your machine settings." GUID="275607" SSID="64439488-5780-4ae0-a6bd-446b400b1594" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,File error">
          <Fix ManualOnly="True">
            <Actions>
              <Action Name="SetValue" KeyName="HKLM\SOFTWARE\Microsoft\Ole" Type="Registry" Value="2" ValueName="LegacyAuthenticationLevel" ValueType="REG_DWORD">
              </Action>
            </Actions>
          </Fix>
        </Rule>
        <Rule Name="sBadDComValuesImpLevel" Query="$n2DigitVersion&gt;=14 and $legacyImpLevel&gt;2 and not($legacyAuthLevel&gt;2)" Error="Warning" Title="Machine configuration settings may prevent opening Office document attachments" Text="The DCOM settings on this computer may cause you to receive errors when you open Office documents from email attachments.&#xA;&#xA;If you are unable to open email attachments, click the 'Click here ...' link for instructions on how to reconfigure your machine settings." GUID="275607" SSID="6a4e3ba5-24a5-4abd-a1ac-c0bc62025009" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,File error">
          <Fix ManualOnly="True">
            <Actions>
              <Action Name="SetValue" KeyName="HKLM\SOFTWARE\Microsoft\Ole" Type="Registry" Value="2" ValueName="LegacyImpersonationLevel" ValueType="REG_DWORD">
              </Action>
            </Actions>
          </Fix>
        </Rule>
			</Object>
		</Object>
		<!--/DCOM-->
		<!--.htm registration-->
		<Object Type="Group" Name="Htmlfile registration" Class="Miscellaneous" GroupingClass="True">
			<Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3=".htm">
				<Setting Key1="(Default)">
					<Rule Name="fBadHtmregistration" Query="$.!='htmlfile'">
					</Rule>
				</Setting>
			</Object>
			<Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3=".html">
				<Setting Key1="(Default)">
					<Rule Name="fBadHtmlregistration" Query="$.!='htmlfile'">
					</Rule>
				</Setting>
			</Object>
			<Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3="htmlfile\shell\open\command">
				<Setting Key1="(Default)">
					<Rule Name="fBadHtmlfileCommand" Query="not(contains(lower-case($.),'iexplore.exe'))">
					</Rule>
          <Rule Name="sBrokenHtmRegistration" Query="$fDefaultBrowserIE and ($fBadHtmregistration or $fBadHtmlregistration or $fBadHtmlfileCommand)" Error="Warning" P0="if($OSDetails_fWin7Installed or $OSDetails_fWinVistaInstalled,9726441,if($OSDetails_fWin8Installed or $OSDetails_fWin81Installed,9824113,''))" P1="if($n2DigitVersion&lt;=14,'This operation has been cancelled due to restrictions in effect on this computer. Please contact your system administrator.','Your organizations policies are preventing us from completing this action for you. For more info, please contact your help desk.')" Title="Hyperlinks are not working in Outlook" Text="When you click a hyperlink in Microsoft Outlook, you receive one of the following error messages, depending on your Outlook version:&#xA;&#xA;'{1}'" GUID="272752" FIXIT="{0}" SSID="f7ff20da-7f31-4395-9a2e-24ea91d98160" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Hyperlinks,Error message"></Rule>
          <!--Rule Name="sBrokenHtmRegistration8" Query="($fBadHtmregistration or $fBadHtmlregistration or $fBadHtmlfileCommand) and $OSDetails_fWindows8OrAbove" Error="Warning" Title="Hyperlinks are not working in Outlook" Text="When you click a hyperlink in Microsoft Outlook, you receive one of the following error messages, depending on your Outlook version:&#xd;&#xa;&#xd;&#xa;This operation has been cancelled due to restrictions in effect on this computer. Please contact your system administrator.&#xd;&#xa;&#xd;&#xa;Your organization's policies are preventing us from completing this action for you. For more info, please contact your help desk." GUID="272752" FIXIT="" SSID="a6923beb-beb1-4780-a969-40e69aac5b8d" Symptoms="Hyperlinks,Error message"></Rule-->					
				</Setting>
			</Object>
		</Object>
		<!--/.htm registration-->
		<!--Installed .Net Framework versions-->
		<Object Type="Group" Name="Installed .Net Runtimes" Class="Miscellaneous" GroupingClass="True" TrackProgress="TrackProgress">
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Client" Display="Hide">
				<Setting Key1="Version" Substitution="V4RUNTIME" Display="Hide"></Setting>
				<Object Type="Group" Name=".Net 4.0 Client Runtime: %V4RUNTIME%">
					<Setting Key1="" Display="Hide"/>
				</Object>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full" Display="Hide">
				<Setting Key1="KeyExists" Substitution="FULLEXISTS" Display="Hide">
					<Rule Name="fFullExists" Query="$.='True'"></Rule>
				</Setting>
				<Setting Key1="Release" Display="Hide"></Setting>
				<Setting Key1="Version" Substitution="V4FULLRUNTIME" Display="Hide"></Setting>
				<Object Type="Group" Name=".Net 4.0 Full Runtime: %V4FULLRUNTIME%">
					<Setting Key1="" Display="Hide"/>
				</Object>
				<Rule Name="fReleaseExists" Query="../Instance/Setting[@Key1='Release']=true()"/>
				<Rule Name="sNetFramework45NotInstalled" Query="versioncompare($OffCATVersionInfo_sOffCATVersion,'1.9.0.0')&lt;0 and (not($fReleaseExists) or not($fFullExists)) and versioncompare($OSDetails_WindowsVersion,'6.2.0.0')&lt;0" Error="Warning" Title="System requirements for the next OffCAT version not met" Text="The next version of OffCAT requires .NET Framework 4.5 (or later) and your computer does not have this version of .NET Framework installed. To prepare your computer for the next OffCAT version, we recommend you install .NET Framework 4.5.2.&#xA;&#xA;Click the 'Click here ...' link for information on how to install .NET Framework 4.5.2" GUID="525531" SSID="3f4a161e-bdd3-46cc-878d-e1eb204264a1" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="_Alert from OffCAT"></Rule>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.5" Display="Hide">
				<Setting Key1="Version" Substitution="V35RUNTIME" Display="Hide"></Setting>
				<Setting Key1="SP" Substitution="V35SP" Display="Hide"></Setting>
				<Setting Key1="SP" Key2="Exists" Substitution="V35SPEXISTS" Display="Hide"></Setting>
				<Object Type="If" Key1="'%V35SPEXISTS%'='True'">
					<Object Type="Group" Name=".Net 3.5 Runtime: %V35RUNTIME%  Service Pack %V35SP%">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
				<Object Type="If" Key1="'%V35SPEXISTS%'='False'">
					<Object Type="Group" Name=".Net 3.5 Runtime: %V35RUNTIME%  (No Service Pack)">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\NET Framework Setup\NDP\v3.0" Display="Hide">
				<Setting Key1="Version" Substitution="V30RUNTIME" Display="Hide"></Setting>
				<Setting Key1="SP" Substitution="V30SP" Display="Hide"></Setting>
				<Setting Key1="SP" Key2="Exists" Substitution="V30SPEXISTS" Display="Hide"></Setting>
				<Object Type="If" Key1="'%V30SPEXISTS%'='True'">
					<Object Type="Group" Name=".Net 3.0 Runtime: %V30RUNTIME% Service Pack %V30SP%">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
				<Object Type="If" Key1="'%V30SPEXISTS%'='False'">
					<Object Type="Group" Name=".Net 3.0 Runtime: %V30RUNTIME% Service Pack (No Service Pack)">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727" Display="Hide">
				<Setting Key1="Version" Substitution="V20RUNTIME" Display="Hide"></Setting>
				<Setting Key1="SP" Substitution="V20SP" Display="Hide"></Setting>
				<Setting Key1="SP" Key2="Exists" Substitution="V20SPEXISTS" Display="Hide"></Setting>
				<Object Type="If" Key1="'%V20SPEXISTS%'='True'">
					<Object Type="Group" Name=".Net 2.0 Runtime: %V20RUNTIME% Service Pack %V20SP%">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
				<Object Type="If" Key1="'%V20SPEXISTS%'='False'">
					<Object Type="Group" Name=".Net 2.0 Runtime: %V20RUNTIME% Service Pack (No Service Pack)">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\NET Framework Setup\NDP\v1.1.4322" Display="Hide">
				<Setting Key1="Version" Substitution="V11RUNTIME" Display="Hide"></Setting>
				<Setting Key1="SP" Substitution="V11SP" Display="Hide"></Setting>
				<Setting Key1="SP" Key2="Exists" Substitution="V11SPEXISTS" Display="Hide"></Setting>
				<Object Type="If" Key1="'%V11SPEXISTS%'='True'">
					<Object Type="Group" Name=".Net 1.1 Runtime: %V11RUNTIME% Service Pack %V11SP%">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
				<Object Type="If" Key1="'%V11SPEXISTS%'='False'">
					<Object Type="Group" Name=".Net 1.1 Runtime: %V11RUNTIME% Service Pack (No Service Pack)">
						<Setting Key1="" Display="Hide"/>
					</Object>
				</Object>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Active Setup\Installed Components\{78705f0d-e8db-4b2d-8193-982bdda15ecd}" Display="Hide">
				<Setting Key1="Version" Substitution="V10RUNTIME" Display="Hide"></Setting>
				<Object Type="Group" Name=".Net 1.0 Runtime: %V10RUNTIME%">
					<Setting Key1="" Display="Hide"/>
				</Object>
			</Object>
		</Object>
		<!--/Installed .Net Framework versions-->
		<!--Errors detected by OffCAT RTS-->
    <!-- Removed as a part of disabling the error detection feature VSO:5493
		<Object Type="Engine">
			<Setting Key1="EnvironmentVariable" Key2="APPDATA" Substitution="APPDATAPATH" Display="Hide"></Setting>
			<Object Type="File" Key2="%APPDATAPATH%\Microsoft\OffCAT\ErrorsDetected.xml" Display="Hide">
				<Setting Key1="Exists" Substitution="ERRORSCACHEFOUND" Display="Hide"></Setting>
				<Object Type="If" Key1="%ERRORSCACHEFOUND%=1">
					<Object Type="Group" Name="Errors detected in %APPNAME% by the OffCAT service">
						<Object Type="XML" Key1="&lt;V v15='2013' v14='2010' v12='2007' v11='2003'/&gt;" Key3="V" Key4="STRING" Display="Hide">
							<Setting Key1="@v%MAJORVERSION%" Substitution="DISPLAYVERSION" Display="Hide"></Setting>
							<Object Type="XML" Key2="%APPDATAPATH%\Microsoft\OffCAT\ErrorsDetected.xml" Key3="//ErrorMatch[not(Query/SolutionSourceId=preceding-sibling::ErrorMatch/Query/SolutionSourceId and translate(ProcessName, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')=translate(preceding-sibling::ErrorMatch/ProcessName, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz') and ProcessDisplayVersion=preceding-sibling::ErrorMatch/ProcessDisplayVersion) and ProcessDisplayVersion='%DISPLAYVERSION%' and translate(ProcessName, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')=translate('%APPNAME%', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')]" Display="Hide">
								<Setting Key1="Query/SolutionSourceId/text()" Substitution="ERRSSID" Display="Hide"/>
								<Setting Key1="MatchingPattern/MatchingErrorText/text()" Substitution="ERRTXT" Display="Hide"/>
								<Setting Key1="Query/LinkId/text()" Substitution="ERRLINKID" Display="Hide"/>
								<Setting Key1="Query/KnowledgeBaseId/text()" Substitution="KBID" Display="Hide"/>
								<Setting Key1="Query/Symptoms/text()" Substitution="ERRORSYMPTOMS" Display="Hide"/>
								<Object Type="XML" Key2="%APPDATAPATH%\Microsoft\OffCAT\ErrorsDetected.xml" Key3="//ErrorMatch[Query/SolutionSourceId='%ERRSSID%' and ProcessDisplayVersion='%DISPLAYVERSION%' and translate(ProcessName, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')=translate('%APPNAME%', 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz')]">
									<Rule Name="sErrorDetected" Error="Warning" Query="count(..//Instance)&gt;0" P0="count(..//Instance)" P1="'%KBID%'" P2="'%ERRTXT%'" P3="'%APPNAME%'" Title="The error from KB article {1} fired {0} times while you were using {3}" Text="Full error text = '{2}'" GUID="%ERRLINKID%" SSID="%ERRSSID%" Symptoms="%ERRORSYMPTOMS%"/>
								</Object>
							</Object>
						</Object>
					</Object>
				</Object>
			</Object>
		</Object>-->
		<!--Installed PIAs-->
		<Object Type="Group" Name="Installed Primary Interop Assemblies">
			<Object Type="Group" Name="Office 2013">
				<Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3="Installer\Assemblies\Global">
					<Setting Key1="__VALUES" Key2="^Microsoft.Office.Interop.*15.0*"> </Setting>
				</Object>
			</Object>
			<Object Type="Group" Name="Office 2010">
				<Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3="Installer\Assemblies\Global">
					<Setting Key1="__VALUES" Key2="^Microsoft.Office.Interop.*14.0*"> </Setting>
				</Object>
			</Object>
			<Object Type="Group" Name="Office 2007">
				<Object Type="Registry" Key2="HKEY_CLASSES_ROOT" Key3="Installer\Assemblies\Global">
					<Setting Key1="__VALUES" Key2="^Microsoft.Office.Interop.*12.0*"> </Setting>
				</Object>
			</Object>
		</Object>
		<!--/Installed PIAs-->
		<!--Installed VSTO runtimes-->
		<Object Type="Group" Name="Installed VSTO Runtimes">
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\VSTO Runtime Setup" Key5="Subtree">
				<Setting Key1="__VALUES"> </Setting>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Wow6432node\Microsoft\VSTO Runtime Setup" Key5="Subtree">
				<Setting Key1="__VALUES"> </Setting>
			</Object>
		</Object>
		<!--/Installed PIAs-->
		<!--Internet 'cache' folder attributes-->
		<Object Type="Group" Name="Internet Cache folder attributes" Display="Right" TrackProgress="TrackProgress">
			<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders">
				<Setting Key1="Cache" Substitution="USERSHELLCACHE" NotForExport="True"/>
				<Object Type="CommandLine" Key2="cmd" Key3=" /c echo %USERSHELLCACHE%">
					<Setting Key1="Output" Key2="stdout" Substitution="EXPANDEDTEMPPATH" Format="(\r\n)----">
						<Rule Name="sTempIntFilesPath" Query="$."></Rule>
					</Setting>
					<Object Type="XML" Key1="&lt;s path='%EXPANDEDTEMPPATH%'/&gt;" Key3="//s" Key4="STRING" Display="Hide">
						<Setting Key1="@path" SubstitutionFormat="\\----\\" Substitution="EXPANDEDTEMPPATH2" Display="Hide" NotForExport="True"/>
						<Object Type="WMI" Key3="Win32_Directory" Key4="Name='%EXPANDEDTEMPPATH2%'" Display="Hide">
							<Setting Key1="Encrypted" Display="Hide">
							</Setting>
						</Object>
						<Rule Name="sTempIntFilesFolderEncrypted" Query="../Instance/Object/Instance/Setting[@Key1='Encrypted']/Value='True' and (lower-case($appName)='excel' or lower-case($appName)='word' or lower-case($appName)='powerpoint' or lower-case($appName)='outlook') and not($OSDetails_fWindows8OrAbove)" P0="$sTempIntFilesPath" P1="$appName" Error="Warning" Title="Files may save more slowly because the Temporary Internet Files folder is encrypted." Text="The Temporary Internet Files folder 'Path = {0}' is encrypted. This configuration may cause files from {1} to save more slowly to network folder locations." GUID="397968" SSID="0aa908d2-ad35-448e-bf5d-dc25ae4f821b" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="File Save error,Slowness"></Rule>
						<Rule Name="sINetCacheFolderEncrypted" Query="../Instance/Object/Instance/Setting[@Key1='Encrypted']/Value='True' and (lower-case($appName)='excel' or lower-case($appName)='word' or lower-case($appName)='powerpoint' or lower-case($appName)='outlook') and $OSDetails_fWindows8OrAbove" P0="$sTempIntFilesPath" P1="$appName" Error="Warning" Title="Files may save more slowly because the INetCache folder is encrypted." Text="The INetCache folder 'Path = {0}' is encrypted. This configuration may cause files from {1} to save more slowly to network folder locations." GUID="397968" SSID="87825c93-12a2-4f85-93a6-0ea5fc13665c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="File Save error,Slowness"></Rule>
					</Object>
				</Object>
			</Object>
		</Object>
    <!--/Internet 'cache' folder attributes-->
    <!--KMS Activation events-->
    <Object Type="If" Key1="'%INSTALLTYPE%'='MSI' and %MAJORVERSION%=16">
      <Object Type="Group" Name="KMS Client Activation" TrackProgress="TrackProgress">
        <Object Type="EventLog" Key1="Application" Key2="Software Protection Platform Service" Key3="12288" Key5="1" Key7="3">
          <Setting Key1="Eventid"/>
          <Setting Key1="TimeGenerated" Display="Hide" Substitution="EVENTTIME" SubstitutionFormat="(.*)( .*)----$1">
            <Rule Name="fEvent12288Date" Query="'%EVENTTIME%'"></Rule>
          </Setting>
          <Setting Key1="Message" Substitution="ERRORCODE" SubstitutionFormat="(.*\n)(0x[0-9a-fA-F]{8})(.*)----$2" Display="Hide">
            <Rule Name="fKmsClientError0xC004F042" Query="lower-case('%ERRORCODE%')='0xc004f042'"></Rule>
          </Setting>
          <Setting Key1="Message" Substitution="HOST" SubstitutionFormat="(.*\n)(0x[0-9a-fA-F]{8}, )(0x[0-9a-fA-F]{8}, )(.*)(:1688.*)----$4" Display="Hide">
            <Rule Name="fKmsHost" Query="'%HOST%'"></Rule>
          </Setting>
          <Object Type="Group" Name="KMS Host =%HOST%" Display="Right">
            <Setting Display="Hide"/>
          </Object>
        </Object>
        <Object Type="EventLog" Key1="Application" Key2="Software Protection Platform Service" Key3="8233" Key5="1" Key7="3">
          <Setting Key1="Eventid"></Setting>
          <Setting Key1="Message" Substitution="ERROR8233" Display="Hide"></Setting>
          <Object Type="Group" Name="Activation Error =%ERROR8233%" Display="Right">
            <Setting Display="Hide"/>
          </Object>
          <Setting Key1="TimeGenerated" Display="Hide" Substitution="EVENTTIME" SubstitutionFormat="(.*)( .*)----$1">
            <Rule Name="fEvent8233Date" Query="'%EVENTTIME%'"></Rule>
          </Setting>
          <Setting Key1="Message" Substitution="ERRORCODE" SubstitutionFormat="(.*\n)(0x[0-9a-fA-F]{8})(.*)----$2" Display="Hide">
            <Rule Name="fKmsClientError0xC004F074" Query="lower-case('%ERRORCODE%')='0xc004f074'"></Rule>
          </Setting>
        </Object>
        <Rule Name="sOffice16KmsActivationError0xc004f074" Query="$nInstallType='MSI' and $n2DigitVersion=16 and $fEvent12288Date=$fEvent8233Date and $fKmsClientError0xC004F042 and $fKmsClientError0xC004F074" Error="Warning" P0="$fKmsHost" Title="KMS activation error 0xC004F074 found indicating an Office Activation failure" Text="The KMS activation error 0xC004F074 was found in the Application Event log. This indicates a failure to successfully activate your Office 2016 client with the KMS host '{0}'.&#xA;&#xA;Click the 'Click here ...' link for details on the resolution for a known KMS activation issue with Office 2016 clients." GUID="691104" SSID="0b860765-cc08-4d56-bbe8-7bee315d8f66" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Activation"></Rule>
      </Object>
    </Object>
    <!--/KMS Activation events-->
		<!--MSMapiApps-->
		<Object Type="Group" Name="MSMapiApps" Class="Miscellaneous" Display="Right" GroupingClass="True">
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Microsoft\Windows Messaging Subsystem\MSMapiApps">
				<Setting Key1="__VALUES"/>
				<Setting Key1="Version">
					<Rule Name="sBadApp" Query="$." Error="Warning" Title="Incorrect registry value found under the MSMapiApps registry key" Text="A string value called 'Version' was found under the \MSMapiApps key in the registry. This configuration can cause problems when sending files from within Office programs." GUID="294945" SSID="3bcf3086-67dd-4e75-bcf5-d065079a2df6" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email send/receive,File error"></Rule>
				</Setting>
			</Object>
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Wow6432Node\Microsoft\Windows Messaging Subsystem\MSMapiApps">
				<Setting Key1="__VALUES"></Setting>
				<Setting Key1="Version">
					<Rule Name="sBadAppWow" Query="$." Error="Warning" Title="Incorrect registry value found under the MSMapiApps registry key" Text="A string value called 'Version' was found under the \MSMapiApps key in the registry. This configuration can cause problems when sending files from within Office programs." GUID="294945" SSID="52d70667-ac2e-4567-9dd9-97dcb51792bc" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email send/receive,File error"></Rule>  
				</Setting>
			</Object>
		</Object>
		<!--/MSMapiApps-->
    <!--Office Add-ins-->
    <Object Type="If" Key1="lower-case('%APPNAME%')='excel' or lower-case('%APPNAME%')='outlook' or lower-case('%APPNAME%')='powerpoint' or lower-case('%APPNAME%')='word'">
      <Object Type="Group" Name="Office Add-ins" Display="Right">
        <Object Type="Group" Name="System Requirements" Display="Right">
          <Object Type="Group" Name="Windows version" Display="Right">
            <Object Type="Group" Name="HIDDEN">
              <Rule Name="sMinWindowsVersionMet" Query="not($OSDetails_fWinVistaInstalled) and $n2DigitVersion&gt;=15" P0="$OSDetails_sWindowsName" Text="You have {0} installed and Office Add-ins require Windows 7 or later. So, you have met the system requirements for the version of Windows." SSID="dc857ac8-28d8-4f2e-a33f-f892c8636053" GUID="627253" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}"></Rule>
              <Rule Name="sMinWindowsVersionNotRelevant" Query="$n2DigitVersion&lt;15" P0="$n4DigitSKUVersion" Text="You have Office version {0} installed and Office Add-ins are only available in Office 2013 or later. So, the version of Windows is not relevant."></Rule>
              <Rule Name="sMinWindowsVersionNotMet" Query="$OSDetails_fWinVistaInstalled and $n2DigitVersion&gt;=15" Error="Warning" P0="$OSDetails_sWindowsName" Title="The minimum required version of Windows is Not installed" Text="You have {0} installed and Office Add-ins require Windows 7 or later. So, you have not met the system requirements for the version of Windows needed to use Office Add-ins." SSID="2d6c31d3-6ef2-42f3-9e45-87773bed9762" GUID="627252" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Apps for Office,Office Add-ins"></Rule>
            </Object>
          </Object>
          <Object Type="Group" Name="Office version" Display="Right">
            <Object Type="Group" Name="HIDDEN">
              <Rule Name="sMinOfficeVersionMet" Query="$n2DigitVersion&gt;=15" P0="$n4DigitSKUVersion" Text="You have Office version {0} installed and Office Add-ins require Office 2013 or later. So, you have met the system requirements for the version of Office." SSID="1ede69e9-a80d-4d8c-a792-7dd8ea7125bc" GUID="627246" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}"></Rule>
              <Rule Name="sMinOfficeVersionNotMet" Query="$n2DigitVersion&lt;15" Error="Warning" P0="$n4DigitSKUVersion" Title="The minimum required version of Office is Not installed" Text="You have Office version {0} installed and Office Add-ins require Office 2013 or later. So, you have not met the system requirements for the version of Office needed to use Office Add-ins." SSID="cb3d82fa-0ade-4d47-b8c3-ef948a0a5d48" GUID="627247" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Apps for Office,Office Add-ins"></Rule>
            </Object>
          </Object>
          <Object Type="Group" Name="Internet Explorer version" Display="Right">
            <Object Type="Group" Name="HIDDEN">
              <Rule Name="sMinIEVersionMet" Query="versioncompare($sIEVersion,'9.0.0.0')&gt;=0" P0="$sIEVersion" Text="You have Internet Explorer version {0} installed and Office Add-ins require Internet Explorer 9 or later. So, you have met the system requirements for the version of Internet Explorer." SSID="98b57ff8-81d0-4078-8e28-5d377b290540" GUID="627245" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}"></Rule>
              <Rule Name="sMinIEVersionNotMet" Query="versioncompare($sIEVersion,'9.0.0.0')&lt;0" Error="Warning" P0="$sIEVersion" Title="The minimum required version of Internet Explorer is Not installed" Text="You have Internet Explorer version {0} installed and Office Add-ins require Internet Explorer 9 or later. So, you have not met the system requirements for the version of Internet Explorer needed to use Office Add-ins." SSID="3af2ef5e-647f-4fdf-a8b7-162121468a7b" GUID="627244" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Apps for Office,Office Add-ins"></Rule>
            </Object>
          </Object>
        </Object>
        <Object Type="Group" Name="HKCU\SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef" Display="Right">
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef\PreinstalledApps" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef\PreinstalledApps" Key5="Subtree" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>

          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef\Providers" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef\Providers" Key5="Subtree" Display="Right">
            <Setting Key1="__VALUES"></Setting>
            <Setting Key1="UniqueId"></Setting>
            <Rule Name="nAdalProvider" Query="count(../Instance/Setting[@Key1='UniqueId' and contains(lower-case(Value),'_adal')])"></Rule>
            <Rule Name="nAnonymousProvider" Query="count(../Instance/Setting[@Key1='UniqueId' and contains(lower-case(Value),'anonymous')])"></Rule>
            <Rule Name="sOfficeAddinProviderCorruption" Query="$n2DigitVersion&gt;=15 and $nAdalProvider&gt;0 and $nAnonymousProvider&gt;0 and $nP3_0x80070057Count&gt;0" Error="Warning" Title="Office Add-ins may not activate due to conflicting settings in the registry" Text="There are conflicting settings in the registry that might prevent Office add-ins from activating correctly.&#xA;&#xA;If you are experiencing problems activating Office add-ins, please click the 'Click here ...' link for details on resolving this problem." GUID="715565" SSID="2d833e54-03cb-4e54-93d2-cd26ddb77d9d" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Office Add-ins"></Rule>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef\TrustedCatalogs" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\Wef\TrustedCatalogs" Key5="Subtree" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
        </Object>
        <Object Type="Group" Name="HKCU\SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\%APPNAME%\Web Extension User MRU" Display="Right">
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\%APPNAME%\Web Extension User MRU" Display="Right">
            <Setting Key1="__VALUES">
            </Setting>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Microsoft\Office\%MAJORVERSION%.0\%APPNAME%\Web Extension User MRU" Key5="Subtree" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
        </Object>
        <Object Type="Group" Name="HKCU\SOFTWARE\Policies\Microsoft\Office\%MAJORVERSION%.0\Wef" Display="Right">
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Policies\Microsoft\Office\%MAJORVERSION%.0\Wef" Display="Right">
            <Setting Key1="__VALUES">
            </Setting>
          </Object>
          <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="SOFTWARE\Policies\Microsoft\Office\%MAJORVERSION%.0\Wef" Key5="Subtree" Display="Right">
            <Setting Key1="__VALUES"></Setting>
          </Object>
        </Object>
        <Object Type="Group" Name="Protected Mode Registry Data" Display="Right">
          <Object Type="Group" Name="Local Intranet Zone" Display="Right">
            <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1" Display="Right">
              <Setting Key1="2500">
                <Rule Name="sProtectedModeSettingLocalIntranet" Query="$." P0="if($.=0,'Enabled','Not Enabled')" Text="Protected mode is {0} for this zone."></Rule>
              </Setting>
            </Object>
          </Object>
          <Object Type="Group" Name="Trusted Sites Zone" Display="Right">
            <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\2" Display="Right">
              <Setting Key1="2500">
                <Rule Name="sProtectedModeSettingTrustedSites" Query="$." P0="if($.=0,'Enabled','Not Enabled')" Text="Protected mode is {0} for this zone."></Rule>
              </Setting>
            </Object>
          </Object>
          <Object Type="Group" Name="Internet Zone" Display="Right">
            <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3" Display="Right">
              <Setting Key1="2500">
                <Rule Name="sProtectedModeSettingInternet" Query="$." P0="if($.=0,'Enabled','Not Enabled')" Text="Protected mode is {0} for this zone."></Rule>
              </Setting>
            </Object>
          </Object>
          <Object Type="Group" Name="Restricted Sites Zone" Display="Right">
            <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\4" Display="Right">
              <Setting Key1="2500">
                <Rule Name="sProtectedModeSettingRestrictedSites" Query="$." P0="if($.=0,'Enabled','Not Enabled')" Text="Protected mode is {0} for this zone."></Rule>
              </Setting>
            </Object>
          </Object>
        </Object>
        <Object Type="Group" Name="Microsoft Office Alerts log entries (past 7 days)" Display="Right">
          <Object Type="EventLog" Key1="OAlerts" Key2="" Key3="300" Key4="Apps for Office" Key5="15" Key7="7">
            <Setting Key1="Message" Display="Right">
              <Rule Name="sAppsForOfficeError" Query="(($nInstallType='MSI' and not($OfficeUpdates_sKB2986156Installed)) or ($nInstallType='ClickToRun' and versioncompare($C2R_Updates_fInstalledC2RVersion15,'15.0.4719.1002')&lt;0)) and $nOfficeAppsAlertCount&gt;0 and $n2DigitVersion=15 and ($appName='Outlook' or $appName='Word' or $appName='PowerPoint' or $appName='Excel')" Error="Warning" Title="Error starting an 'App for Office' detected" Text="At least one error was found in the Microsoft Office Alerts log (in the Event Viewer) indicating there was a problem starting an 'App for Office'. Please click the 'Click here ...' link for details on resolving this problem." GUID="468521" SSID="9233a78c-ee12-435e-8162-21a3b7b9965e" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Error message"></Rule>
            </Setting>
            <Rule Name="nOfficeAppsAlertCount" Query="count(../Instance/Setting[@Key1='Message' and contains(Value,'could not be started')])&gt;0"></Rule>
            <Rule Name="nP3_0x80070057Count" Query="count(../Instance/Setting[@Key1='Message' and contains(Value,'0x80070057') and contains(Value,'start this app because it') and contains(Value,'set up properly')])"></Rule>
          </Object>
        </Object>      
      </Object>
    </Object>
    <!--/Office Add-ins-->
    <!--Office Previewers -->
    <Object Type="Group" Name="Office Previewers">
      <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and %MAJORVERSION%=15">
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\PreviewHandlers" Display="Right">
          <Setting Key1="__VALUES">
          </Setting>
        </Object>
      </Object>
      <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and %MAJORVERSION%=16">
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\PreviewHandlers" Display="Right">
          <Setting Key1="__VALUES">
          </Setting>
          <Setting Key1="{00020827-0000-0000-C000-000000000046}" Key2="Type"></Setting>
          <Rule Name="sExcelPreviewerWrongTypeC2R" Query="(lower-case($appName)='excel' or lower-case($appName)='outlook') and lower-case(../Instance/Setting[@Key1='{00020827-0000-0000-C000-000000000046}' and @Key2='Type']/Value)!='reg_sz'" Error="Warning" Title="Excel attachments cannot be previewed in Outlook" Text="When you attempt to preview an Excel file attachment in Outlook you get an error stating 'This file cannot be previewed because there is no previewer installed for it'. This problem is caused by incorrect data in the following registry key.&#xA;&#xA;HKLM\SOFTWARE\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\PreviewHandlers&#xA;&#xA;Click the 'Click here ...' link for steps to resolve this problem." GUID="627303" SSID="6b44efad-94f5-4372-b151-ed461ed77f3e" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,Excel Previewer">
            <Fix ManualOnly="True">
              <Actions>
                <Action Name="SetValue" KeyName="HKLM\SOFTWARE\Microsoft\Office\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\PreviewHandlers" Type="Registry" Value="Microsoft Excel previewer" ValueName="{00020827-0000-0000-C000-000000000046}" ValueType="REG_SZ"></Action>
              </Actions>
            </Fix>
          </Rule>
        </Object>
      </Object>
      <Object Type="If" Key1="'%INSTALLTYPE%'='MSI' and '%WOW6432NODE%'='Wow6432Node'">
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\PreviewHandlers" Display="Right">
          <Setting Key1="__VALUES">
          </Setting>
          <Setting Key1="{00020827-0000-0000-C000-000000000046}" Key2="Type"></Setting>
          <Rule Name="sExcelPreviewerWrongTypeMsiWow" Query="(lower-case($appName)='excel' or lower-case($appName)='outlook') and $n2DigitVersion=16 and lower-case(../Instance/Setting[@Key1='{00020827-0000-0000-C000-000000000046}' and @Key2='Type']/Value)!='reg_sz'" Error="Warning" Title="Excel attachments cannot be previewed in Outlook" Text="When you attempt to preview an Excel file attachment in Outlook you get an error stating 'This file cannot be previewed because there is no previewer installed for it'. This problem is caused by incorrect data in the following registry key.&#xA;&#xA;HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\PreviewHandlers&#xA;&#xA;Click the 'Click here ...' link for steps to resolve this problem." GUID="627303" SSID="0e7228d5-a163-40c3-9649-8a1477d328ce" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,Excel Previewer"></Rule>
        </Object>
      </Object>
      <Object Type="If" Key1="'%INSTALLTYPE%'='MSI' and '%WOW6432NODE%'=''">
        <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Windows\CurrentVersion\PreviewHandlers" Display="Right">
          <Setting Key1="__VALUES">
          </Setting>
          <Setting Key1="{00020827-0000-0000-C000-000000000046}" Key2="Type"></Setting>
          <Rule Name="sExcelPreviewerWrongTypeMsi" Query="(lower-case($appName)='excel' or lower-case($appName)='outlook') and $n2DigitVersion=16 and lower-case(../Instance/Setting[@Key1='{00020827-0000-0000-C000-000000000046}' and @Key2='Type']/Value)!='reg_sz'" Error="Warning" Title="Excel attachments cannot be previewed in Outlook" Text="When you attempt to preview an Excel file attachment in Outlook you get an error stating 'This file cannot be previewed because there is no previewer installed for it'. This problem is caused by incorrect data in the following registry key.&#xA;&#xA;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\PreviewHandlers&#xA;&#xA;Click the 'Click here ...' link for steps to resolve this problem." GUID="627303" SSID="9ebad402-d21b-4fd4-887e-2b7f827f5df5" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,Excel Previewer"></Rule>
        </Object>
      </Object>
    </Object>
    <!--/AppCompat -->
    <!--TCOTrace logging -->
    <Object Type="Group" Name="Office TCOTrace logging" Class="Miscellaneous">
      <Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\%MAJORVERSION%.0\Common\Debug">
        <Setting Key1="TCOTrace">
          <Rule Name="sTcoTraceLoggingEnabled" Query="$.=1" Error="Error" Title="'TCO' logging is enabled which may slow Office programs" Text="You have 'TCO' logging enabled. This logging is used to troubleshoot various issues such as errors with Office subscription, sign-in, installation or activation. This logging can consume a lot of drive space, so it should only be enabled while you are troubleshooting a specific issue.&#xA;&#xA;Click the 'Click here ...' link for information on how to turn off this logging." GUID="618031" SSID="61d6ff03-125b-4adb-ac48-b0071b1dfcaa" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Slowness"></Rule>
        </Setting>
      </Object>
    </Object>
    <!--/TCOTrace logging -->
		<!--Telemetry-->
		<Object Type="Group" Name="Office Telemetry" Class="Miscellaneous" GroupingClass="True">
			<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\Common\ClientTelemetry">
				<Setting Key1="__VALUES" Display="Right">
				</Setting>
			</Object>
			<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\Office\Common\ClientTelemetry" Key5="Subtree">
				<Setting Key1="__VALUES">
				</Setting>
			</Object>
		</Object>
		<!--/Telemetry-->
		<!--VBA-->
		<Object Type="Group" Name="VBA" Class="Miscellaneous">
			<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="Software\Microsoft\VBA" Key5="Subtree">
				<Setting Key1="__KEYPATH" Substitution="KP" Display="Hide">
				</Setting>
        <Rule Name="sMissingVBAKey" Query="$n2DigitVersion=14 and (../Instance/Setting[@Key1='__KEYPATH']/Value='Software\Microsoft\VBA\7.0\Common')=false()" Error="Warning" P0="if($OSDetails_fWin7Installed or $OSDetails_fWinVistaInstalled,9705423,if($OSDetails_fWin8Installed or $OSDetails_fWin81Installed,9833184,''))" Title="Registry data for Visual Basic for Applications is missing" Text="The registry is missing data for Visual Basic for Applications (VBA) in Office 2010. In this configuration, you may have some VBA functionality disabled." GUID="275594" FIXIT="{0}" SSID="8a895188-6d23-4606-b640-e82405649f13" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="VBA"></Rule>
        <!--Rule Name="sMissingVBAKeyWin8" Query="$OSDetails_fWindows8OrAbove and $n2DigitVersion=14 and (../Instance/Setting[@Key1='__KEYPATH']/Value='Software\Microsoft\VBA\7.0\Common')=false()" Error="Warning" Title="Registry data for Visual Basic for Applications is missing" Text="The registry is missing data for Visual Basic for Applications (VBA) in Office 2010. In this configuration, you may have some VBA functionality disabled." GUID="275594" FIXIT="9833184" SSID="fa51c5b8-c622-4b08-bc9e-20a18461fa7d" Symptoms="VBA"></Rule-->
        <!--Rule Name="sMissingVBAKey" Query="$n2DigitVersion=14 and (../Instance/Setting[@Key1='__KEYPATH']/Value='Software\Microsoft\VBA\7.0\Common')=false()" Error="Warning" Title="Registry data for Visual Basic for Applications is missing" Text="The registry is missing data for Visual Basic for Applications (VBA) in Office 2010. In this configuration, you may have some VBA functionality disabled." GUID="275594" FIXIT="" SSID="8a895188-6d23-4606-b640-e82405649f13" Symptoms="VBA"></Rule-->
				<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="%KP%" Display="Hide">
					<Setting Key1="__VALUES">
					</Setting>
				</Object>
			</Object>
			<Object Type="If" Key1="'%APPNAME%'!='OneNote' and '%APPNAME%'!='InfoPath' and '%INSTALLTYPE%'='ClickToRun' and '%MAJORVERSION%'='15'">
				<Object Type="Group" Name="VBA C2R Registration" Class="Miscellaneous" GroupingClass="True">
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\832C86ABC73443044BA758069DBCC6E5">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fA32" Query="../Instance/Setting[@Key1='00005109F00000000000000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\374F999555861D6408391B4C361BEDB9">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fA64" Query="../Instance/Setting[@Key1='00005109F00000000100000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\206169712E4CE28408A0FDE6265794FC">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fB32" Query="../Instance/Setting[@Key1='00005109F00000000000000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\A022E749FB2D09D489BC901493B9A972">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fB64" Query="../Instance/Setting[@Key1='00005109F00000000100000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\VBA">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fC" Query="../Instance/Setting[@Key1='Vbe71DllPath']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Wow6432Node\Microsoft\VBA">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fCWow" Query="../Instance/Setting[@Key1='Vbe71DllPath']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\5F9CFE2AA8001EC439EF3B3F2E6582EB">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fD32" Query="../Instance/Setting[@Key1='00005109E60090400000000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\720D1882E7287B24F96A8FEEA8AECC1E">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fD64" Query="../Instance/Setting[@Key1='00005109E60090400100000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\E570C73B47CA10F4593D3AC0C0CC62B6">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fE32" Query="../Instance/Setting[@Key1='00005109E60090400000000000F01FEC']=false()"></Rule>
					</Object>
					<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Office\15.0\ClickToRun\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData\S-1-5-18\Components\D03CD579506ADFB47AA7ABC2BBC17ACA">
						<Setting Key1="__VALUES">
						</Setting>
						<Rule Name="fE64" Query="../Instance/Setting[@Key1='00005109E60090400100000000F01FEC']=false()"></Rule>
					</Object>
					<Rule Name="sBadVBARegC2RWow" Query="($fA32 or $fB32 or $fCWow or $fD32 or $fE32) and $bitness!=$OSDetails_OSArchitecture" Error="Error" Title="Office 2013 configuration prevents VBA from running" Text="There is incorrect/missing registry data that is preventing VBA from running. Please click the 'Click here to see possible solutions to this issue' link for information on how to correct this issue." GUID="299203" SSID="498334fc-1b35-4e91-9ee8-9cfe3867592c" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="VBA"></Rule>
					<Rule Name="sBadVBARegC2R32" Query="($fA32 or $fB32 or $fC or $fD32 or $fE32) and $bitness='x86' and $bitness=$OSDetails_OSArchitecture" Error="Error" Title="Office 2013 configuration prevents VBA from running" Text="There is incorrect/missing registry data that is preventing VBA from running. Please click the 'Click here to see possible solutions to this issue' link for information on how to correct this issue." GUID="299203" SSID="a14e8cfb-db97-441e-a35f-97cc32777d3e" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="VBA"></Rule>
					<Rule Name="sBadVBARegC2R64" Query="($fA64 or $fB64 or $fC or $fD64 or $fE64) and $bitness='x64'" Error="Error" Title="Office 2013 configuration prevents VBA from running" Text="There is incorrect/missing registry data that is preventing VBA from running. Please click the 'Click here to see possible solutions to this issue' link for information on how to correct this issue." GUID="299203" SSID="a084e0ac-e331-4f9f-8412-275b3a366b2d" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="VBA"></Rule>
				</Object>
			</Object>
		</Object>
		<!--/VBA-->
		<!--Web Service-->
		<Object Type="Group" Name="WebClient Service Status" Class="WebClient Service" Display="Right" TrackProgress="TrackProgress">
			<Object Type="GetComputerNameEx" Display="Hide">
				<Setting Key1="ComputerNameNetBIOS" Substitution="MACHINENAME" Display="Hide"/>
				<Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_Service" Key4="Name='WebClient'" Display="Hide">
					<Setting Key1="Started">
						<Rule Name="fWebClientStopped" Query="$.='False'"></Rule>
						<Rule Name="sWebClientStoppedOrDisabled" Query="($fWebClientStopped or $fWebClientDisabled) and ($n2DigitVersion=12 or $n2DigitVersion=14) and (lower-case($appName)='excel' or lower-case($appName)='onenote' or lower-case($appName)='powerpoint' or lower-case($appName)='publisher' or lower-case($appName)='visio' or lower-case($appName)='word')" Error="None" Title="The WebClient service is not running" Text="The WebClient service is not running and this will cause problems opening or saving Office documents from a SharePoint site. Please start the WebClient service using the Services.msc snap-in." GUID="276852" SSID="07e737ad-dba3-4ef3-a1d5-228bd882f319" Symptoms="File error"></Rule>
					</Setting>
					<Setting Key1="StartMode">
						<Rule Name="fWebClientDisabled" Query="$.='Disabled'"></Rule>
					</Setting>
					<Rule Name="fWindows2008OrAbove" Query="$OSDetails_fOSServer and starts-with($OSDetails_WindowsVersion,'6')"></Rule>
					<Rule Name="fWebClientInstalled" Query="../Instance=true()"></Rule>
					<Rule Name="sWebClientStoppedOrDisabledOnServer" Query="$fWindows2008OrAbove and ($fWebClientStopped or $fWebClientDisabled or not($fWebClientInstalled)) and ($n2DigitVersion=12 or $n2DigitVersion=14) and (lower-case($appName)='excel' or lower-case($appName)='onenote' or lower-case($appName)='powerpoint' or lower-case($appName)='publisher' or lower-case($appName)='visio' or lower-case($appName)='word')" Error="None" Title="The WebClient service is not running on Windows Server" Text="The WebClient service is not running on Windows Server and this will cause problems opening or saving Office documents from a SharePoint site. Please start the WebClient service. If the WebClient service is not available, you will have to install the Desktop Experience first." GUID="276852" SSID="170cd8fb-1c67-46f2-9050-f39229effdb1" AlwaysEvaluate="True" Symptoms="File error"></Rule>
				</Object>
			</Object>
		</Object>
		<!--Web Service-->
		<!--Windows Installer-->
		<Object Type="Group" Name="Windows Installer Policy">
			<Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Policies\Microsoft\Windows\Installer">
				<Setting Key1="__VALUES">
				</Setting>
				<Setting Key1="Logging">
          <Rule Name="sMSILogging" Query="contains($.,'voicewarmup')" Error="Warning" Title="Possible slowness issues because Windows Installer logging is enabled" Text="Verbose logging for the Windows Installer is enabled in the registry. As this logging can generate many log files and disk space, it is recommended that you use this logging only for troubleshooting purposes. Please consider turning off this logging.&#xA;&#xA;Click the 'Click here ...' link for instructions or click the 'Fix it' link for an automated solution." GUID="526151" FIXIT="9723031" SSID="9516c6d1-3c32-4227-984c-6372e94be929" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Slowness">
            <Fix ManualOnly="True">
              <Actions>
                <Action Name="SetValue" KeyName="HKLM\Software\Policies\Microsoft\Windows\Installer" Type="Registry" Value="&quot;&quot;" ValueName="Logging" ValueType="REG_SZ">
                </Action>
              </Actions>
            </Fix>
          </Rule>
          <!--Rule Name="sMSILoggingWin8" Query="$OSDetails_fWindows8OrAbove and contains($.,'voicewarmup')" Error="Warning" Title="Possible slowness issues because Windows Installer logging is enabled" Text="Verbose logging for the Windows Installer is enabled in the registry. As this logging can generate many log files and disk space, it is recommended that you use this logging only for troubleshooting purposes. Please consider turning off this logging.&#xD;&#xA;&#xD;&#xA;Click the 'Click here ...' link for instructions. Note, the 'Fix it' solution in the article does not apply to Windows 8 (or later)." GUID="526151" SSID="cf7007a6-46aa-486a-8d13-726c8ad24b87" Symptoms="Slowness"></Rule-->
          <!--Rule Name="sMSILoggingXP" Query="starts-with($MachineDetails_WindowsVersion,'5') and contains($.,'voicewarmup')" Error="Warning" Title="Windows Installer logging is enabled in the registry" Text="Verbose logging for the Windows Installer is enabled in the registry. As this logging can generate many log files and disk space, it is recommended that you use this logging only for troubleshooting purposes. Please consider turning off this logging." GUID="275096" FIXIT="9711326" SSID="9487402d-09a5-4c67-9099-d98bc18a224d" Symptoms="Slowness">
					</Rule>
					<Rule Name="sMSILogging" Query="number(substring($MachineDetails_WindowsVersion,1,1))&gt;5 and contains($.,'voicewarmup')" Error="Warning" Title="Windows Installer logging is enabled in the registry" Text="Verbose logging for the Windows Installer is enabled in the registry. As this logging can generate many log files and disk space, it is recommended that you use this logging only for troubleshooting purposes. Please consider turning off this logging." GUID="128265" FIXIT="" SSID="9516c6d1-3c32-4227-984c-6372e94be929" Symptoms="Slowness">
					</Rule-->
				</Setting>
			</Object>
		</Object>
		<!--/Windows Installer-->
	</Type>
  <!--/Miscellaneous-->
	<Type Name="DisplayLinkUMD">
		<Object Type="Engine">
			<Setting Key1="EnvironmentVariable" Key2="WINDIR" Substitution="WINDIR" Display="Hide">
			</Setting>
			<Object Type="File" Key2="%WINDIR%\System32\dlumd32.dll" Display="Right">
				<Setting Key1="Version" Display="Right">
				</Setting>
			</Object>
			<Object Type="File" Key2="%WINDIR%\SysWOW64\dlumd32.dll" Display="Right">
				<Setting Key1="Version" Display="Right">
				</Setting>
			</Object>
			<Rule Name="dlumd32Version" Query="if(../Instance/Object/Instance/Setting[@Key1='Version'],../Instance/Object/Instance/Setting[@Key1='Version']/Value,'0')"></Rule>
			<Rule Name="sDlumd32OldVersionCrash" Query="$nCrashCount&gt;0 and $n2DigitVersion&gt;=15 and number($dlumd32Version)!=0 and substring($dlumd32Version,2,1)='.' and versioncompare(number(substring($dlumd32Version,1,3)),8.7)&lt;0" Error="Error" P0="$appName" P1="$dlumd32Version" P2="$nCrashCount" Title="{0} may be crashing due to an outdated DisplayLink driver" Text="{0} has crashed {2} times in the past 7 days and the DisplayLink user mode driver version ({1}) on your machine has been known to cause Office programs to crash. Please install the 7.1 M1 update (or later version) for the DisplayLink driver." GUID="280404" SSID="be9a15de-23a5-4464-9497-2a278f0d0d05" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash"></Rule>
      <Object Type="File" Key2="%PROGRAMFILES%\DisplayLink Core Software\DisplayLinkManager.exe" Display="Right">
        <Setting Key1="Version" Display="Right">
          <Rule Name="sDisplayLinkProtectedModeIssue" Query="versioncompare($.,'7.9.630.0')&lt;=0 and $n2DigitVersion&gt;=14 and $OSDetails_fWin10Installed and not($MachineDetails_sDisableHardwareAcceleration)" Error="Error" Title="Office applications may be crashing due to an outdated DisplayLink driver" Text="Office applications may be crashing when opening files from Outlook in Protected View on Windows 10. The DisplayLink driver on your computer has been known to cause this problem. Please install the 7.9 M4 update (or later version) for the DisplayLink driver &#xA;&#xA;Click the 'Click here ...' link for a solution." GUID="722882" SSID="b650495b-07fd-4c07-9b94-a92dd4f2a2a0" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash (with a fix)"></Rule>
				</Setting>
			</Object>
		</Object>
	</Type>
	<Type Name="MSMAPI32">
		<Object Type="Registry" Key2="HKEY_CURRENT_USER" Key3="software\microsoft\office\%MAJORVERSION%.0\Common\LanguageResources" Display="Hide">
			<Setting Key1="UILanguage" Substitution="UILANGUAGECODE" Display="Hide">
			</Setting>
			<Object Type="If" Key1="'%WOW6432NODE%'='Wow6432Node'">
				<Object Type="Engine">
					<Setting Key1="EnvironmentVariable" Key2="COMMONPROGRAMFILES(X86)" Substitution="COMMONPROGRAMFILESX86" Display="Hide"/>
					<Object Type="File" Key2="%COMMONPROGRAMFILESX86%\System\MSMAPI\%UILANGUAGECODE%\MSMapi32.dll" Display="Right">
						<Setting Key1="Version" Display="Right">
						<Rule Name="sMisMatchedMsmapi32VersionWordWow" Query="lower-case($appName)='word' and $n2DigitVersion&lt;15 and $CommonMisc_n200724WordError&gt;0 and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send Word document through email" Text="At least one error attempting to send a Word document through email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="3361a57e-f323-4005-8ebd-a4845fc12fc3" Symptoms="Error message,Email send/receive"></Rule>
						<Rule Name="sMisMatchedMsmapi32VersionExcelWow" Query="lower-case($appName)='excel' and $n2DigitVersion&lt;15 and $CommonMisc_n400274PPTError&gt;0 and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send Excel workbook through email" Text="At least one error attempting to send an Excel workbook through email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="e2c79d0c-dce2-4ac1-9943-821f0330df6e" Symptoms="Error message,Email send/receive"></Rule>
						<Rule Name="sMisMatchedMsmapi32VersionPPTWow" Query="lower-case($appName)='powerpoint' and $n2DigitVersion&lt;15 and $CommonMisc_n100796ExcelError&gt;0 and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send PowerPoint file through email" Text="At least one error attempting to send a PowerPoint file through email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="a4bd1cab-f3b8-4d4d-913f-050112865e7a" Symptoms="Error message,Email send/receive"></Rule>
						<Rule Name="sMisMatchedMsmapi32VersionOutlookWow" Query="lower-case($appName)='outlook' and $n2DigitVersion&lt;15 and ($CommonMisc_n200724WordError&gt;0 or $CommonMisc_n400274PPTError&gt;0 or $CommonMisc_n100796ExcelError&gt;0) and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send Office files through email" Text="At least one error attempting to send an Office file thorugh email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="ee090dd1-19d4-4f47-ab2d-9393e95a52be" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Error message,Email send/receive"></Rule>
						</Setting>
					</Object>
				</Object>
			</Object>
			<Object Type="If" Key1="'%WOW6432NODE%'=''">
				<Object Type="Engine">
					<Setting Key1="EnvironmentVariable" Key2="COMMONPROGRAMFILES" Substitution="COMMONPROGRAMFILES" Display="Hide">
					</Setting>
					<Object Type="File" Key2="%COMMONPROGRAMFILES%\System\MSMAPI\%UILANGUAGECODE%\MSMapi32.dll" Display="Right">
						<Setting Key1="Version" Display="Right">
							<Rule Name="sMisMatchedMsmapi32VersionWord" Query="lower-case($appName)='word' and $n2DigitVersion&lt;15 and $CommonMisc_n200724WordError&gt;0 and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" Title="Error attempting to send Word document through email" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Text="At least one error attempting to send a Word document through email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="468c6f48-b9aa-4892-940f-90fa9abf3d9d" Symptoms="Error message,Email send/receive"></Rule>
							<Rule Name="sMisMatchedMsmapi32VersionExcel" Query="lower-case($appName)='excel' and $n2DigitVersion&lt;15 and $CommonMisc_n400274PPTError&gt;0 and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send Excel workbook through email" Text="At least one error attempting to send an Excel workbook through email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="ee951a36-172a-4e0f-9b17-ca2d9535c775" Symptoms="Error message,Email send/receive"></Rule>
							<Rule Name="sMisMatchedMsmapi32VersionPPT" Query="lower-case($appName)='powerpoint' and $n2DigitVersion&lt;15 and $CommonMisc_n100796ExcelError&gt;0 and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send PowerPoint file through email" Text="At least one error attempting to send a PowerPoint file through email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="6723dfec-6503-4ec4-b509-516ce2b6fd84" Symptoms="Error message,Email send/receive"></Rule>
							<Rule Name="sMisMatchedMsmapi32VersionOutlook" Query="lower-case($appName)='outlook' and $n2DigitVersion&lt;15 and ($CommonMisc_n200724WordError&gt;0 or $CommonMisc_n400274PPTError&gt;0 or $CommonMisc_n100796ExcelError&gt;0) and $n2DigitVersion&lt;number(substring($.,1,2))" Error="Warning" P0="'%COMMONPROGRAMFILESX86%'" P1="'%UILANGUAGECODE%'" Title="Error attempting to send Office files through email" Text="At least one error attempting to send an Office file thorugh email has been detected. This is due to a later version of Msmapi32.dll being installed by an Office Language Pack in the '{0}\System\MSMAPI\{1}' folder. Please click the 'Click here ...' link for steps to fix this problem." GUID="404117" SSID="0f5598ec-cd84-40c7-8d20-13386593b863" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Error message,Email send/receive"></Rule>
						</Setting>
					</Object>
				</Object>
			</Object>
		</Object>
	</Type>
	<Type Name="MSO">
    <!--Office 14, 15 and 16 MSI-->
    <Object Type="If" Key1="'%INSTALLTYPE%'='MSI'">
			<Object Type="If" Key1="'%WOW6432NODE%'='Wow6432Node'">
				<Object Type="Engine">
					<Setting Key1="EnvironmentVariable" Key2="COMMONPROGRAMFILES(X86)" Substitution="COMMONPROGRAMFILESX86" Display="Hide"/>
					<Object Type="File" Key2="%COMMONPROGRAMFILESX86%\Microsoft Shared\OFFICE%MAJORVERSION%\mso.dll" Display="Right">
						<Setting Key1="Version" Display="Right">
							<Rule Name="sMSOVersionWow" Query="$." AlwaysEvaluate="True">
							</Rule>
							<Rule Name="sMSOPRWow" Query="number(substring($sMSOVersionWow,11,1))=3" Error="Error" P0="$sMSOVersionWow" Title="The build number for Mso.dll indicates a Private Release (PR) build and this is an unsupported configuration" Text="The build number for Mso.dll '{0}' indicates a Private Release (PR) build. PR builds are intended only for testing and not production use. Please click the 'Click here ...' link and then install the latest publicly available update for Mso.dll listed in the article." GUID="518087" SSID="43eae04b-9396-4e20-b983-c878f559160f" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Configuration (unsupported or problematic)">
							</Rule>
            <Rule Name="sMso2013FromKB3114717FoundWow" Query="$n2DigitVersion=15 and $nInstallType='MSI' and $sMSOVersionWow='15.0.4797.1000'" Error="Warning" P1="if($bitness='x86','32-bit (x86)','64-bit (x64)')" Title="Slowness in Office programs after installing an update for Mso.dll" Text="The version of Mso.dll found on your computer indicates you installed the update from KB 3114717. The version of Mso.dll from this update has been seen to cause Office 2013 programs to slow down or freeze.&#xA;&#xA;If you are experiencing unusual slowness in your Office programs, please click the 'Click here...' link and then install the {1} update listed in the article.&#xA;Or, click the 'Download the update ...' link to access the {1} version of latest update for Mso.dll 2013." GUID="722876" SSID="f78f52a9-38f8-49a6-9cc0-2dd2be9312e7" PATCH="722897" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Slowness"></Rule>
						</Setting>
					</Object>
				</Object>
			</Object>
			<Object Type="If" Key1="'%WOW6432NODE%'=''">
				<Object Type="Engine">
					<Setting Key1="EnvironmentVariable" Key2="COMMONPROGRAMFILES" Substitution="COMMONPROGRAMFILES" Display="Hide">
					</Setting>
					<Object Type="File" Key2="%COMMONPROGRAMFILES%\Microsoft Shared\OFFICE%MAJORVERSION%\mso.dll" Display="Right">
						<Setting Key1="Version" Display="Right">
							<Rule Name="sMSOVersion" Query="$." AlwaysEvaluate="True">
							</Rule>
							<Rule Name="sMSOPR" Query="number(substring($sMSOVersion,11,1))=3" Error="Error" P0="sMSOVersion" Title="The build number for Mso.dll indicates a Private Release (PR) build and this is an unsupported configuration" Text="The build number for Mso.dll '{0}' indicates a Private Release (PR) build. PR builds are intended only for testing and not production use. Please click the 'Click here ...' link and then install the latest publicly available update for Mso.dll listed in the article." GUID="518087" SSID="35584122-c250-41d4-9f0d-f5fc9435e2ee" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Configuration (unsupported or problematic)">
							</Rule>
            <Rule Name="sMso2013FromKB3114717Found" Query="$n2DigitVersion=15 and $nInstallType='MSI' and $sMSOVersion='15.0.4797.1000'" Error="Warning" P1="if($bitness='x86','32-bit (x86)','64-bit (x64)')" P2="if($bitness='x86','722897','722898')" Title="Slowness in Office programs after installing an update for Mso.dll" Text="The version of Mso.dll found on your computer indicates you installed the update from KB 3114717. The version of Mso.dll from this update has been seen to cause Office 2013 programs to slow down or freeze.&#xA;&#xA;If you are experiencing unusual slowness in your Office programs, please click the 'Click here...' link and then install the {1} update listed in the article.&#xA;Or, click the 'Download the update ...' link to access the {1} version of latest update for Mso.dll 2013." GUID="722876" SSID="923d7414-d456-4d12-a688-d2770f7359c9" PATCH="{2}" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Slowness"></Rule>
						</Setting>
					</Object>
				</Object>
			</Object>
		</Object>
    <!--/Office 14, 15 and 16 MSI-->
    <!--Office 15 C2R only-->
    <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and '%MAJORVERSION%'='15'">
			<Object Type="If" Key1="'%APPBITNESS%'='x64'">
			<Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office %MAJORVERSION%\root\vfs\ProgramFilesCommonX64\Microsoft Shared\OFFICE%MAJORVERSION%\mso.dll" Display="Right">
				<Setting Key1="Version" Display="Right">
					<Rule Name="sMSOVersionC2R64" Query="$." AlwaysEvaluate="True">
					</Rule>
					<Rule Name="sMSOPRC2R64" Query="number(substring($sMSOVersionC2R64,11,1))=3" Error="Error" P0="sMSOVersionC2R64" Title="The build number for Mso.dll indicates a Private Release (PR) build and this is an unsupported configuration" Text="The build number for Mso.dll '{0}' indicates a Private Release (PR) build. PR builds are intended only for testing and not production use. Please click the 'Click here ...' link and then install the latest publicly available Click-to-run update listed in the article." GUID="386616" SSID="057bd7a9-11ec-480f-99c3-0a9f293fecf6" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Configuration (unsupported or problematic)">
					</Rule>
				</Setting>
			</Object>
		</Object>
			<Object Type="If" Key1="'%APPBITNESS%'='x86'">
				<Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office %MAJORVERSION%\root\vfs\ProgramFilesCommonX86\Microsoft Shared\OFFICE%MAJORVERSION%\mso.dll" Display="Right">
					<Setting Key1="Version" Display="Right">
						<Rule Name="sMSOVersionC2R" Query="$." AlwaysEvaluate="True">
						</Rule>
						<Rule Name="sMSOPRC2R" Query="number(substring($sMSOVersionC2R,11,1))=3" Error="Error" P0="sMSOVersionC2R" Title="The build number for Mso.dll indicates a Private Release (PR) build and this is an unsupported configuration" Text="The build number for Mso.dll '{0}' indicates a Private Release (PR) build. PR builds are intended only for testing and not production use. Please click the 'Click here ...' link and then install the latest publicly available Click-to-run update listed in the article." GUID="386616" SSID="8f34b32b-40bb-4f13-9a3b-7b0c83acb260" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Configuration (unsupported or problematic)">
						</Rule>
            <Rule Name="sMso2013FromKB3114717FoundC2R" Query="$n2DigitVersion=15 and $nInstallType='ClickToRun' and $sMSOVersionC2R='15.0.4797.1000'" Error="Warning" Title="Slowness in Office programs after installing an update for Mso.dll" Text="The version of Mso.dll found on your computer indicates you installed the February 9, 2016 update for Office 2013. The version of Mso.dll from this update has been seen to cause Office 2013 programs to slow down or freeze.&#xA;&#xA;If you are experiencing unusual slowness in your Office programs, please click the 'Click here...' link and then follow the listed steps to install a new update." GUID="722879" SSID="1d558db4-1529-4886-b3a5-f934e5e365bb" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Slowness"></Rule>
          </Setting>
				</Object>
			</Object>
		</Object>
    <!--/Office 15 C2R only-->
    <!--Office 16 C2R only-->
    <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and number('%MAJORVERSION%')&gt;15">
			<Object Type="If" Key1="'%WOW6432NODE%'='Wow6432Node'">
				<Object Type="File" Key2="%PROGRAMFILES(X86)%\Microsoft Office\root\vfs\ProgramFilesCommonX86\Microsoft Shared\OFFICE%MAJORVERSION%\mso.dll" Display="Right">
          <Setting Key1="Version" Display="Right">
            <Rule Name="sMSOVersion2016C2RWow" Query="$." AlwaysEvaluate="True">
            </Rule>
          </Setting>
				</Object>
			</Object>
			<Object Type="If" Key1="'%WOW6432NODE%'=''">
					<Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office\root\vfs\ProgramFilesCommon%APPBITNESS%\Microsoft Shared\OFFICE%MAJORVERSION%\mso.dll" Display="Right">
            <Setting Key1="Version" Display="Right">
              <Rule Name="sMSOVersion2016C2R" Query="$." AlwaysEvaluate="True">
              </Rule>
            </Setting>				
          </Object>
			</Object>
		</Object>
    <!--/Office 16 C2R only-->
    <Rule Name="sMso2010Version" Query="if($n2DigitVersion=14,if($sMSOVersion=true(),$sMSOVersion,if($sMSOVersionWow=true(),$sMSOVersionWow,-1)),-1)" AlwaysEvaluate="True"></Rule>
		<Rule Name="sMso2013Version" Query="if($n2DigitVersion=15,(if($sMSOVersion=true(),$sMSOVersion,if($sMSOVersionC2R=true(),$sMSOVersionC2R,if($sMSOVersionWow=true(),$sMSOVersionWow,if($sMSOVersionC2R64=true(),$sMSOVersionC2R64,-1))))),-1)" AlwaysEvaluate="True"></Rule>
    <Rule Name="sMso2016Version" Query="if($n2DigitVersion=16,(if($sMSOVersion=true(),$sMSOVersion,if($sMSOVersion2016C2R=true(),$sMSOVersion2016C2R,if($sMSOVersionWow=true(),$sMSOVersionWow,if($sMSOVersion2016C2RWow=true(),$sMSOVersion2016C2RWow,-1))))),-1)" AlwaysEvaluate="True"></Rule>
    <Rule Name="sMsoVersionSuperRule" Query="if($sMso2010Version=-1,if($sMso2013Version=-1,if($sMso2016Version=-1,-1,$sMso2016Version),$sMso2013Version),$sMso2010Version)"></Rule>

		<!--detect Mso.dll version SP1 updates-->
		<Rule Name="f2013SP1UpdateInstalledMsiWow" Query="$sMSOVersionWow=true() and versioncompare($sMSOVersionWow,'15.0.4569.1504')&gt;=0" AlwaysEvaluate="True"></Rule>
		<Rule Name="f2013SP1UpdateInstalledMsi" Query="$sMSOVersion=true() and versioncompare($sMSOVersion,'15.0.4569.1504')&gt;=0" AlwaysEvaluate="True"></Rule>
		<Rule Name="f2013SP1UpdateInstalledC2R64" Query="$sMSOVersionC2R64=true() and versioncompare($sMSOVersionC2R64,'15.0.4569.1504')&gt;=0" AlwaysEvaluate="True"></Rule>
		<Rule Name="f2013SP1UpdateInstalledC2R" Query="$sMSOVersionC2R=true() and versioncompare($sMSOVersionC2R,'15.0.4569.1504')&gt;=0" AlwaysEvaluate="True"></Rule>
		<Rule Name="fC2R2013SP1UpdateInstalled" Query="$n2DigitVersion=15 and ($f2013SP1UpdateInstalledMsiWow or $f2013SP1UpdateInstalledMsi or $f2013SP1UpdateInstalledC2R64 or $f2013SP1UpdateInstalledC2R)"></Rule>

		<!--detect Mso.dll version from August 2014 updates-->
		<Rule Name="fMsoAug2014UpdateInstalled" Query="$n2DigitVersion=15 and versioncompare($sMso2013Version,'15.0.4641.1001')&gt;=0"></Rule>
	</Type>
		
  <Type Name="ADALCSIDLL">
    <!--Office 15 MSI-->
    <Object Type="If" Key1="'%INSTALLTYPE%'='MSI'">
      <Object Type="If" Key1="'%WOW6432NODE%'='Wow6432Node'">
        <Object Type="Engine">
          <Setting Key1="EnvironmentVariable" Key2="COMMONPROGRAMFILES(X86)" Substitution="COMMONPROGRAMFILESX86" Display="Hide"/>
          <Object Type="File" Key2="%COMMONPROGRAMFILESX86%\Microsoft Shared\OFFICE%MAJORVERSION%\csi.dll" Display="Right">
            <Setting Key1="Version" Display="Right">
              <Rule Name="sCsiVersionWow" Query="$." AlwaysEvaluate="True">
              </Rule>
            </Setting>
          </Object>
          <Object Type="File" Key2="%COMMONPROGRAMFILESX86%\Microsoft Shared\OFFICE%MAJORVERSION%\adal.dll" Display="Right">
            <Setting Key1="Version" Display="Right">
              <Rule Name="sAdalVersionWow" Query="$." AlwaysEvaluate="True">
              </Rule>
            </Setting>
          </Object>
        </Object>
      </Object>
      <Object Type="If" Key1="'%WOW6432NODE%'=''">
        <Object Type="Engine">
          <Setting Key1="EnvironmentVariable" Key2="COMMONPROGRAMFILES" Substitution="COMMONPROGRAMFILES" Display="Hide">
          </Setting>
          <Object Type="File" Key2="%COMMONPROGRAMFILES%\Microsoft Shared\OFFICE%MAJORVERSION%\csi.dll" Display="Right">
            <Setting Key1="Version" Display="Right">
              <Rule Name="sCsiVersion" Query="$." AlwaysEvaluate="True">
              </Rule>
            </Setting>
          </Object>
          <Object Type="File" Key2="%COMMONPROGRAMFILES%\Microsoft Shared\OFFICE%MAJORVERSION%\adal.dll" Display="Right">
            <Setting Key1="Version" Display="Right">
              <Rule Name="sAdalVersion" Query="$." AlwaysEvaluate="True">
              </Rule>
            </Setting>
          </Object>
        </Object>
      </Object>
    </Object>
    <!--/Office 15 MSI-->
    <!--Office 15 C2R only-->
    <Object Type="If" Key1="'%INSTALLTYPE%'='ClickToRun' and '%MAJORVERSION%'='15'">
      <Object Type="If" Key1="'%APPBITNESS%'='x64'">
        <Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office %MAJORVERSION%\root\vfs\ProgramFilesCommonX64\Microsoft Shared\OFFICE%MAJORVERSION%\csi.dll" Display="Right">
          <Setting Key1="Version" Display="Right">
            <Rule Name="sCsiVersionC2R64" Query="$." AlwaysEvaluate="True">
            </Rule>
          </Setting>
        </Object>
        <Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office %MAJORVERSION%\root\vfs\ProgramFilesCommonX64\Microsoft Shared\OFFICE%MAJORVERSION%\adal.dll" Display="Right">
          <Setting Key1="Version" Display="Right">
            <Rule Name="sAdalVersionC2R64" Query="$." AlwaysEvaluate="True">
            </Rule>
          </Setting>
        </Object>
      </Object>
      <Object Type="If" Key1="'%APPBITNESS%'='x86'">
        <Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office %MAJORVERSION%\root\vfs\ProgramFilesCommonX86\Microsoft Shared\OFFICE%MAJORVERSION%\csi.dll" Display="Right">
          <Setting Key1="Version" Display="Right">
            <Rule Name="sCsiVersionC2R" Query="$." AlwaysEvaluate="True">
            </Rule>
          </Setting>
        </Object>
        <Object Type="File" Key2="%PROGRAMFILES%\Microsoft Office %MAJORVERSION%\root\vfs\ProgramFilesCommonX86\Microsoft Shared\OFFICE%MAJORVERSION%\adal.dll" Display="Right">
          <Setting Key1="Version" Display="Right">
            <Rule Name="sAdalVersionC2R" Query="$." AlwaysEvaluate="True">
            </Rule>
          </Setting>
        </Object>
      </Object>
    </Object>
    <!--/Office 15 C2R only-->
    <Rule Name="sCsi2013Version" Query="if($n2DigitVersion=15,(if($sCsiVersion=true(),$sCsiVersion,if($sCsiVersionC2R=true(),$sCsiVersionC2R,if($sCsiVersionWow=true(),$sCsiVersionWow,if($sCsiVersionC2R64=true(),$sCsiVersionC2R64,-1))))),-1)" AlwaysEvaluate="True"></Rule>
    <Rule Name="sAdal2013Version" Query="if($n2DigitVersion=15,(if($sAdalVersion=true(),$sAdalVersion,if($sAdalVersionC2R=true(),$sAdalVersionC2R,if($sAdalVersionWow=true(),$sAdalVersionWow,if($sAdalVersionC2R64=true(),$sAdalVersionC2R64,-1))))),-1)" AlwaysEvaluate="True"></Rule>
	</Type>

	<Type Name="OART">
		<Object Type="File" Key2="%INSTALLPATH%\oart.dll">
			<Setting Key1="Version">
        <Rule Name="sOartDllVersion" Query="$."></Rule>
			</Setting>
		</Object>
	</Type>

  <Type Name="CHART">
    <Object Type="File" Key2="%INSTALLPATH%\Chart.dll">
      <Setting Key1="Version">
        <Rule Name="sChartDllVersion" Query="$."></Rule>
      </Setting>
    </Object>
  </Type>
  
  <Type Name="OUTLOOKVERSION">
    <Object Type="File" Key2="%INSTALLPATH%\outlook.exe" Display="Hide">
      <Setting Key1="Version" Display="Hide">
        <Rule Name="sOutlookExeVersion" Query="$."></Rule>
      </Setting>
    </Object>
  </Type>
  
	<Type Name="CommonCrashes">
		<Rule Name="nFaultNtdll0002e3be" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='ntdll.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0002e3be')]])"></Rule>
		<Rule Name="nFaultNtdll0002e41b" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='ntdll.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0002e41b')]])"></Rule>
		<Rule Name="sNtdllHeapCrashKB2541119" Query="($OSDetails_fWinVistaInstalled or $OSDetails_fWin7Installed or $OSDetails_fWin2008Installed or $OSDetails_fWin2008R2Installed) and ($nFaultNtdll0002e3be&gt;0 or $nFaultNtdll0002e41b&gt;0)" Error="Error" P0="$nFaultNtdll0002e3be + $nFaultNtdll0002e41b" P1="'%APPNAME%'" Title="{1} crashing issue with file Ntdll.dll was detected" Text="A known crashing issue that was caused by Ntdll.dll was found {0} times in the Application Event log over the last 14 days. This problem is fixed by an update for Windows that is available in KB article 2541119.&#xA;&#xA;Please click the 'Click here ...' link for details on this crash and to access the download link for the update." GUID="526573" SSID="d277417d-c440-42a7-b4df-694cbd55f7d2" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"/>

    <Rule Name="nEmetDllCrashCount" Query="count(../Instance/Setting[@Key1='Faulting Module Name' and (lower-case(Value)='emet.dll')])"></Rule>
    <Rule Name="sEmetDllCrash" Query="$nEmetDllCrashCount&gt;0" Error="Error" P0="$nEmetDllCrashCount" P1="'%APPNAME%'" Title="{1} crashing issue with the file Emet.dll was detected" Text="A crashing issue that was caused by Emet.dll was found {0} times in the Application Event log over the last 14 days.&#xA;&#xA;Please click the 'Click here ...' link for details on this type of event." GUID="623510" SSID="0626a339-14fd-4ecb-beb3-895b803017ec" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash"></Rule>

    <Rule Name="nOffice16CrashAppvisvsubsystemX86" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0008a0ac')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='appvisvsubsystems32.dll')]])"></Rule>
    <Rule Name="nOffice16CrashAppvisvsubsystemX64" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='000000000009cc37')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='appvisvsubsystems64.dll')]])"></Rule>
    <Rule Name="sOffice16CrashAppvisvsubsystem" Query="$n2DigitVersion=16 and $nInstallType='ClickToRun' and versioncompare($C2R_Updates_fInstalledC2RVersion16,'16.0.6001.1038')&lt;0 and ($nOffice16CrashAppvisvsubsystemX86&gt;0 or $nOffice16CrashAppvisvsubsystemX64&gt;0)" Error="Error" P0="$nOffice16CrashAppvisvsubsystemX86 + $nOffice16CrashAppvisvsubsystemX64" Title="Known crashing issue caused by McAfee antivirus" Text="A crashing issue that is caused by McAfee antivirus and is documented in KB 3104401 has been detected {0} time(s). This issue is fixed in the November 10, 2015 update for Office 2016 build (16.0.6001.1038).&#xA;&#xA;Please click the 'Click here...' link for additional details and a solution to this issue." GUID="690516" SSID="b39f4e87-61c0-4887-a132-dee0f676475e" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>

    <Rule Name="nFaultNtdll0003f2b3" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='ntdll.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0003f2b3')]])"></Rule>
    <Rule Name="nFaultNtdll0003f2a3" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='ntdll.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0003f2a3')]])"></Rule>
    <Rule Name="sProtectedViewCrash2640502" Query="$n2DigitVersion=16 and (lower-case($appName)='excel' or lower-case($appName)='powerpoint' or lower-case($appName)='word' or lower-case($appName)='outlook') and ($nFaultNtdll0003f2b3&gt;0 or $nFaultNtdll0003f2a3&gt;0)" Error="Error" P0="$nFaultNtdll0003f2b3 + $nFaultNtdll0003f2a3" P1="'%APPNAME%'" Title="{1} issue preventing the opening of Office files or email attachments in Protected View" Text="A known issue that prevents you from opening Office files in Protected View was found {0} times in the Application Event log over the last 14 days. This problem is caused by a video driver that needs to be updated.&#xA;&#xA;To resolve this issue, make sure you run Windows Update to check for an updated driver or temporarily disable the Hardware Acceleration option.&#xA;&#xA;For details on these steps, please click the 'Click here ...' link and review the information in the 'For all other symptoms' section of the article." GUID="715541" SSID="8cf0fe29-5081-483d-b22c-94e0bf752e68" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash,Protected view,File Open error,Email attachments"/>
    
    <Rule Name="n2577714Crash00663f64" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='00663f64')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash00663ff3" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='00663ff3')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash000663ac" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='00663aac')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash00662d08" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='00662d08')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash000000000085ae5f" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='000000000085ae5f')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash000000000085abbf" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='000000000085abbf')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash00000000008637ff" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='00000000008637ff')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n2577714Crash0000000000856B4f" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000856B4f')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="sMso16Crash2577714MSI" Query="$n2DigitVersion=16 and $nInstallType='MSI' and versioncompare($MSO_sMso2016Version,'16.0.4312.1000')&lt;0 and ($n2577714Crash00663f64&gt;0 or $n2577714Crash00663ff3&gt;0 or $n2577714Crash000663ac&gt;0 or $n2577714Crash00662d08&gt;0 or $n2577714Crash000000000085ae5f&gt;0 or $n2577714Crash000000000085abbf&gt;0 or $n2577714Crash00000000008637ff&gt;0 or $n2577714Crash0000000000856B4f&gt;0)" Error="Error" P0="$n2577714Crash00663f64 + $n2577714Crash00663ff3 + $n2577714Crash000663ac + $n2577714Crash00662d08 + $n2577714Crash000000000085ae5f + $n2577714Crash000000000085abbf + $n2577714Crash00000000008637ff + $n2577714Crash0000000000856B4f" Title="Known crashing issue in Office 2016 programs" Text="A crashing issue that occurs in Office 2016 programs has been detected {0} time(s).&#xA;&#xA;Please click the 'Click here...' link for details on this issue.&#xA;Or, click the 'Download the update ...' link to access the {1} version of latest update for Mso.dll 2016." P1="if($bitness='x86','32-bit (x86)','64-bit (x64)')" P2="if($bitness='x86','715551','715552')" GUID="715550" PATCH="{2}" SSID="2bb353a4-97d9-4c4f-bd4f-151ad46b2da7" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>
    <Rule Name="sMso16Crash2577714C2RCB" Query="$n2DigitVersion=16 and $nInstallType='ClickToRun' and $C2R_Updates_sC2R2016BranchShortName='CB' and versioncompare($C2R_Updates_fInstalledC2RVersion16,'16.0.6366.2036')&lt;0 and ($n2577714Crash00663f64&gt;0 or $n2577714Crash00663ff3&gt;0 or $n2577714Crash000663ac&gt;0 or $n2577714Crash00662d08&gt;0 or $n2577714Crash000000000085ae5f&gt;0 or $n2577714Crash000000000085abbf&gt;0 or $n2577714Crash00000000008637ff&gt;0 or $n2577714Crash0000000000856B4f&gt;0)" Error="Error" P0="$n2577714Crash00663f64 + $n2577714Crash00663ff3 + $n2577714Crash000663ac + $n2577714Crash00662d08 + $n2577714Crash000000000085ae5f + $n2577714Crash000000000085abbf + $n2577714Crash00000000008637ff + $n2577714Crash0000000000856B4f" Title="Known crashing issue in Office 2016 programs" Text="A crashing issue that occurs in Office 2016 programs has been detected {0} time(s).&#xA;&#xA;Please click the 'Click here...' link and then follow the steps under 'Get updates manually' to update Office 2016." GUID="715553" SSID="c0a0c7e6-180e-4b16-a40f-7cfbac5d84d7" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>

    <!-- Un-comment the sMso16Crash2577714C2RCBB rule once they ship a build greater than 16.0.6001.1043 -->
    
    <!--Rule Name="sMso16Crash2577714C2RCBB" 
          Query="$n2DigitVersion=16 and $nInstallType='ClickToRun' and $C2R_Updates_sC2R2016BranchShortName='CBB' and versioncompare($C2R_Updates_fInstalledC2RVersion16,'16.0.6366.2036')&lt;0 and 
          ($n2577714Crash00663f64&gt;0 or $n2577714Crash00663ff3&gt;0 or $n2577714Crash000663ac&gt;0 or $n2577714Crash00662d08&gt;0 or $n2577714Crash000000000085ae5f&gt;0 or $n2577714Crash000000000085abbf&gt;0 or $n2577714Crash00000000008637ff&gt;0 or $n2577714Crash0000000000856B4f&gt;0)" Error="Error" P0="$n2577714Crash00663f64 + $n2577714Crash00663ff3 + $n2577714Crash000663ac + $n2577714Crash00662d08 + $n2577714Crash000000000085ae5f + $n2577714Crash000000000085abbf + $n2577714Crash00000000008637ff + $n2577714Crash0000000000856B4f" Title="Known crashing issue in Office 2016 programs" 
          Text="A crashing issue that occurs in Office 2016 programs has been detected {0} time(s).&#xd;&#xa;&#xd;&#xa;
          Please click the 'Click here...' link and then follow the steps under &#39;Get updates manually&#39; to update Office 2016." GUID="715553" SSID="3069a8dd-15a2-4031-97e9-e86dcd1af8c4" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule-->

    <Rule Name="n903767Crash107729285259" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0002ebdc')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n903767Crash107729186970" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0002ebd3')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n903767Crash107655973899" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='00028f40')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="sMso14Crash903767" Query="$n2DigitVersion=14 and versioncompare($MSO_sMso2010Version,'14.0.7163.5000')&lt;0 and ($n903767Crash107729285259&gt;0 or $n903767Crash107729186970&gt;0 or $n903767Crash107655973899&gt;0 )" Error="Error" P0="$n903767Crash107729285259 + $n903767Crash107729186970 + $n903767Crash107655973899" Title="Known crashing issue in Office programs when synchronizing with SharePoint" Text="A crashing issue that occurs when Office 2010 programs are synchronizing documents with SharePoint has been detected {0} time(s).&#xA;&#xA;Please click the 'Click here...' link for details on this issue.&#xA;Or, click the 'Download the update ...' link to access the {1} version of latest update for Mso.dll 2010." P1="if($bitness='x86','32-bit (x86)','64-bit (x64)')" P2="if($bitness='x86','715559','715560')" GUID="715558" PATCH="{2}" SSID="d50e7a68-652d-421e-9795-25e999d061d3" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>

    <Rule Name="nFaultNtdll3515811" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='ntdll.dll')] and Setting[@Key1='Exception code' and (lower-case(Value)='c0000374')]])"></Rule>
    <Rule Name="sMso15Crash3515811MSI" Query="$n2DigitVersion=15 and $nInstallType='MSI' and ($MSO_sMso2013Version='15.0.4771.1001' or $MSO_sMso2013Version='15.0.4779.1000') and $nFaultNtdll3515811&gt;0" Error="Error" P0="$nFaultNtdll3515811" Title="Known crashing issue in Office programs due to proxy server setting" Text="A crashing issue that occurs in Office 2013 programs when the proxy server setting 'Automatically detect settings' is enabled has been detected {0} time(s).&#xA;&#xA;Please click the 'Click here...' link for details on this issue." GUID="715566" SSID="f6c84417-2625-46e0-8e94-e53f0ff8c44d" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>
    <Rule Name="sMso15Crash3515811C2R" Query="$n2DigitVersion=15 and $nInstallType='ClickToRun' and ($MSO_sMso2013Version='15.0.4771.1001' or $MSO_sMso2013Version='15.0.4779.1000') and $nFaultNtdll3515811&gt;0" Error="Error" P0="$nFaultNtdll3515811" Title="Known crashing issue in Office programs due to proxy server setting" Text="A crashing issue that occurs in Office 2013 programs when the proxy server setting 'Automatically detect settings' is enabled has been detected {0} time(s).&#xA;&#xA;Please click the 'Click here...' link for details on this issue." GUID="715566" SSID="f8acb75a-2b6a-45c8-b10d-2e81f3487567" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>

    <Rule Name="n3513800Crash010a0872" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='010a0872')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash010a4c2a" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='010a4c2a')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash010a51d2" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='010a51d2')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash010a47fa" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='010a47fa')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash0000000000f102a6" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000f102a6')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash0000000000f0d036" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000f0d036')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash0000000000f180d6" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000f180d6')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash0000000000f00fc6" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000f00fc6')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="n3513800Crash0000000000f35a16" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000f35a16')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso.dll')]])"></Rule>
    <Rule Name="sMso15Crash3513800MSI" Query="$nInstallType='MSI' and $n2DigitVersion=15 and versioncompare($MSO_sMso2013Version,'15.0.4787.1002')&lt;0 and ($n3513800Crash010a0872&gt;0 or $n3513800Crash010a4c2a&gt;0 or $n3513800Crash010a51d2&gt;0 or $n3513800Crash010a47fa&gt;0 or $n3513800Crash0000000000f102a6&gt;0 or $n3513800Crash0000000000f0d036&gt;0 or $n3513800Crash0000000000f180d6&gt;0 or $n3513800Crash0000000000f00fc6&gt;0 or $n3513800Crash0000000000f35a16&gt;0)" Error="Error" P0="$n3513800Crash010a0872 + $n3513800Crash010a4c2a + $n3513800Crash010a51d2 + $n3513800Crash010a47fa + $n3513800Crash0000000000f102a6 + $n3513800Crash0000000000f0d036 + $n3513800Crash0000000000f180d6 + $n3513800Crash0000000000f00fc6 + $n3513800Crash0000000000f35a16" P1="if($bitness='x86','722886','722887')" Title="Known crashing issue in Office 2013 programs" Text="A known crashing issue that occurs in Office 2013 programs has been detected {0} time(s). It is fixed in the January 12, 2016 update for Mso.dll in Office 2013.&#xA;&#xA;Please click the 'Click here ...' link for details on the January 12, 2016 update. Or, click the 'Download the update ...' link to access the very latest update for Mso.dll 2013." GUID="722870" PATCH="{1}" SSID="637d38a8-50c6-434e-b969-3584a90d6ead" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>
    <Rule Name="sMso15Crash3513800C2R" Query="$nInstallType='ClickToRun' and $n2DigitVersion=15 and versioncompare($MSO_sMso2013Version,'15.0.4787.1002')&lt;0 and ($n3513800Crash010a0872&gt;0 or $n3513800Crash010a4c2a&gt;0 or $n3513800Crash010a51d2&gt;0 or $n3513800Crash010a47fa&gt;0 or $n3513800Crash0000000000f102a6&gt;0 or $n3513800Crash0000000000f0d036&gt;0 or $n3513800Crash0000000000f180d6&gt;0 or $n3513800Crash0000000000f00fc6&gt;0 or $n3513800Crash0000000000f35a16&gt;0)" Error="Error" P0="$n3513800Crash010a0872 + $n3513800Crash010a4c2a + $n3513800Crash010a51d2 + $n3513800Crash010a47fa + $n3513800Crash0000000000f102a6 + $n3513800Crash0000000000f0d036 + $n3513800Crash0000000000f180d6 + $n3513800Crash0000000000f00fc6 + $n3513800Crash0000000000f35a16" Title="Known crashing issue in Office 2013 programs" Text="A known crashing issue that occurs in Office 2013 programs has been detected {0} time(s). It is fixed in the January 12, 2016 update for Mso.dll in Office 2013.&#xA;&#xA;To resolve this problem, click the 'Click here...' link and then update Office using the steps in the 'Get the latest version of Office' section." GUID="722871" SSID="1b316616-50ae-408b-a6cc-9dbece2ab914" SaraSvc="True" Symptoms="Crash (with a fix)"></Rule>

    <Rule Name="n3628383Crash0000000000001944" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000001944')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0000b46c" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000b46c')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0000000000001754" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000001754')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash000000000000174f" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='000000000000174f')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0008a409" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0008a409')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0000000000001867" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000001867')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0000000000001a57" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000001a57')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash000099e4" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='000099e4')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash000000000000193f" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='000000000000193f')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0000000000001a79" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000001a79')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="n3628383Crash0000968c" Query="count(../Instance[Setting[@Key1='Fault offset' and (lower-case(Value)='0000968c')] and Setting[@Key1='Faulting Module Name' and (lower-case(Value)='msvcrt.dll')]])"/>
    <Rule Name="sCrash3628383Msvcrt2013C2R" Query="$n2DigitVersion=15 and $nInstallType='ClickToRun' and versioncompare($MSO_sMso2013Version,'15.0.4841.1000')&lt;0 and (lower-case($appName)='excel' or lower-case($appName)='powerpoint' or lower-case($appName)='word' or lower-case($appName)='outlook' or lower-case($appName)='onenote') and ($n3628383Crash0000000000001944&gt;0 or $n3628383Crash0000b46c&gt;0 or $n3628383Crash0000000000001754&gt;0 or $n3628383Crash000000000000174f&gt;0 or $n3628383Crash0008a409&gt;0 or $n3628383Crash0000000000001867&gt;0 or $n3628383Crash0000000000001a57&gt;0 or $n3628383Crash000099e4&gt;0 or $n3628383Crash000000000000193f&gt;0 or $n3628383Crash0000000000001a79&gt;0 or $n3628383Crash0000968c&gt;0)" Error="Error" P0="$n3628383Crash0000000000001944 + $n3628383Crash0000b46c + $n3628383Crash0000000000001754 + $n3628383Crash000000000000174f + $n3628383Crash0008a409 + $n3628383Crash0000000000001867 + $n3628383Crash0000000000001a57 + $n3628383Crash000099e4 + $n3628383Crash000000000000193f + $n3628383Crash0000000000001a79 + $n3628383Crash0000968c" Title="Known crashing issue in Office programs has been detected" Text="A crashing issue that occurs in Office programs has been detected {0} time(s). It is fixed in the July 5, 2016 update for Mso.dll in Office 2013.&#xA;&#xA;To resolve this problem, update your Office 2013 installation to install the latest version of Mso.dll" GUID="722871" SSID="73dfeaf5-e771-4c4f-8fbf-68a1c6d0a642" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash"/>
    <Rule Name="sCrash3628383Msvcrt2013MSI" Query="$n2DigitVersion=15 and $nInstallType='MSI' and versioncompare($MSO_sMso2013Version,'15.0.4841.1000')&lt;0 and (lower-case($appName)='excel' or lower-case($appName)='powerpoint' or lower-case($appName)='word' or lower-case($appName)='outlook' or lower-case($appName)='onenote') and ($n3628383Crash0000000000001944&gt;0 or $n3628383Crash0000b46c&gt;0 or $n3628383Crash0000000000001754&gt;0 or $n3628383Crash000000000000174f&gt;0 or $n3628383Crash0008a409&gt;0 or $n3628383Crash0000000000001867&gt;0 or $n3628383Crash0000000000001a57&gt;0 or $n3628383Crash000099e4&gt;0 or $n3628383Crash000000000000193f&gt;0 or $n3628383Crash0000000000001a79&gt;0 or $n3628383Crash0000968c&gt;0)" Error="Error" P0="$n3628383Crash0000000000001944 + $n3628383Crash0000b46c + $n3628383Crash0000000000001754 + $n3628383Crash000000000000174f + $n3628383Crash0008a409 + $n3628383Crash0000000000001867 + $n3628383Crash0000000000001a57 + $n3628383Crash000099e4 + $n3628383Crash000000000000193f + $n3628383Crash0000000000001a79 + $n3628383Crash0000968c" Title="Known crashing issue in Office programs has been detected" Text="A known crashing issue that occurs in Office 2013 programs has been detected {0} time(s). It is fixed in the July 5, 2016 update for Mso.dll in Office 2013.&#xA;&#xA;Please install the latest update for Mso.dll 2013 to fix this issue." P1="if($bitness='x86','282193','396431')" GUID="533827" PATCH="{1}" SSID="44e28396-6888-4f1f-895f-ffe159111053" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash"/>

    <Rule Name="nFaultOsfshared0000194d" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='osfshared.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0000194d')]])"></Rule>
    <Rule Name="nFaultOsfshared0000592d" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='osfshared.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0000592d')]])"></Rule>
    <Rule Name="sCrash849222C2R2016" Query="$n2DigitVersion=16 and $nInstallType='ClickToRun' and versioncompare($C2R_Updates_fInstalledC2RVersion16,'16.0.7070.2033')&lt;0 and (lower-case($appName)='powerpoint' or lower-case($appName)='word') and ($nFaultOsfshared0000194d&gt;0 or $nFaultOsfshared0000592d&gt;0)" Error="Error" P0="$nFaultOsfshared0000194d + $nFaultOsfshared0000592d" Title="Known crashing issue in Office programs has been detected" Text="A crashing issue that occurs in some Office programs has been detected {0} time(s). It is fixed in the 16.0.7070.2033 build of Office 2016.&#xA;&#xA;To resolve this problem, update your Office 2016 installation to the latest version." GUID="715553" SSID="d58227c8-ec16-41ee-a94c-f2248801a376" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash"/>

    <Rule Name="nFaultMso20win32client0015e0bb" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso20win32client.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0015e0bb')]])"></Rule>
    <Rule Name="nFaultMso20win32client0015e05f" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso20win32client.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0015e05f')]])"></Rule>
    <Rule Name="nFaultMso20win32client00155cf3" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso20win32client.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='00155cf3')]])"></Rule>
    <Rule Name="nFaultMso20win32client0000000000107732" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso20win32client.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='0000000000107732')]])"></Rule>
    <Rule Name="nFaultMso20win32client000bd8e0" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='mso20win32client.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='000bd8e0')]])"></Rule>
    <Rule Name="sCrash852104C2R2016" Query="$n2DigitVersion=16 and $nInstallType='ClickToRun' and versioncompare($C2R_Updates_fInstalledC2RVersion16,'16.0.7070.2033')&lt;0 and (lower-case($appName)='powerpoint' or lower-case($appName)='word' or lower-case($appName)='excel') and ($nFaultMso20win32client0015e0bb&gt;0 or $nFaultMso20win32client0015e05f&gt;0 or $nFaultMso20win32client00155cf3&gt;0 or $nFaultMso20win32client0000000000107732&gt;0 or $nFaultMso20win32client000bd8e0&gt;0)" Error="Error" P0="$nFaultMso20win32client0015e0bb + $nFaultMso20win32client0015e05f + $nFaultMso20win32client00155cf3 + $nFaultMso20win32client0000000000107732 + $nFaultMso20win32client000bd8e0" Title="Known crashing issue in Office programs has been detected" Text="A crashing issue that occurs in some Office programs has been detected {0} time(s). It is fixed in the 16.0.7070.2033 build of Office 2016.&#xA;&#xA;To resolve this problem, update your Office 2016 installation to the latest version." GUID="715553" SSID="d885a4a2-d42b-4d04-9f77-f01961b39157" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash"/>

    <Rule Name="nFaultmso98win32client809922" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (contains(lower-case(Value),'stackhash_'))] and Setting[@Key1='Exception code' and (lower-case(Value)='c0000374')]])"></Rule>
    <Rule Name="sCrash809922C2R2016" Query="$n2DigitVersion=16 and $nInstallType='ClickToRun' and versioncompare($C2R_Updates_fInstalledC2RVersion16,'16.0.7070.2026')&lt;0 and (lower-case($appName)='powerpoint' or lower-case($appName)='word' or lower-case($appName)='excel') and $nFaultmso98win32client809922&gt;0" Error="Error" P0="$nFaultmso98win32client809922" Title="Known crashing issue in Office programs has been detected" Text="A crashing issue that occurs in some Office programs has been detected {0} time(s). It is fixed in the 16.0.7070.2026 build of Office 2016.&#xA;&#xA;To resolve this problem, update your Office 2016 installation to the latest version." GUID="715553" SSID="34b160f7-4982-44a7-af95-c6c29f41a547" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Crash"/>

  </Type>
  
  <Type Name="NonOfficeAppCrashes">
    <Object Type="EventLog" Key1="Application" Key3="1000" Key4="oleaut32.dll" Key5="%MAXEVENTS%" Key7="%DAYS%" Key8="10000" Task="Full Scan">
      <Setting Key1="Faulting Module Name" Display="Right"></Setting>
      <Setting Key1="Fault offset" Display="Right"></Setting>
      <Rule Name="nCrashOleaut32Dll000046b1" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='oleaut32.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='000046b1')]])"></Rule>
      <Rule Name="nCrashOleaut32Dll00023e1b" Query="count(../Instance[Setting[@Key1='Faulting Module Name' and (lower-case(Value)='oleaut32.dll')] and Setting[@Key1='Fault offset' and (lower-case(Value)='00023e1b')]])"></Rule>
      <Rule Name="sCrashOleaut32Dll" Query="(lower-case($appName)='excel' or lower-case($appName)='powerpoint' or lower-case($appName)='word') and ($nCrashOleaut32Dll000046b1&gt;0 or $nCrashOleaut32Dll00023e1b&gt;0)" Error="Error" P0="$nCrashOleaut32Dll000046b1 + $nCrashOleaut32Dll00023e1b" Title="Crashing issue working with Office documents on a SharePoint site" Text="A known crashing issue that was caused by Oleaut32.dll was found {0} time(s) in the Application Event log over the last 14 days. This problem is caused when you have multiple versions of Office installed and the wrong version of the 'SharePoint OpenDocuments Class' Add-On is registered.&#xA;&#xA;Please click the 'Click here ...' link for details and resolution to this issue." GUID="619939" SSID="b9ac845a-dd1d-4363-9ba5-766892175bac" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Crash (with a fix)"/>
    </Object>
  </Type>

  <Type Name="ADAL">
    <!--ADAL updates-->
      <Object Type="Group" Name="Mso.dll" Display="Right">
        <Object Type="Group" Name="Hidden">
          <Rule Name="fKB2956151Installed" Query="versioncompare($MSO_sMso2013Version,'15.0.4701.1000')" P0="if($fKB2956151Installed&gt;=0,' ',' not ')" P1="if($nInstallType='MSI','KB2956151','Click-to-run March 2015 build')" P2="if($fKB2956151Installed!=1,if($nInstallType='ClickToRun',386616,533827),615090)" P3="if($fKB2956151Installed!=1,' Click to access the latest version of Mso.dll.','')" Text="{1} (or later) is{0}installed.{3}" GUID="{2}">
          </Rule>
        </Object>
      </Object>
    <Object Type="Group" Name="Csi.dll" Display="Right">
      <Object Type="Group" Name="Hidden">
        <Rule Name="fCsiDllMinVersionFound" Query="versioncompare($ADALCSIDLL_sCsi2013Version,'15.0.4625.1000')" P0="if($fCsiDllMinVersionFound&gt;=0,' ',' not ')" Text="Csi.dll version 15.0.4625.1000 (or later) is{0}installed." GUID="615090"></Rule>
      </Object>
    </Object>
    <Object Type="Group" Name="Adal.dll" Display="Right">
      <Object Type="Group" Name="Hidden">
        <Rule Name="fAdalDllMinVersionFound" Query="versioncompare($ADALCSIDLL_sAdal2013Version,'1.0.2016.624')" P0="if($fAdalDllMinVersionFound&gt;=0,' ',' not ')" Text="Adal.dll version 1.0.2016.624 (or later) is{0}installed." GUID="615090"></Rule>
      </Object>
    </Object>
    <Object Type="Group" Name="Groove.exe" Display="Right">
      <Object Type="File" Key2="%INSTALLPATH%\Groove.exe" Display="Right">
        <Setting Key1="Version" Display="Right">
          <!--Rule Name="sGrooveVersion" Query="$."></Rule-->
        </Setting>
        <Rule Name="fGrooveExeExists" Query="if(../Instance/Setting=true(),../Instance/Setting/Value,-1)"></Rule>
      </Object>
      <Object Type="Group" Name="Hidden">
        <Rule Name="fGroovePreReqInstalled" Query="if($fGrooveExeExists!=-1,versioncompare($fGrooveExeExists,'15.0.4625.1000'),$fGrooveExeExists)" P0="if($fGroovePreReqInstalled&gt;=0,' ',' not ')" Text="Groove.exe 15.0.4625.1000 or later is{0}installed." GUID="615090">
        </Rule>
      </Object>
    </Object>
    <!--/ADAL updates-->
  </Type>

  <Type Name="OSDetails">
    <Object Type="Group" Name="Operating System Details" TrackProgress="TrackProgress">
      <Object Type="WMI" Key3="Win32_OperatingSystem" Display="Hide">
        <Setting Key1="__VALUES" ShowInSummary="False"/>
        <Setting Key1="RegisteredUser" NotForExport="True"/>
        <Setting Key1="CSName" NotForExport="True"/>
        <Setting Key1="Caption" Substitution="WINDOWSNAME" Display="Hide">
          <Rule Name="sWindowsName" Query="$."></Rule>
        </Setting>
        <Setting Key1="SystemDrive" Substitution="SYSDRIVE" Display="Hide">
          <Rule Name="sSystemDrive" Query="$."></Rule>
        </Setting>
        <Setting Key1="Version" Substitution="WINDOWSVERSION" Display="Hide">
          <Rule Name="WindowsVersion" Query="$."/>
        </Setting>
        <Setting Key1="CSDVersion" Substitution="WINDOWSSP"></Setting>
        <Object Type="Group" Name="Windows Version =%WINDOWSVERSION%" Display="Right">
          <Setting Key1="" Display="Hide"/>
        </Object>
        <Setting Key1="ServicePackMajorVersion">
          <Rule Name="WindowsSP" Query="$."/>
          <Rule Name="sNotSupported2010Config" Query="$n2DigitVersion=14 and $OSDetails_WindowsVersion='5.1.2600'and $WindowsSP&lt;3 " Error="Warning" Title="Windows XP Service Pack 3 is not installed" Text="Office 2010 is installed on a computer with Windows XP and Service Pack 3 for Windows is not installed. Windows XP SP3 is a system requirement for Office 2010." GUID="275613" SSID="2860307e-ad0d-4107-b7fd-8c6a11bdfd8d" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" SaraSvc="True" Symptoms="Product not updated,Configuration (unsupported or problematic)">
          </Rule>
        </Setting>
        <Setting Key1="OSArchitecture" Substitution="OSBITNESS" Display="Hide">
          <Rule Name="OSArchitecture" Query="if($.='64-bit','x64','x86')"/>
        </Setting>
        <Object Type="Group" Name="Windows Bitness =%OSBITNESS%" Display="Right">
          <Setting Key1="" Display="Hide"/>
        </Object>
        <Setting Key1="ProductType" Substitution="OSPRODUCTYPE" Display="Hide">
          <Rule Name="sOSProductType" Query="$."/>
          <Rule Name="fOSServer" Query="$.=3 or $.=2"></Rule>
        </Setting>
        <Object Type="If" Key1="'%OSPRODUCTYPE%'='3'">
          <Object Type="Group" Name="Server Features" Display="Right">
            <Object Type="WMI" Key1="%MACHINENAME%" Key3="Win32_ServerFeature">
              <Setting Key1="__VALUES"/>
              <Rule Name="fMissingDesktopXP" Query="../Instance/Setting[@Key1='ID' and Value='35']=false()"></Rule>
              <Rule Name="sMissingDesktopXP" Query="../Instance/Setting[@Key1='ID' and Value='35']=false() and $n2DigitVersion&gt;11 and lower-case($appName)='powerpoint'" Error="Warning" Title="Desktop Experience not installed, so some PowerPoint features are unavailable" Text="The Desktop Experience not installed for Windows. In this configuration, you may not be able to insert or edit video when using PowerPoint. If needed, please click the 'Click here to see possible solution ...' link for instructions." GUID="282480" SSID="1f05d388-5250-4acb-9779-7a1d417d0dc0" SaraSvc="True" Symptoms="Video,Audio">
              </Rule>
            </Object>
          </Object>
        </Object>
        <Rule Name="fWinVistaInstalled" Query="(versioncompare($WindowsVersion,'6.0.0.0')&gt;=0 and versioncompare($WindowsVersion,'6.1.0.0')&lt;0) and $sOSProductType=1"></Rule>
        <Rule Name="fWin7Installed" Query="(versioncompare($WindowsVersion,'6.1.0.0')&gt;=0 and versioncompare($WindowsVersion,'6.2.0.0')&lt;0) and $sOSProductType=1"></Rule>
        <Rule Name="fWin2008Installed" Query="(versioncompare($WindowsVersion,'6.0.0.0')&gt;=0 and versioncompare($WindowsVersion,'6.1.0.0')&lt;0) and $sOSProductType&gt;1"></Rule>
        <Rule Name="fWin2008R2Installed" Query="(versioncompare($WindowsVersion,'6.1.0.0')&gt;=0 and versioncompare($WindowsVersion,'6.2.0.0')&lt;0) and $sOSProductType&gt;1"></Rule>
        <Rule Name="fWin2012Installed" Query="(versioncompare($WindowsVersion,'6.2.0.0')&gt;=0 and versioncompare($WindowsVersion,'6.3.0.0')&lt;0) and $sOSProductType&gt;1"></Rule>
        <Rule Name="fWin2012R2Installed" Query="(versioncompare($WindowsVersion,'6.3.0.0')&gt;=0 and versioncompare($WindowsVersion,'6.4.0.0')&lt;0) and $sOSProductType&gt;1"></Rule>
        <Rule Name="fWin8Installed" Query="(versioncompare($WindowsVersion,'6.2.0.0')&gt;0 and versioncompare($WindowsVersion,'6.3.0.0')&lt;0) and $sOSProductType=1"></Rule>
        <Rule Name="fWin81Installed" Query="(versioncompare($WindowsVersion,'6.3.0.0')&gt;0 and versioncompare($WindowsVersion,'6.4.0.0')&lt;0) and $sOSProductType=1"></Rule>
        <Rule Name="fWindows8OrAbove" Query="(versioncompare($WindowsVersion,'6.2.0.0')&gt;=0) and $sOSProductType=1"></Rule>
        <Rule Name="fWin10Installed" Query="(versioncompare($WindowsVersion,'10.0.0.0')&gt;0 and versioncompare($WindowsVersion,'10.1.0.0')&lt;0) and $sOSProductType=1"></Rule>
        <!--Office2013License-->
        <Object Type="Group" Name="Software Licenses">
          <!--check for Windows 7-->
          <Object Type="If" Key1="'%MAJORVERSION%'='15' and (versioncompare('%WINDOWSVERSION%','6.1.0.0')&gt;0 and versioncompare('%WINDOWSVERSION%','6.2.0.0')&lt;0) and '%OSPRODUCTYPE%'='1'">
            <Object Type="WMI" Key3="OfficeSoftwareProtectionProduct" Display="Hide">
              <Setting Key1="Description"></Setting>
              <Setting Key1="LicenseFamily"></Setting>
              <Setting Key1="LicenseStatus"></Setting>
            </Object>
          </Object>
          <!--check for Windows 8, 8.1, 10 and beyond-->
          <Object Type="If" Key1="'%MAJORVERSION%'='15' and versioncompare('%WINDOWSVERSION%','6.2.0.0')&gt;0 and '%OSPRODUCTYPE%'='1'">
            <Object Type="WMI" Key3="SoftwareLicensingProduct" Display="Hide">
              <Setting Key1="Description"></Setting>
              <Setting Key1="LicenseFamily"></Setting>
              <Setting Key1="LicenseStatus"></Setting>
            </Object>
          </Object>
          <Rule Name="nNoGPOSKULicenseCount" Query="count(../Instance/Object/Instance/Object/Instance[(Setting[@Key1='LicenseFamily' and (contains(Value,'HomeBusiness')or contains(Value,'HomeStudent') or contains(Value,'O365Business') or contains(Value,'O365Home') or contains(Value,'O365SmallBus') or contains(Value,'Personal') or contains(Value,'Professional') or contains(Value,'StandardMSDN') or contains(Value,'StandardR'))]) and (Setting[@Key1='LicenseStatus' and Value=1])])"></Rule>
          <Rule Name="sNoGPOSKULicense" Query="$fPolicies and $nNoGPOSKULicenseCount&gt;0" Error="None" Title="Group policy settings for Office 2013 were found but the Office 2013 license does not support group policies" Text="Group policy settings for Office 2013 were found in the registry but the Office 2013 license does not support group policies. To see the active Office 2013 license, click Find in Configuration Details and then search for 'Software Licenses'. Then, review the list of licences for the 'Office 15' SKU where LicenseStatus=1." GUID="303840" SSID="d800c47e-4a41-4afb-8161-e959e7385f95" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"></Rule>
        </Object>
        <!--/Office2013License-->
        <Object Type="Group" Name="Windows Info" Display="Right" ShowInSummary="True">
          <Object Type="Group" Name="Windows Name = %WINDOWSNAME%" Display="Right">
            <Setting Key1="" Display="Hide"></Setting>
          </Object>
          <!-- Windows XP or Windows Server 2003 installs do not support the OSArchitecture property, so the bitness comes from the version number -->
          <Object Type="If" Key1="starts-with('%WINDOWSVERSION%','5.1')">
            <Object Type="Group" Name="Windows Bitness = 32-bit" Display="Right">
              <Setting Key1="" Display="Hide"></Setting>
            </Object>
          </Object>
          <Object Type="If" Key1="starts-with('%WINDOWSVERSION%','5.2')">
            <Object Type="Group" Name="Windows Bitness = 64-bit" Display="Right">
              <Setting Key1="" Display="Hide"></Setting>
            </Object>
          </Object>
          <Object Type="Group" Name="Windows Bitness = %OSBITNESS%" Display="Right">
            <Setting Key1="" Display="Hide"></Setting>
          </Object>
          <Object Type="If" Key1="'%WINDOWSSP%'=''">
            <Object Type="Group" Name="Windows Service Pack =RTM" Display="Right">
              <Setting Key1="" Display="Hide"></Setting>
            </Object>
          </Object>
          <Object Type="If" Key1="'%WINDOWSSP%'!=''">
            <Object Type="Group" Name="Windows Service Pack = %WINDOWSSP%" Display="Right">
              <Setting Key1="" Display="Hide"></Setting>
            </Object>
          </Object>
          <Object Type="Engine" Display="Hide">
            <Setting Key1="EnvironmentVariable" Key2="SESSIONNAME" Substitution="SESSIONNAME" Display="Hide"></Setting>
            <Object Type="If" Key1="starts-with(lower-case('%SESSIONNAME%'),'con')">
              <Object Type="Group" Name="Client session = Console/workstation" Display="Right">
                <Setting Key1="" Display="Hide"></Setting>
              </Object>
            </Object>
            <Object Type="If" Key1="starts-with(lower-case('%SESSIONNAME%'),'rdp')">
              <Object Type="Group" Name="Client session =RDP - Terminal Server" Display="Right">
                <Setting Key1="" Display="Hide"></Setting>
              </Object>
            </Object>
            <Object Type="If" Key1="starts-with(lower-case('%SESSIONNAME%'),'ica')">
              <Object Type="Group" Name="Client session =Citrix - Terminal Server" Display="Right">
                <Setting Key1="" Display="Hide"></Setting>
              </Object>
            </Object>
          </Object>
        </Object>
      </Object>
    </Object>
  </Type>
  <Type Name="WUDetails">
    <Object Type="Group" Name="Windows Update settings" TrackProgress="TrackProgress">
      <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate">
        <Setting Key1="WUServer"></Setting>
        <Setting Key1="WUStatusServer"></Setting>
        <Rule Name="fWUServerPol" Query="if((../Instance/Setting/@Key1='WUServer')=true(),../Instance/Setting[@Key1='WUServer']/Value,-1)"></Rule>
      </Object>
      <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU">
        <Setting Key1="AUOptions">
          <Rule Name="fAUOptionsPol" Query="$."></Rule>
        </Setting>
        <Rule Name="sAutoUpdateOptionPol" Query="$fNoAutoUpdatePol=0" Error="None" P0="if($fAUOptionsPol=2,'Check for updates but let me choose whether to download and install them',if($fAUOptionsPol=3,'Download updates but let me check whether to install them',if($fAUOptionsPol=4,'Install updates automatically',if($fAUOptionsPol=5,'Allow local admin to choose setting',''))))" Title="Windows Update setting for 'Important updates' is configured by group policy" Text="The Windows Update setting that controls the downloading and installation of 'Important updates' is set to '{0}' by group policy." GUID="623774" SSID="733bbc97-2fb8-448a-8655-ed3c2892a4e0" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Windows Update"></Rule>
        <Setting Key1="NoAutoUpdate">
          <Rule Name="sNoAutoUpdatePol" Query="$.=1" Error="Error" Title="Windows Update setting for 'Important updates' is disabled by group policy" Text="The Windows Update setting that controls the downloading and installation of 'Important updates' is set to 'Never check for updates' by group policy. This is not a recommended configuration." GUID="623777" SSID="eaca5fe4-2652-4d00-91d4-292ac9a7d5e5" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Windows Update"></Rule>
        </Setting>
        <Rule Name="fNoAutoUpdatePol" Query="if((../Instance/Setting/@Key1='NoAutoUpdate')=true(),../Instance/Setting[@Key1='NoAutoUpdate']/Value,-1)"></Rule>
        <Setting Key1="UseWUServer">
          <Rule Name="sUseWUServerPol" Query="$.=1 and $fNoAutoUpdatePol!=1" Error="None" P0="if($fWUServerPol=-1,'server not specified',$fWUServerPol)" Title="Windows updates are configured to use internal 'Update' server" Text="Windows updates are configured to use the internal update server '{0}'" GUID="623776" SSID="262be8d1-56d2-4675-a895-770bf6680a32" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Windows Update"></Rule>
        </Setting>
        <Rule Name="fUseWUServerPol" Query="if((../Instance/Setting/@Key1='UseWUServer')=true(),../Instance/Setting[@Key1='UseWUServer']/Value,-1)"></Rule>
      </Object>
      <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="SOFTWARE\Microsoft\Windows\CurrentVersion\WindowsUpdate\Auto Update">
        <Setting Key1="AUOptions">
          <Rule Name="fAUOptions" Query="$."></Rule>
        </Setting>
        <Object Type="Group" Name="Hidden">
          <Rule Name="sAutoUpdateOption" Query="$fNoAutoUpdatePol=-1" Error="None" P0="if($fAUOptions=1,'Never check for updates',if($fAUOptions=2,'Check for updates but let me choose whether to download and install them',if($fAUOptions=3,'Download updates but let me check whether to install them',if($fAUOptions=4,'Install updates automatically',''))))" Title="Windows Update user-controlled setting" Text="The Windows Update setting that controls the downloading and installation of 'Important updates' is '{0}'" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Windows Update"></Rule>
          <Rule Name="sAutoUpdateOptionNullByPolicy" Query="$fNoAutoUpdatePol!=-1" Text="The user-controlled Windows Update setting not used because group policy is being used"></Rule>
        </Object>
      </Object>
    </Object>
  </Type>
  <Type Name="WindowsUpdatesToInstall" TrackProgress="TrackProgess">
    <Object Type="Script" Key2="VBScript">
      <Script>
        'Sleeps until the wupdates.xml is found
        Dim ofs,sFilePathAndName
        Set oFS = CreateObject("Scripting.FileSystemObject")
        Const TemporaryFolder = 2

        Dim tempFolder: tempFolder = oFS.GetSpecialFolder(TemporaryFolder)
        sFilePathAndName = tempFolder + "\wupdates.xml"
        For I = 0 To 100
          If oFS.FileExists(sFilePathAndName) Then
            I = 100000
          Else
            WScript.Sleep 2000
          End If
        Next
        'Give it another couple seconds in case the file just got created and hasn't finished yet
        WScript.Sleep 2000
        Set oFS = Nothing
    </Script>
    </Object>
    <Object Type="Group" Name="Windows Updates not yet installed">
      <Object Type="Engine" Display="Hide">
        <Setting Key1="EnvironmentVariable" Key2="TEMP" Substitution="TMPDIR" Display="Hide"></Setting>
        <Object Type="XML" Key2="%TMPDIR%\wupdates.xml" Key3="//Update" Display="Hide">
          <Setting Key1="@Title" Substitution="UPDATETITLE" Display="Hide">
          </Setting>
          <Object Type="Group" Name="%UPDATETITLE%" Display="Right">
            <Setting Key1="" Display="Hide"></Setting>
          </Object>         
          <Rule Name="nMissingWindowsUpdates" Query="count(../Instance)&gt;0" Error="None" P0="count(../Instance)" P1="if($WUDetails_fUseWUServerPol=-1 or $WUDetails_fUseWUServerPol=0,'Please run Windows Update to check for any _Critical_ or _Important_ updates that need to be installed.','Because your Windows Updates are managed by your organization, please check with your administrator to see if you need any *Critical* or *Important* updates for Windows installed.')" Title="OffCAT found {0} Windows Update(s) of all 'types' that are available" Text="NOTE - Depending on your Windows Update settings you may not necessarily see all available updates when you run Windows Update.&#xA;&#xA;OffCAT found {0} update(s) of all severity types for Windows that are not yet installed. {1}" SSID="af224735-8385-464b-bca0-d3e8cf6ba5f1" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Windows Update"></Rule>
        </Object>
      </Object>
    </Object>
  </Type>
  <Type Name="OfficePolicies">
    <Object Type="Group" Name="HKEY_LOCAL_MACHINE\Software\Policies\Office\%MAJORVERSION%.0">
      <Object Type="Registry" Key2="HKEY_LOCAL_MACHINE" Key3="Software\Policies\Microsoft\Office\%MAJORVERSION%.0" Key5="Subtree" Display="Right">
        <Setting Key1="__VALUES"></Setting>
      </Object>
    </Object>
  </Type>
  <Type Name="ServicesRunning">
    <Object Type="Group" Name="Services (Running)" TrackProgress="TrackProgress">
      <Object Type="WMI" Key3="Win32_Service" Key4="Started='True'" Display="Hide">
        <Setting Key1="DisplayName" Substitution="SVCDN" Display="Hide"/>
        <Setting Key1="Name" Substitution="SVCNAME" Display="Hide"/>
        <Setting Key1="Description" Substitution="SVCDESC" Display="Hide"/>
        <Setting Key1="Pathname" Substitution="SVCPATH" Display="Hide"/>
        <Setting Key1="StartMode" Substitution="SVCSTARTMODE" Display="Hide"/>
        <Object Type="Group" Name="%SVCDN%">
          <Object Type="Group" Name="%SVCNAME%">
            <Setting Display="Hide"/>
          </Object>
          <Object Type="Group" Name="%SVCDESC%">
            <Setting Display="Hide"/>
          </Object>
          <Object Type="Group" Name="%SVCPATH%">
            <Setting Display="Hide"/>
          </Object>
          <Object Type="Group" Name="%SVCSTARTMODE%">
            <Setting Display="Hide"/>
          </Object>
        </Object>
        <Rule Name="fAppSenseServiceFound" Query="count(../Instance/Setting[@Key1='DisplayName' and starts-with(lower-case(Value),'appsense')=true()])&gt;0 and $appName='Outlook'" Error="None" Title="AppSense service found" Text="One or more services from AppSense running. This indicates AppSense is installed on this client." P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Informational"/>
        <Rule Name="fAvastServiceFound" Query="count(../Instance/Setting[@Key1='DisplayName' and starts-with(lower-case(Value),'avast')=true()])"/>
        <Rule Name="fWindowsFirewallServiceNotRunning" Query="count(../Instance/Setting[@Key1='Name' and lower-case(Value)='mpssvc'])"/>
        <Rule Name="sOfficePreviewersDisabled" Error="Error" Query="$n2DigitVersion&gt;=15 and $fWindowsFirewallServiceNotRunning=0 and (number(substring($OSDetails_WindowsVersion,1,3))&gt;=6.2)" Title="Office previewer disabled because the Windows Firewall service is not running" Text="You will receive an error in Outlook if you try to preview an Office file attached to an email message. This occurs because the Windows Firewall service is not running." GUID="335813" SSID="27b8c83b-b85c-416e-bea5-7b7c847ad1bc" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Email attachments,File error"></Rule>
        <Rule Name="sEmetServiceRunning" Query="count(../Instance/Setting[@Key1='DisplayName' and starts-with(lower-case(Value),'microsoft emet')])&gt;0" Error="Error" Title="Microsoft EMET service is running" Text="The Microsoft EMET service is running and this can cause problems getting a computer memory trace or crash dump.&#xA;&#xA;If you are working with a Microsoft support engineer on an issue, please let them know this service is running. Otherwise, you can ignore this warning." SSID="94fd33ee-fed8-440b-bfd9-7ed09f431065" P9="$CloudMbxRegistry_fCloudMbxDetected" Cloud="{9}" Symptoms="Alert from OffCAT"/>
      </Object>
    </Object>
  </Type>
	<!--EXTERNALREFS-->
  <Rule Name="fCloudMbxDetected"></Rule>
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#"><SignedInfo><CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/><SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/><Reference URI=""><Transforms><Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/><Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/></Transforms><DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/><DigestValue>M2AEwKOqdDgCYIvackTgmDJaJc0=</DigestValue></Reference></SignedInfo><SignatureValue>
    P4+CUdj4DHYGoLaIXq9rGg9pL2A+De0HbYvhl6ZYlH3wzONzVemAXrXzXFPBRFixMRuJ/ptd
    OCdRupbrt7pnZyhjrtQUA/kMcQKHMXsLlD35ubokJDtZY9gAM9/bQjB0PuNX3bh0H6l7JJDk
    ZixrofZTtjTg2YJeKKJ+lSnZJcpUxGoQzZbY0DocaHvxDuNnEDWLL7hgPooX7S6YkQe8zI3m
    Jl0vwLpd7jrO8/5uPhp/PnGWYHSuv7geJweiVX/r9GHK7j4DY1B10U1cmwgyBlTN8RxocEHy
    BWTagyNFLDPZKLpf95jYKQOMIh6CzZA6a4lN2Snzn0G6WY7ntl7AIw==
  </SignatureValue><KeyInfo>
      <KeyValue>
        <RSAKeyValue>
          <Modulus>
            kvxvNrvhA7ko1kbRomG6pUb7YxY+LvlH0sfs7ceZsSZRdb3azA8GFBGkbBmewF9NVInkTVDY
            jc2hYaV3E5ocp+0NdPenVnnoKPdT0rF6Y+D1lJe37NlH+Gw98yWIs7wKxQSnjnyFSHYcYUaq
            GcR6YovBwjWq+1hvxWMLk0kwgRt73398T7RHbV94HK+295YTUu+50U055XPeSE48FKqXDTnM
            i1HhXNE78I5n6jBgqU1anUO92yO6wA/XSxCdnE3wUaKEquScpz3Wo+8KGEio+rFOpZgOS7/w
            FPMAyLBI1lv+ONeJES0FukMCTyIAliWtfTVuhGirIBg4KP4cohCxpQ==
          </Modulus>
          <Exponent>AQAB</Exponent>
        </RSAKeyValue>
      </KeyValue>
      <X509Data>
        <X509Certificate>
          MIIE7DCCA9SgAwIBAgITMwAAAQosea7XeXumrAABAAABCjANBgkqhkiG9w0BAQUFADB5MQsw
          CQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwG
          A1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSMwIQYDVQQDExpNaWNyb3NvZnQgQ29kZSBT
          aWduaW5nIFBDQTAeFw0xNTA2MDQxNzQyNDVaFw0xNjA5MDQxNzQyNDVaMIGDMQswCQYDVQQG
          EwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMV
          TWljcm9zb2Z0IENvcnBvcmF0aW9uMQ0wCwYDVQQLEwRNT1BSMR4wHAYDVQQDExVNaWNyb3Nv
          ZnQgQ29ycG9yYXRpb24wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCS/G82u+ED
          uSjWRtGiYbqlRvtjFj4u+UfSx+ztx5mxJlF1vdrMDwYUEaRsGZ7AX01UieRNUNiNzaFhpXcT
          mhyn7Q1096dWeego91PSsXpj4PWUl7fs2Uf4bD3zJYizvArFBKeOfIVIdhxhRqoZxHpii8HC
          Nar7WG/FYwuTSTCBG3vff3xPtEdtX3gcr7b3lhNS77nRTTnlc95ITjwUqpcNOcyLUeFc0Tvw
          jmfqMGCpTVqdQ73bI7rAD9dLEJ2cTfBRooSq5JynPdaj7woYSKj6sU6lmA5Lv/AU8wDIsEjW
          W/4414kRLQW6QwJPIgCWJa19NW6EaKsgGDgo/hyiELGlAgMBAAGjggFgMIIBXDATBgNVHSUE
          DDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQUif4KMeomzeZtx5GRuZSMohhhNzQwUQYDVR0RBEow
          SKRGMEQxDTALBgNVBAsTBE1PUFIxMzAxBgNVBAUTKjMxNTk1KzA0MDc5MzUwLTE2ZmEtNGM2
          MC1iNmJmLTlkMmIxY2QwNTk4NDAfBgNVHSMEGDAWgBTLEejK0rQWWAHJNy4zFha5TJoKHzBW
          BgNVHR8ETzBNMEugSaBHhkVodHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9k
          dWN0cy9NaWNDb2RTaWdQQ0FfMDgtMzEtMjAxMC5jcmwwWgYIKwYBBQUHAQEETjBMMEoGCCsG
          AQUFBzAChj5odHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY0NvZFNpZ1BD
          QV8wOC0zMS0yMDEwLmNydDANBgkqhkiG9w0BAQUFAAOCAQEApqhTkd87Af5hXQZa62bwDNj3
          2YTTAFEOENGk0Rco54wzOCvYQ8YDi3XrM5L0qeJn/QLbpR1OQ0VdG0nj4E8W8H6P8IgRyoKt
          pPumqV/1l2DIe8S/fJtp7R+CwfHNjnhLYvXXDRzXUxLWllLvNb0ZjqBAk6EKpS0WnMJGdAjr
          2/TYpUk2VBIRVQOzexb7R/77aPzARVziPxJ5M6LvgsXeQBkH7hXFCptZBUGp0JeegZ4DW/xK
          4xouBaxQRy+M+nnYHiD4BfspaxgU+nIEtwunmmTsEV1PRUmNKRot+9C2CVNfNJTgFsS56nM1
          6Ffv4esWwxjHBrM7z2GE4rZEiZSjhg==
        </X509Certificate>
      </X509Data>
      <X509Data>
        <X509Certificate>
          MIIFmTCCA4GgAwIBAgIQea0WoUqgpa1Mc1j0BxMuZTANBgkqhkiG9w0BAQUFADBfMRMwEQYK
          CZImiZPyLGQBGRYDY29tMRkwFwYKCZImiZPyLGQBGRYJbWljcm9zb2Z0MS0wKwYDVQQDEyRN
          aWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcNMDEwNTA5MjMxOTIyWhcN
          MjEwNTA5MjMyODEzWjBfMRMwEQYKCZImiZPyLGQBGRYDY29tMRkwFwYKCZImiZPyLGQBGRYJ
          bWljcm9zb2Z0MS0wKwYDVQQDEyRNaWNyb3NvZnQgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3Jp
          dHkwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDzXfqAZ9Rap6kMLJAg0DUIPHWE
          zbcHiZyJ2t7Ow2D6kWhanpRxKRh2fMLgyCV2lA5Y+gQ0Nubfr/eAuulYCyuT5Z0F43cikfc0
          ZDwikR1e4QmQvBT+/HVYGeF5tweSo66IWQjYnwfKA1j8aCltMtfSqMtL/OELSDJP5uu4rU/k
          XG8TlJnbldV126gat5SRtHdb9UgMj2p5fRRwBH1tr5D12nDYR7e/my9s5wW34RFgrHmRFHzF
          1qbk4X7Vw37lktI8ALU2gt554W3ztW74nzPJy1J9c5g224uha6KVl5uj3sJNJv8GlmclBsjn
          rOTuEjOVMZnINQhONMp5U9W1vmMyWUA2wKVOBE0921sHM+RYv+8/U2TYQlk1V/0PRXwkBE2e
          1jh0EZcikM5oRHSSb9VLb7CG48c2QqDQ/MHAWvmjYbkwR3GWChawkcBCle8Qfyhq4yofseTN
          Az93cQTHIPxJDx1FiKTXy36IrY4t7EXbxFEEySr87IaemhGXW97OU4jm4rf9rJXCKEDb7wSQ
          34EzOdmyRaUjhwalVYkxuwYtYA5BGH0fLrWXyxHrFdUkpZTvFRSJ/Utz+jJb/NEzAPlZYnAH
          Muouq0Ate8rdIWcbMJmPFqojqEHRsG4RmzbE3kB0nOFYZcFgHnpbOMiPuwQmfNQWQOW2a2yq
          hv0Av87BNQIDAQABo1EwTzALBgNVHQ8EBAMCAcYwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4E
          FgQUDqyCYEBWJ5flJRP8KuEKU5VZ5KQwEAYJKwYBBAGCNxUBBAMCAQAwDQYJKoZIhvcNAQEF
          BQADggIBAMURTQM6YN1dUhF3j7K7NsiyBb+0t6jYIJ1cEwO2HCL6BhM1tshj1JpHbyZX0lXx
          BLEmX9apUGigvNK4bszD6azfGc14rFl0rGY0NsQbPmw4TDMOMBINoyb+UVMA/69aToQNDx/k
          bQUuToVLjWwzb1TSZKu/UK99ejmgN+1jAw/8EwbOFjbUVDuVG1FiOuVNF9QFOZKaJ6hbqr3s
          u77jIIlgcWxWs6UT0G0OI36VA+1oPfLYY7hrTbboMLXhypRL96KqXZkwsj2nwlFsKCABJCcr
          SwC3nRFrcL6yEIK8DJto0I07JIeqmShynTNfWZC99d6TnjpiWjQ54ohVHbkGsMGJay3XacMZ
          EjaE0Mmg2v8vaXiy5Xra69cMwPe9Yxe4ORM4ojZbe/KFVmodZGLBOOKqv1FmopT1EpxmIhBr
          8rcwki3yKfA9OxRDaKLxnCk3y844ICVtfGfzfiQSJAMIgUfspZ6X9RjXz7vV73aW7/3O21ad
          laBC+ZdY4dcxItNfWeY+biIA6kOEtiXb2fMIVmjAZGsdfOy2k6JiV24u2OdYj8QxSSbd3ik1
          h/UwcXBbFDxpvYkSfesuo/7Yf56CWlIKK8FDK9kwiJ/IEPuJjeahhXUzfmye23MTZGJppS99
          ypZtn/gETTCSPW4hFCHJPeDD/YprnUr90aGdmUN3P7Da
        </X509Certificate>
      </X509Data>
      <X509Data>
        <X509Certificate>
          MIIFvDCCA6SgAwIBAgIKYTMmGgAAAAAAMTANBgkqhkiG9w0BAQUFADBfMRMwEQYKCZImiZPy
          LGQBGRYDY29tMRkwFwYKCZImiZPyLGQBGRYJbWljcm9zb2Z0MS0wKwYDVQQDEyRNaWNyb3Nv
          ZnQgUm9vdCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcNMTAwODMxMjIxOTMyWhcNMjAwODMx
          MjIyOTMyWjB5MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMH
          UmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSMwIQYDVQQDExpNaWNy
          b3NvZnQgQ29kZSBTaWduaW5nIFBDQTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEB
          ALJyWVwZMGS/HZpgICBCmXZTbD4b1m/My/Hqa/6XFhDg3zp0gxq3L6Ay7P/ewkJOI9VyANs1
          VwqJyq4gSfTwaKxNS42lvXlLcZtHB9r9Jd+ddYjPqnNEf9eB2/O98jakyVxF3K+tPeAoaJca
          p6Vyc1bxF5Tk/TWUcqDWdl8ed0WDhTgW0HNbBbpnUo2lsmkv2hkL/pJ0KeJ2L1TdFDBZ+NKN
          Yv3LyV9GMVC5JxPkQDDPcikQKCLHN049oDI9kM2hOAaFXE5WgigqBTK3S9dPY+fSLWLxRT3n
          rAgA9kahntFbjCZT6HqqSvJGzzc8OJ60d1ylF56NyxGPVjzBrAlfA9MCAwEAAaOCAV4wggFa
          MA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFMsR6MrStBZYAck3LjMWFrlMmgofMAsGA1Ud
          DwQEAwIBhjASBgkrBgEEAYI3FQEEBQIDAQABMCMGCSsGAQQBgjcVAgQWBBT90TFO0yaKleGY
          YDuoMW+mPLzYLTAZBgkrBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTAfBgNVHSMEGDAWgBQOrIJg
          QFYnl+UlE/wq4QpTlVnkpDBQBgNVHR8ESTBHMEWgQ6BBhj9odHRwOi8vY3JsLm1pY3Jvc29m
          dC5jb20vcGtpL2NybC9wcm9kdWN0cy9taWNyb3NvZnRyb290Y2VydC5jcmwwVAYIKwYBBQUH
          AQEESDBGMEQGCCsGAQUFBzAChjhodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRz
          L01pY3Jvc29mdFJvb3RDZXJ0LmNydDANBgkqhkiG9w0BAQUFAAOCAgEAWTk+fyZGr+tvQLEy
          tWrrDi9uqEn361917Uw7LddDrQv+y+ktMaMjzHxQmIAhXaw9L0y6oqhWnONwu7i0+Hm1SXL3
          PupBf8rhDBdpy6WcIC36C1DEVs0t40rSvHDnqA2iA6VW4LiKS1fylUKc8fPv7uOGHzQ8uFaa
          8FMjhSqkghyT4pQHHfLiTviMocroE6WRTsgb0o9ylSpxbZsa+BzwU9ZnzCL/XB3Nooy9J7J5
          Y1ZEolHN+emjWFbdmwJFRC9f9Nqu1IIybvyklRPk62nnqaIsvsgrEA5ljpnb9aL6EiYJZTiU
          8XofSrvR4Vbo0HiWGFzJNRZf3ZMdSY4tvq00RBzuEBUaAF3dNVshzpjHCe6FDoxPbQ4TTj18
          KUicctHzbMrB7HCjV5JXfZSNoBtIA1r3z6NnCnSlNu0tLxfI5nI3EvRvsTxngvlSso0zFmUe
          DordEN5k9G/ORtTTF+l5xAS00/ss3x+KnqwK+xMnQK3k+eGpf0a7B2BHZWBATrBC7E7ts3Z5
          2Ao0CW0cgDEf4g5U3eWh++VHEK1kmP9QFi58vwUheuKVQSdpw5OPlcmN2Jshrg1cnPCiroZo
          gwxqLbt2awAdlq3yFnv2FoMkuYjPaqhHMS+a3ONxPdcAfmJH0c6IybgY+g5yjcGjPa8CQGr/
          aZuW4hCoELQ3UAjWwz0=
        </X509Certificate>
      </X509Data>
    </KeyInfo><Object id="ts-countersig"><X509Data><X509Certificate>MIIEwzCCA6ugAwIBAgITMwAAAK9TR3dsG/GjAgAAAAAArzANBgkqhkiG9w0BAQUFADB3MQswCQYD
VQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMV
TWljcm9zb2Z0IENvcnBvcmF0aW9uMSEwHwYDVQQDExhNaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0Ew
HhcNMTYwNTAzMTcxMzI1WhcNMTcwODAzMTcxMzI1WjCBszELMAkGA1UEBhMCVVMxEzARBgNVBAgT
Cldhc2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29mdCBDb3Jwb3Jh
dGlvbjENMAsGA1UECxMETU9QUjEnMCUGA1UECxMebkNpcGhlciBEU0UgRVNOOjMxQzUtMzBCQS03
QzkxMSUwIwYDVQQDExxNaWNyb3NvZnQgVGltZS1TdGFtcCBTZXJ2aWNlMIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEAvIU6bFARsNjTYwC3p63ceKHrpHQuCZTbNDUUaayYlNptTs9au9YI
+P9IBOKErcKjXkxftzeQaum86O7IGQlJPvqr0Cms32bitA6yECmWddujRimd4ULql8Imc452jaG1
pjiPfq8uZcTgYHkJ5/AMQ+K2NuGTLEw4//BTmnBMOugRKUuUZcVQZG+E9wot5slnIe1p/VgYpt8D
ejA4crXFzAeAXtj4XEY7NdE351GaIET0Y1LeKdWjnwhz2dqjhX2BJE/HDid/HYv3bnrgHBlHfmOT
kaB799B8amERbJjNJfqrCKofWxUBWq7R1iStUCFjSSvt+Q/OS2aoYsLXObA2rwIDAQABo4IBCTCC
AQUwHQYDVR0OBBYEFGgYUtBYbEj/U4U9IDez4/ZMdPF4MB8GA1UdIwQYMBaAFCM0+NlSRnAK7UD7
dvuzK7DDNbMPMFQGA1UdHwRNMEswSaBHoEWGQ2h0dHA6Ly9jcmwubWljcm9zb2Z0LmNvbS9wa2kv
Y3JsL3Byb2R1Y3RzL01pY3Jvc29mdFRpbWVTdGFtcFBDQS5jcmwwWAYIKwYBBQUHAQEETDBKMEgG
CCsGAQUFBzAChjxodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRzL01pY3Jvc29mdFRp
bWVTdGFtcFBDQS5jcnQwEwYDVR0lBAwwCgYIKwYBBQUHAwgwDQYJKoZIhvcNAQEFBQADggEBAIz3
2N/DMfk74OzCmb8uSgdkrVDlMU0+O4OWsClrjoUq0o6w2qNxSX+nzxxbt7e7paBO+0pyf2m4XaGB
LfuZW8lBRC2mR+U5K1wXzZTqy/3v1dIKyngU2cPT1L8yaC5v6FkpDljzBfslTmPvPljhN41uKTif
BPqxpO+H41lCVaG/zN6HDovSoSt8jMOh01+9VCUsbccY6J7D9iT3erE1a0FVXy7cn9mDckXaeAOf
z8cMJWlcNWqN1J+DjUWpArxwQjVX+gxC1CUx8Z1aA+HSBfbCXaOAtLRni3VUf1Wje/mHZevDfUkM
2gKd9TcEu2IN1pDcWnjcSb5KLOPfSOU7Xz8=</X509Certificate></X509Data><X509Data><X509Certificate>MIIGBzCCA++gAwIBAgIKYRZoNAAAAAAAHDANBgkqhkiG9w0BAQUFADBfMRMwEQYKCZImiZPyLGQB
GRYDY29tMRkwFwYKCZImiZPyLGQBGRYJbWljcm9zb2Z0MS0wKwYDVQQDEyRNaWNyb3NvZnQgUm9v
dCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcNMDcwNDAzMTI1MzA5WhcNMjEwNDAzMTMwMzA5WjB3
MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwG
A1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSEwHwYDVQQDExhNaWNyb3NvZnQgVGltZS1TdGFt
cCBQQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCfoWyx39tIkip8ay4Z4b3i48WZ
USNQrc7dGE4kD+7Rp9FMrXQwIBHrB9VUlRVJlBtCkq6YXDAm2gBr6Hu97IkHD/cOBJjwicwfyzMk
h53y9GccLPx754gd6udOo6HBI1PKjfpFzwnQXq/QsEIEovmmbJNn1yjcRlOwhtDlKEYuJ6yGT1VS
DOQDLPtqkJAwbofzWTCd+n7Wl7PoIZd++NIT8wi3U21StEWQn0gASkdmEScpZqiX5NMGgUqi+YSn
EUcUCYKfhO1VeP4Bmh1QCIUAEDBG7bfeI0a7xC1Un68eeEExd8yb3zuDk6FhArUdDbH895uyAc4i
S1T/+QXDwiALAgMBAAGjggGrMIIBpzAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBQjNPjZUkZw
Cu1A+3b7syuwwzWzDzALBgNVHQ8EBAMCAYYwEAYJKwYBBAGCNxUBBAMCAQAwgZgGA1UdIwSBkDCB
jYAUDqyCYEBWJ5flJRP8KuEKU5VZ5KShY6RhMF8xEzARBgoJkiaJk/IsZAEZFgNjb20xGTAXBgoJ
kiaJk/IsZAEZFgltaWNyb3NvZnQxLTArBgNVBAMTJE1pY3Jvc29mdCBSb290IENlcnRpZmljYXRl
IEF1dGhvcml0eYIQea0WoUqgpa1Mc1j0BxMuZTBQBgNVHR8ESTBHMEWgQ6BBhj9odHRwOi8vY3Js
Lm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0cy9taWNyb3NvZnRyb290Y2VydC5jcmwwVAYI
KwYBBQUHAQEESDBGMEQGCCsGAQUFBzAChjhodHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2Nl
cnRzL01pY3Jvc29mdFJvb3RDZXJ0LmNydDATBgNVHSUEDDAKBggrBgEFBQcDCDANBgkqhkiG9w0B
AQUFAAOCAgEAEJeKw1wDRDbd6bStd9vOeVFNAbEudHFbbQwTq86+e4+4LtQSooxtYrhXAstOIBNQ
md16QOJXu69YmhzhHQGGrLt48ovQ7DsB7uK+jwoFyI1I4vBTFd1Pq5Lk541q1YDB5pTyBi+FA+mR
KiQicPv2/OR4mS4N9wficLwYTp2OawpylbihOZxnLcVRDupiXD8WmIsgP+IHGjL5zDFKdjE9K3IL
yOpwPf+FChPfwgphjvDXuBfrTot/xTUrXqO/67x9C0J71FNyIe4wyrt4ZVxbARcKFA7S2hSY9Ty5
ZlizLS/n+YWGzFFW6J1wlGysOUzU9nm/qhh6YinvopspNAZ3GmLJPR5tH4LwC8csu89Ds+X57H21
46SodDW4TsVxIxImdgs8UoxxWkZDFLyzs7BNZ8ifQv+AeSGAnhUwZuhCEl4ayJ4iIdBD6Svpu/RI
zCzU2DKATCYqSCRfWupW76bemZ3KOm+9gSd0BhHudiG/m4LBJ1S2sWo9iaF2YbRuoROmv6pH8BJv
/YoybLL+31HIjCPJZr2dHYcSZAI9La9Zj7jkIeW1sMpjtHhUBdRBLlCslLCleKuzoJZ1GtmShxN1
Ii8yqAhuoFuMJb+g74TKIdbrHk/Jmu5J4PcBZW+JC33Iacjmbuqnl84xKf8OxVtc2E0bodj6L54/
LlUWa8kTo/0=</X509Certificate></X509Data><CounterSignature xmlns="http://schemas.microsoft.com/xmldsig/timestamp/2003" ts-format="cms-timestamp-message">MIIG0AYJKoZIhvcNAQcCoIIGwTCCBr0CAQMxCzAJBgUrDgMCGgUAMIIBEwYJKoZIhvcNAQcBoIIB
BASCAQA/j4JR2PgMdgagtoher2saD2kvYD4N7Qdti+GXpliUffDM43NV6YBetfNcU8FEWLExG4n+
m104J1G6luu3umdnKGOu1BQD+QxxAocxewuUPfm5uiQkO1lj2AAz39tCMHQ+41fduHQfqXskkORm
LGuh9lO2NODZgl4oon6VKdklylTEahDNltjQOhxoe/EO42cQNYsvuGA+ihftLpiRB7zMjeYmXS/A
ul3uOs7z/m4+Gn8+cZZgdK6/uB4nB6JVf+v0YcruPgNjUHXRTVybCDIGVM3xHGhwQfIFZNqDI0Us
M9koul/3mNgpA4wiHoLNkDpriU3ZKfOfQbpZjue2XsAjoIIDeaGCA3UwggJdAgEBMIHjoYG5pIG2
MIGzMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEe
MBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMQ0wCwYDVQQLEwRNT1BSMScwJQYDVQQLEx5u
Q2lwaGVyIERTRSBFU046MzFDNS0zMEJBLTdDOTExJTAjBgNVBAMTHE1pY3Jvc29mdCBUaW1lLVN0
YW1wIFNlcnZpY2WiJQoBATAJBgUrDgMCGgUAAxUAVVOJIetMkgprira+lJqMuHewz+yggcIwgb+k
gbwwgbkxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQHEwdSZWRtb25k
MR4wHAYDVQQKExVNaWNyb3NvZnQgQ29ycG9yYXRpb24xDTALBgNVBAsTBE1PUFIxJzAlBgNVBAsT
Hm5DaXBoZXIgTlRTIEVTTjo1N0Y2LUMxRTAtNTU0QzErMCkGA1UEAxMiTWljcm9zb2Z0IFRpbWUg
U291cmNlIE1hc3RlciBDbG9jazANBgkqhkiG9w0BAQUFAAIFANtJ/o4wIhgPMjAxNjA4MDExNjU5
NThaGA8yMDE2MDgwMjE2NTk1OFowczA5BgorBgEEAYRZCgQBMSswKTAKAgUA20n+jgIBADAGAgEA
AgECMAcCAQACAhg+MAoCBQDbS1AOAgEAMDYGCisGAQQBhFkKBAIxKDAmMAwGCisGAQQBhFkKAwGg
CjAIAgEAAgMW42ChCjAIAgEAAgMHoSAwDQYJKoZIhvcNAQEFBQADggEBADW8Wc1X7wC6a6anLPjY
Z2LaN5A9sqH61c4KUXHRWQ3NmrcTAt5MRePI0Rf9rcgxQdA/DPFaeCoOLMvfTtc1njNwsDsbcjp8
p37u2Rr/E0WNFRoraruy1H8HEHx3Tev0SNGOKot7vdrkByf8qTKKOtA4EpEnH9SEuHYhDBN7SfW4
qcWVmL5KhJDtvtQDqfPzMa7fL7ybRLblnfVnJD/dIz973Q0gS2aFre7EyRAkKlJVOy2m4J1kDXAG
Z7GfdnVjTB0PDzILYM2HrdlGs0c6CsKLqUnB4H7oEQTVDXGJhjj02Nozcq4uEucHns5H3JS1puGO
AwoOxcxZQYGdexa7AqUxggIVMIICEQIBATCBjjB3MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2Fz
aGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENvcnBvcmF0aW9u
MSEwHwYDVQQDExhNaWNyb3NvZnQgVGltZS1TdGFtcCBQQ0ECEzMAAACvU0d3bBvxowIAAAAAAK8w
CQYFKw4DAhoFAKBdMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8XDTE2
MDgwMTE3MjkyOFowIwYJKoZIhvcNAQkEMRYEFKBHTSo9d4XZzADt9qF37nbmbsX/MA0GCSqGSIb3
DQEBBQUABIIBAGhg7J2UMEk9M4/z7JbhF83gUTQmWksiAEw0sPnIwSAWEk+ve/ORajcHkKvN0VGD
T2G/IcJ8EEO+6o6qBs7WyLwOWNjTHOW0HFXq5T0Yo+yUMWxbT3Mq9tO9fRgLGVhVHxLRbRn1/ImT
5ufuhlDSGMcZqo6iArT0W81GcgE6jwfqxx1JK8HpnxHkfiaTeqHsHKGcl+V9lY0Am2wKZTkNwUrR
Aq79a+bWQZRZZeI1ku6MbvWa2cjET2zD+8TwPfsU6nOpFwRNc+nuAhWlLCLEQc/lBrvI85W14NAK
/Xu7Svf1Y0sqSV0jFM3H46DCAlP0SMoaYkzfAB46xvZZWTXgRgI=</CounterSignature></Object></Signature></ObjectCollector>